/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// main.ts
var main_exports = {};
__export(main_exports, {
  default: () => GenerateMarkdownPlugin
});
module.exports = __toCommonJS(main_exports);
var import_obsidian5 = require("obsidian");

// src/views/generate-markdown.ts
var import_obsidian4 = require("obsidian");

// src/utils.ts
var import_obsidian = require("obsidian");
var fixSpaceInName = (name) => {
  return name.replace(/[\u00A0\u1680\u180E\u2000-\u200B\u202F\u205F\u3000\uFEFF]/, " ").trim();
};
var getNoteByName = async (app2, path) => {
  const file = app2.vault.getAbstractFileByPath(path);
  if (!(file instanceof import_obsidian.TFile))
    return "";
  return await app2.vault.cachedRead(file);
};

// src/views/generate-slides-markdown.ts
var SlidesMarkdown = class {
  constructor(slides, title, hasTitleSlide, hasLastSlide) {
    this.slides = [];
    this.slideshow = "";
    this.slides = slides;
    this.slideshow += this.createProperties();
    if (hasTitleSlide)
      this.slideshow += this.createTitleSlide(title);
    slides.forEach((slide) => {
      if (slide.type === "basic")
        this.slideshow += this.createBasicSlide(slide.link.name);
      else if (slide.type === "split")
        this.slideshow += this.createSplitSlide(slide.link.name);
    });
    if (hasLastSlide)
      this.slideshow += this.createLastSlide();
    return this;
  }
  createProperties() {
    return `---
theme: consult
height: 540
margin: 0
maxScale: 4
---

`;
  }
  createTitleSlide(title) {
    return `
<!-- slide template="[[tpl-con-title]]" -->

## ${title}
::: block
#### add author here
:::

`;
  }
  createLastSlide() {
    return `
---
<!-- slide template="[[tpl-con-splash]]" -->

# **Thank you for your attention**

`;
  }
  createBasicSlide(name) {
    return `
---
<!-- slide template="[[tpl-con-default-box]]" -->

::: title
### _**${name}**_
:::

::: block
-
-
-
:::

`;
  }
  createSplitSlide(name) {
    return `
---
<!-- slide template="[[tpl-con-2-1-box]]" -->

::: title
### _**${name}**_
:::

::: left
**text in left box**
- lorem ipsum
-
-
:::

::: right
**text in right box**
- lorem ipsum
-
-
:::

`;
  }
};

// src/components/Button.ts
var Button = class {
  constructor(element, text, onClick, args) {
    this.btn = element.createEl("button", { text, ...args });
    this.btn.onclick = () => {
      onClick(this);
    };
    return this;
  }
};

// src/components/Link.ts
var BaseLink = class {
  constructor(context, element, name) {
    this.context = context;
    this.element = element;
    this.name = name;
    this.render();
  }
  render() {
    const hrefTitle = this.element.createEl("a", { text: this.name, cls: "cont__title" });
    hrefTitle.onclick = () => {
      this.context.workspace.openLinkText(this.name, "");
    };
  }
};
var Link = class {
  constructor(context, element, link, renderNow = true) {
    this.toggledState = false;
    this.link = link;
    this.context = context;
    this.element = element;
    if (renderNow)
      this.render(false);
    return this;
  }
  render(state) {
    this.a = this.element.createEl("a", { text: this.link.name, cls: "link" });
    !this.link.exists && this.a.addClass("cont__link-not-exist");
    this.link.inline && this.a.addClass("inline");
    this.a.onclick = () => {
      this.context.workspace.openLinkText(this.link.name, "");
      !this.link.exists && this.a.removeClass("cont__link-not-exist");
    };
    this.toggle(state);
  }
  toggle(state) {
    if (state)
      this.a.removeClass("strikethrough");
    else
      this.a.addClass("strikethrough");
  }
};

// src/components/SaveModal.ts
var import_obsidian2 = require("obsidian");
var SaveModal = class extends import_obsidian2.Modal {
  constructor(app2, onSubmit) {
    super(app2);
    this.onSubmit = onSubmit;
  }
  onOpen() {
    const { contentEl } = this;
    contentEl.createEl("h1", { text: "Save as" });
    new import_obsidian2.Setting(contentEl).setName("File name: ").addText((text) => text.onChange((value) => {
      this.result = value;
    }));
    new import_obsidian2.Setting(contentEl).addButton((btn) => btn.setButtonText("Generate markdown note").setCta().onClick(() => {
      this.close();
      this.onSubmit(this.result);
    }));
  }
  onClose() {
    let { contentEl } = this;
    contentEl.empty();
  }
};

// src/components/TreeMenu.ts
function flattenChildren(link, children) {
  if ("children" in link) {
    const childrenLinkNames = link.children.map((l) => l.name);
    children.push(...childrenLinkNames);
    link.children.forEach((l) => {
      flattenChildren(l, children);
    });
  }
  return children;
}
var TreeMenu = class {
  constructor(app2, structure, linksTree, event) {
    this.ignoredLinks = [];
    this.linksTree = [];
    this.app = app2;
    let menu = structure.createEl("div", { cls: "tree-menu" });
    this.UL = menu.createEl("ul");
    this.linksTree = linksTree;
    this.render(this.linksTree, this.UL, [], event);
  }
  render(links, menuEl, childrenLinks, event) {
    if (!childrenLinks)
      childrenLinks = [];
    links.forEach((link) => {
      const li = menuEl.createEl("li");
      const linkEl = new Link(this.app, li, link, false);
      let state = !childrenLinks.includes(linkEl.link.name);
      if (!link.exists)
        state = false;
      new Checkbox(li, state, link.exists, () => {
        const ignoredChildren = [linkEl.link.name, ...flattenChildren(linkEl.link, [])];
        if (state == false) {
          childrenLinks = childrenLinks.filter((cl) => !ignoredChildren.includes(cl));
        } else {
          childrenLinks.push(...ignoredChildren);
          childrenLinks = [...new Set(childrenLinks)];
        }
        this.ignoredLinks = childrenLinks;
        this.UL.empty();
        this.render(this.linksTree, this.UL, childrenLinks, event);
      });
      linkEl.render(state);
      if ("children" in link) {
        const ul = li.createEl("ul");
        this.render(link.children, ul, childrenLinks, event);
      }
    });
    return event(this.ignoredLinks);
  }
};

// src/components/Checkbox.ts
var Checkbox = class {
  constructor(element, state, exists, onClick) {
    this.cb = element.createEl("input", {
      type: "checkbox",
      cls: "checkbox-btn"
    });
    this.cb.checked = state;
    if (!exists) {
      this.cb.disabled = true;
      this.cb.checked = false;
      this.cb.addClass("checkbox-btn-disabled");
    }
    this.cb.onclick = () => {
      onClick(this);
    };
    return this;
  }
};

// src/components/SlidesModal.ts
var import_obsidian3 = require("obsidian");
var SlidesModal = class extends import_obsidian3.Modal {
  constructor(app2, links, ignoredLinks, onSubmit) {
    super(app2);
    this.flattenedLinks = [];
    this.maxDepth = 1;
    this.titleSlide = false;
    this.lastSlide = false;
    this.links = links;
    this.ignoredLinks = ignoredLinks;
    this.onSubmit = onSubmit;
  }
  onOpen() {
    const { contentEl } = this;
    contentEl.empty();
    contentEl.createEl("h1", { text: "Slideshow" });
    this.flattenLinks(this.links);
    const settingsEl = contentEl.createEl("div");
    const depthStr = (depth) => `Slides depth: ${depth}`;
    this.depth = this.maxDepth;
    contentEl.createEl("div", { text: "Include: " });
    const titleSlideEl = contentEl.createEl("div");
    new Checkbox(titleSlideEl, this.titleSlide, true, () => {
      this.titleSlide = !this.titleSlide;
      this.render();
    });
    titleSlideEl.createEl("span", { text: "title slide" });
    const lastSlideEl = contentEl.createEl("div");
    new Checkbox(lastSlideEl, this.lastSlide, true, () => {
      this.lastSlide = !this.lastSlide;
      this.render();
    });
    lastSlideEl.createEl("span", { text: "last slide" });
    this.linksEl = contentEl.createEl("div");
    new import_obsidian3.Setting(settingsEl).setName(depthStr(this.maxDepth)).setDesc("Set depth of preview content to create slides from.").addSlider((slider) => slider.setValue(this.maxDepth).setLimits(1, this.maxDepth, 1).onChange(async (value) => {
      const depthEl = settingsEl.children[0].children[0].children[0];
      depthEl.empty();
      depthEl.createEl("div", { text: depthStr(value) });
      this.depth = value;
      slider.showTooltip();
      this.render();
    }));
    this.render();
    new import_obsidian3.ButtonComponent(contentEl).setButtonText("Generate").onClick(() => {
      this.onSubmit(this.slides, this.titleSlide, this.lastSlide);
      this.close();
    });
  }
  flattenLinks(links) {
    links.forEach((link) => {
      if (this.ignoredLinks.includes(link.name))
        return;
      if (link.level && this.maxDepth <= link.level)
        this.maxDepth = link.level;
      this.flattenedLinks.push(link);
      if ("children" in link && link.level) {
        this.flattenLinks(link.children);
      }
    });
  }
  render() {
    this.linksEl.empty();
    const depthLinks = this.flattenedLinks.filter((link) => link.level && link.level <= this.depth);
    this.slides = depthLinks.map((link) => ({ link, type: "basic" }));
    if (this.titleSlide) {
      const slide = this.linksEl.createEl("div", { cls: "slide-row" });
      slide.createEl("span", { text: "1. Title slide" });
      const dropdownEl = slide.createEl("span", { cls: "row-right" });
      new import_obsidian3.DropdownComponent(dropdownEl).setDisabled(true).addOption("title", "title");
    }
    depthLinks.forEach((link) => {
      const slide = this.linksEl.createEl("div", { cls: "slide-row" });
      slide.createEl("span", { text: `${link.level}: ${link.name}` });
      const dropdownEl = slide.createEl("span", { cls: "row-right" });
      new import_obsidian3.DropdownComponent(dropdownEl).addOption("basic", "basic").addOption("split", "split").addOption("image", "image").onChange((value) => {
        const index = this.slides.findIndex(({ link: slideLink }) => slideLink.name === link.name);
        this.slides[index]["type"] = value;
      });
    });
    if (this.lastSlide) {
      const slide = this.linksEl.createEl("div", { cls: "slide-row" });
      slide.createEl("span", { text: "1. Last slide" });
      const dropdownEl = slide.createEl("span", { cls: "row-right" });
      new import_obsidian3.DropdownComponent(dropdownEl).setDisabled(true).addOption("last", "last");
    }
  }
  onClose() {
    let { contentEl } = this;
    contentEl.empty();
  }
};

// src/views/generate-markdown.ts
var VIEW_CONTENT_COMPOSE_NOTES = "view-generate-markdown";
var _GenerateMarkdown = class extends import_obsidian4.ItemView {
  constructor(leaf, settings) {
    super(leaf);
    this.linksTree = [];
    this.loadedFiles = [];
    this.maxLevel = 0;
    this.processed = [];
    this.mainNameLinks = [];
    this.markdown = "";
    this.ignoredLinks = [];
    this.images = [];
    this.settings = settings;
  }
  async onOpen() {
    const container = this.containerEl.children[1];
    this.container = container;
    container.empty();
    this.toolbar = container.createEl("div");
    this.generatePreviewParent = this.toolbar.createEl("span");
    this.generateMarkdownParent = this.toolbar.createEl("span");
    this.generateSlidesParent = this.toolbar.createEl("span");
    this.structure = this.container.createEl("div");
    new Button(this.generatePreviewParent, "Generate preview", () => {
      this.linksTree = [];
      this.maxLevel = 0;
      this.processed = [];
      this.mainNameLinks = [];
      this.ignoredLinks = [];
      this.markdown = "";
      this.structure.empty();
      this.generateMarkdownParent.empty();
      this.generateSlidesParent.empty();
      this.readSelectedNote();
    });
  }
  parseLinks(text, index = false) {
    const links = text.matchAll(/\[\[(.*?)\]\]/g);
    let cleanLinks = [...links].map((l) => l[1]);
    cleanLinks = [...new Set(cleanLinks)];
    cleanLinks = cleanLinks.filter((cl) => !cl.startsWith("#"));
    cleanLinks = cleanLinks.filter((cl) => !cl.startsWith(`${this.settings.literatureNote}#`));
    const existingNotes = cleanLinks.map((cl) => {
      cl = fixSpaceInName(cl);
      if (!!_GenerateMarkdown.imageTypes.filter((it) => cl.includes(it.toLowerCase())).length) {
        this.images.push(cl);
        return false;
      }
      let isInline = true;
      if (text.includes(this.settings.listOfLinksKeyword)) {
        let [inlineText, linksText] = text.split(this.settings.listOfLinksKeyword);
        if (!inlineText.includes(cl))
          isInline = false;
      }
      let isIndex = false;
      if (index) {
        isInline = false;
        isIndex = true;
      }
      const note = this.loadedFiles.find((f) => f["basename"] === cl);
      return {
        name: cl,
        exists: !!note,
        inline: isInline,
        index: isIndex,
        path: note == null ? void 0 : note.path
      };
    }).filter(Boolean);
    return existingNotes;
  }
  async readSelectedNote() {
    this.loadedFiles = app.vault.getMarkdownFiles();
    const activeNote = this.app.workspace.getActiveFile();
    if (!activeNote) {
      new import_obsidian4.Notice(`Selected note is invalid.`);
      throw new Error("Selected note is invalid.");
    }
    const activeNoteText = await getNoteByName(this.app, activeNote.path);
    const mainContentLinks = this.parseLinks(activeNoteText, true);
    this.mainNameLinks = mainContentLinks.map((l) => l.name);
    this.linksTree = await this.generateNotesHierarchy(mainContentLinks);
    const title = activeNote.basename;
    new BaseLink(this.app, this.structure, title);
    new TreeMenu(this.app, this.structure, this.linksTree, (ignoredLinks) => {
      this.ignoredLinks = ignoredLinks;
    });
    new Button(this.generateMarkdownParent, "Generate markdown", () => {
      this.markdown = "";
      this.generateMarkdownFile(this.linksTree, activeNoteText);
    }, { cls: "generate-markdown-btn" });
    new Button(this.generateSlidesParent, "Generate slideshow", () => {
      new SlidesModal(this.app, this.linksTree, this.ignoredLinks, (slides, hasTitleSlide, hasLastSlide) => {
        const slidesMD = new SlidesMarkdown(slides, title, hasTitleSlide, hasLastSlide);
        new SaveModal(this.app, async (fileName) => {
          await this.app.vault.adapter.write(`${fileName}.md`, slidesMD.slideshow);
          new import_obsidian4.Notice(`Slideshow ${fileName} created successfully`);
          this.app.workspace.openLinkText(`${fileName}.md`, "");
        }).open();
      }).open();
    }, { cls: "generate-markdown-btn" });
  }
  generateMarkdownFile(links, mainNote) {
    this.composeMarkdown(links);
    this.mainNameLinks.forEach((mnl) => {
      mnl = fixSpaceInName(mnl);
      mainNote = mainNote.replaceAll(`[[${mnl}]]`, `[[#${mnl}]]`);
    });
    this.markdown = mainNote + this.markdown;
    new SaveModal(this.app, async (fileName) => {
      await this.app.vault.adapter.write(`${fileName}.md`, this.markdown);
      new import_obsidian4.Notice(`Note ${fileName} created successfully`);
      this.app.workspace.openLinkText(`${fileName}.md`, "");
    }).open();
  }
  composeMarkdown(links) {
    links.forEach(async (link) => {
      let note = await getNoteByName(this.app, link.path);
      const localLinks = this.parseLinks(note);
      if (this.ignoredLinks.includes(link.name))
        return;
      note = note.trim();
      if (note.length == 0)
        return;
      localLinks.forEach((localLink) => {
        if (localLink.inline && this.ignoredLinks.includes(localLink.name))
          note = note.replaceAll(`[[${localLink.name}]]`, localLink.name);
        else
          note = note.replaceAll(`[[${localLink.name}]]`, `[[#${localLink.name}]]`);
      });
      let noteRows = note.split("\n");
      let firstRow = fixSpaceInName(noteRows[0]);
      if (firstRow.includes(`# ${link.name}`)) {
        noteRows.shift();
        note = noteRows.join("\n").trim();
      }
      if (note.includes(this.settings.listOfLinksKeyword)) {
        let [importantPart, endPart] = note.split(this.settings.listOfLinksKeyword);
        note = importantPart.trim();
      }
      let title = "";
      if (link.inline) {
        title = `##### ${link.name}`;
      } else {
        const nestedLevel = Array(link.level).fill("#").join("");
        title = `${nestedLevel} ${link.name}`;
      }
      note = `

${title}
${note}`;
      this.markdown += note;
      if ("children" in link)
        this.composeMarkdown(link.children);
    });
  }
  async generateNotesHierarchy(links) {
    const linksObj = await this.dfs(links, 0, []);
    let linksArr = [];
    Object.keys(linksObj).forEach((key) => {
      var _a, _b;
      const { parentRef, ...rest } = linksObj[key];
      linksArr.push({ ...rest, parent: (_b = (_a = linksObj[key]) == null ? void 0 : _a.parentRef) == null ? void 0 : _b.name });
    });
    const getNestedChildren = (arr, parent) => {
      let children = [];
      for (let i = 0; i < arr.length; i++) {
        if (arr[i].parent == parent) {
          const grandChildren = getNestedChildren(arr, arr[i].name);
          if (grandChildren.length) {
            arr[i].children = grandChildren;
          }
          children.push(arr[i]);
        }
      }
      return children;
    };
    return getNestedChildren(linksArr, void 0);
  }
  async dfs(links, level, processed, parentRef, titleMapping) {
    titleMapping = titleMapping != null ? titleMapping : {};
    for await (const [order, link] of links.entries()) {
      if (this.mainNameLinks.includes(link.name) && level != 0)
        continue;
      if (processed.includes(link.name)) {
        continue;
      }
      processed.push(link.name);
      const note = await getNoteByName(this.app, link.path);
      const subLinks = this.parseLinks(note);
      this.maxLevel = level + 1;
      titleMapping[link.name] = { ...link, parentRef, level: this.maxLevel, order };
      if (links.length > 0)
        await this.dfs(subLinks, this.maxLevel, processed, titleMapping[link.name], titleMapping);
    }
    return titleMapping;
  }
  async onClose() {
  }
  getViewType() {
    return VIEW_CONTENT_COMPOSE_NOTES;
  }
  getDisplayText() {
    return "Notes Merger";
  }
};
var GenerateMarkdown = _GenerateMarkdown;
GenerateMarkdown.imageTypes = ["jpg", "jpeg", "png", "gif", "webp", "tiff", "bmp"].map((it) => `.${it}`);

// main.ts
var DEFAULT_SETTINGS = {
  listOfLinksKeyword: "Kam d\xE1l",
  literatureNote: "Literature"
};
var GenerateMarkdownPlugin = class extends import_obsidian5.Plugin {
  async onload() {
    await this.loadSettings();
    this.addSettingTab(new GenerateMarkdownPluginSettingTab(this.app, this));
    this.registerView(VIEW_CONTENT_COMPOSE_NOTES, (leaf) => new GenerateMarkdown(leaf, this.settings));
    this.addRibbonIcon("scroll", "NotesMerger", () => {
      this.activateGenerateMarkdownView();
    });
  }
  async activateGenerateMarkdownView() {
    await this.app.workspace.getRightLeaf(false).setViewState({
      type: VIEW_CONTENT_COMPOSE_NOTES,
      active: true
    });
    this.app.workspace.revealLeaf(this.app.workspace.getLeavesOfType(VIEW_CONTENT_COMPOSE_NOTES)[0]);
  }
  onunload() {
  }
  async loadSettings() {
    this.settings = Object.assign({}, DEFAULT_SETTINGS, await this.loadData());
  }
  async saveSettings() {
    await this.saveData(this.settings);
  }
};
var GenerateMarkdownPluginSettingTab = class extends import_obsidian5.PluginSettingTab {
  constructor(app2, plugin) {
    super(app2, plugin);
    this.plugin = plugin;
  }
  display() {
    const { containerEl } = this;
    containerEl.empty();
    new import_obsidian5.Setting(containerEl).setName("List of links keyword").setDesc("Keyword to detect list of links at the end of note").addText((text) => text.setPlaceholder('Defaults to "Kam d\xE1l"').setValue(this.plugin.settings.listOfLinksKeyword).onChange(async (value) => {
      this.plugin.settings.listOfLinksKeyword = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian5.Setting(containerEl).setName("Literature note").setDesc("Name of note with citations").addText((text) => text.setPlaceholder('Defaults to "Literature"').setValue(this.plugin.settings.literatureNote).onChange(async (value) => {
      this.plugin.settings.literatureNote = value;
      await this.plugin.saveSettings();
    }));
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsibWFpbi50cyIsICJzcmMvdmlld3MvZ2VuZXJhdGUtbWFya2Rvd24udHMiLCAic3JjL3V0aWxzLnRzIiwgInNyYy92aWV3cy9nZW5lcmF0ZS1zbGlkZXMtbWFya2Rvd24udHMiLCAic3JjL2NvbXBvbmVudHMvQnV0dG9uLnRzIiwgInNyYy9jb21wb25lbnRzL0xpbmsudHMiLCAic3JjL2NvbXBvbmVudHMvU2F2ZU1vZGFsLnRzIiwgInNyYy9jb21wb25lbnRzL1RyZWVNZW51LnRzIiwgInNyYy9jb21wb25lbnRzL0NoZWNrYm94LnRzIiwgInNyYy9jb21wb25lbnRzL1NsaWRlc01vZGFsLnRzIl0sCiAgInNvdXJjZXNDb250ZW50IjogWyJpbXBvcnQgeyBBcHAsIFBsdWdpbiwgUGx1Z2luU2V0dGluZ1RhYiwgU2V0dGluZyB9IGZyb20gJ29ic2lkaWFuJztcbmltcG9ydCB7IEdlbmVyYXRlTWFya2Rvd24sIFZJRVdfQ09OVEVOVF9DT01QT1NFX05PVEVTIH0gZnJvbSAnLi9zcmMvdmlld3MvZ2VuZXJhdGUtbWFya2Rvd24nO1xuXG5leHBvcnQgaW50ZXJmYWNlIEdlbmVyYXRlTWFya2Rvd25QbHVnaW5TZXR0aW5nc1R5cGUge1xuXHRsaXN0T2ZMaW5rc0tleXdvcmQ6IHN0cmluZztcblx0bGl0ZXJhdHVyZU5vdGU6IHN0cmluZztcbn1cblxuY29uc3QgREVGQVVMVF9TRVRUSU5HUzogR2VuZXJhdGVNYXJrZG93blBsdWdpblNldHRpbmdzVHlwZSA9IHtcblx0bGlzdE9mTGlua3NLZXl3b3JkOiAnS2FtIGRcdTAwRTFsJyxcblx0bGl0ZXJhdHVyZU5vdGU6ICdMaXRlcmF0dXJlJ1xufVxuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBHZW5lcmF0ZU1hcmtkb3duUGx1Z2luIGV4dGVuZHMgUGx1Z2luIHtcblx0c2V0dGluZ3M6IEdlbmVyYXRlTWFya2Rvd25QbHVnaW5TZXR0aW5nc1R5cGU7XG5cblx0YXN5bmMgb25sb2FkKCkge1xuXHRcdGF3YWl0IHRoaXMubG9hZFNldHRpbmdzKCk7XG5cblx0XHR0aGlzLmFkZFNldHRpbmdUYWIobmV3IEdlbmVyYXRlTWFya2Rvd25QbHVnaW5TZXR0aW5nVGFiKHRoaXMuYXBwLCB0aGlzKSk7XHRcblxuXHRcdHRoaXMucmVnaXN0ZXJWaWV3KFxuXHRcdFx0VklFV19DT05URU5UX0NPTVBPU0VfTk9URVMsXG5cdFx0XHQobGVhZikgPT4gbmV3IEdlbmVyYXRlTWFya2Rvd24obGVhZiwgdGhpcy5zZXR0aW5ncylcblx0XHQpO1xuXHRcdFxuXHRcdHRoaXMuYWRkUmliYm9uSWNvbihcInNjcm9sbFwiLCBcIk5vdGVzTWVyZ2VyXCIsICgpID0+IHtcblx0XHRcdHRoaXMuYWN0aXZhdGVHZW5lcmF0ZU1hcmtkb3duVmlldygpO1xuXHRcdH0pO1xuXHR9XG5cblx0YXN5bmMgYWN0aXZhdGVHZW5lcmF0ZU1hcmtkb3duVmlldygpIHtcblx0XHRhd2FpdCB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0UmlnaHRMZWFmKGZhbHNlKS5zZXRWaWV3U3RhdGUoe1xuXHRcdCAgdHlwZTogVklFV19DT05URU5UX0NPTVBPU0VfTk9URVMsXG5cdFx0ICBhY3RpdmU6IHRydWUsXG5cdFx0fSk7XG5cdFxuXHRcdHRoaXMuYXBwLndvcmtzcGFjZS5yZXZlYWxMZWFmKFxuXHRcdCAgdGhpcy5hcHAud29ya3NwYWNlLmdldExlYXZlc09mVHlwZShWSUVXX0NPTlRFTlRfQ09NUE9TRV9OT1RFUylbMF1cblx0XHQpO1xuXHR9XG5cblx0b251bmxvYWQoKSB7XG5cdH1cblxuXHRhc3luYyBsb2FkU2V0dGluZ3MoKSB7XG5cdFx0dGhpcy5zZXR0aW5ncyA9IE9iamVjdC5hc3NpZ24oe30sIERFRkFVTFRfU0VUVElOR1MsIGF3YWl0IHRoaXMubG9hZERhdGEoKSk7XG5cdH1cblxuXHRhc3luYyBzYXZlU2V0dGluZ3MoKSB7XG5cdFx0YXdhaXQgdGhpcy5zYXZlRGF0YSh0aGlzLnNldHRpbmdzKTtcblx0fVxufVxuXG5jbGFzcyBHZW5lcmF0ZU1hcmtkb3duUGx1Z2luU2V0dGluZ1RhYiBleHRlbmRzIFBsdWdpblNldHRpbmdUYWIge1xuXHRwbHVnaW46IEdlbmVyYXRlTWFya2Rvd25QbHVnaW47XG5cblx0Y29uc3RydWN0b3IoYXBwOiBBcHAsIHBsdWdpbjogR2VuZXJhdGVNYXJrZG93blBsdWdpbikge1xuXHRcdHN1cGVyKGFwcCwgcGx1Z2luKTtcblx0XHR0aGlzLnBsdWdpbiA9IHBsdWdpbjtcblx0fVxuXG5cdGRpc3BsYXkoKTogdm9pZCB7XG5cblx0XHRjb25zdCB7IGNvbnRhaW5lckVsIH0gPSB0aGlzO1xuXG5cdFx0Y29udGFpbmVyRWwuZW1wdHkoKTtcblx0XHRcblx0XHRuZXcgU2V0dGluZyhjb250YWluZXJFbClcblx0XHRcdC5zZXROYW1lKCdMaXN0IG9mIGxpbmtzIGtleXdvcmQnKVxuXHRcdFx0LnNldERlc2MoJ0tleXdvcmQgdG8gZGV0ZWN0IGxpc3Qgb2YgbGlua3MgYXQgdGhlIGVuZCBvZiBub3RlJylcblx0XHRcdC5hZGRUZXh0KHRleHQgPT4gdGV4dFxuXHRcdFx0XHQuc2V0UGxhY2Vob2xkZXIoJ0RlZmF1bHRzIHRvIFwiS2FtIGRcdTAwRTFsXCInKVxuXHRcdFx0XHQuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MubGlzdE9mTGlua3NLZXl3b3JkKVxuXHRcdFx0XHQub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG5cdFx0XHRcdFx0dGhpcy5wbHVnaW4uc2V0dGluZ3MubGlzdE9mTGlua3NLZXl3b3JkID0gdmFsdWU7XG5cdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG5cdFx0XHRcdH0pKTtcblxuXHRcdG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuXHRcdC5zZXROYW1lKCdMaXRlcmF0dXJlIG5vdGUnKVxuXHRcdC5zZXREZXNjKCdOYW1lIG9mIG5vdGUgd2l0aCBjaXRhdGlvbnMnKVxuXHRcdC5hZGRUZXh0KHRleHQgPT4gdGV4dFxuXHRcdFx0LnNldFBsYWNlaG9sZGVyKCdEZWZhdWx0cyB0byBcIkxpdGVyYXR1cmVcIicpXG5cdFx0XHQuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MubGl0ZXJhdHVyZU5vdGUpXG5cdFx0XHQub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG5cdFx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLmxpdGVyYXR1cmVOb3RlID0gdmFsdWU7XG5cdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuXHRcdFx0fSkpO1xuXHR9XG59XG4iLCAiaW1wb3J0IHsgSXRlbVZpZXcsIFdvcmtzcGFjZUxlYWYsIE5vdGljZSwgVEFic3RyYWN0RmlsZSwgVEZpbGUsIEFwcCB9IGZyb20gXCJvYnNpZGlhblwiO1xuaW1wb3J0IHsgZml4U3BhY2VJbk5hbWUsIGdldE5vdGVCeU5hbWUgfSBmcm9tICcuLi91dGlscyc7XG5pbXBvcnQgeyBMaW5rVHJlZVR5cGUsIEJ1aWxkTGlua1RyZWVUeXBlLCBTbGlkZVR5cGUgfSBmcm9tIFwic3JjL3R5cGVzXCI7XG5pbXBvcnQgeyBHZW5lcmF0ZU1hcmtkb3duUGx1Z2luU2V0dGluZ3NUeXBlIH0gZnJvbSAnLi4vLi4vbWFpbic7XG5pbXBvcnQgeyBTbGlkZXNNYXJrZG93biB9IGZyb20gJy4vZ2VuZXJhdGUtc2xpZGVzLW1hcmtkb3duJztcblxuaW1wb3J0IHtcblx0QnV0dG9uLCBcblx0QmFzZUxpbmssXG5cdFNhdmVNb2RhbCwgXG5cdFRyZWVNZW51LFxuXHRTbGlkZXNNb2RhbFxufSBmcm9tICcuLi9jb21wb25lbnRzL2luZGV4JztcblxuXG5leHBvcnQgY29uc3QgVklFV19DT05URU5UX0NPTVBPU0VfTk9URVMgPSBcInZpZXctZ2VuZXJhdGUtbWFya2Rvd25cIjtcblxuXG5leHBvcnQgY2xhc3MgR2VuZXJhdGVNYXJrZG93biBleHRlbmRzIEl0ZW1WaWV3IHtcblx0XG5cdHNldHRpbmdzOiBHZW5lcmF0ZU1hcmtkb3duUGx1Z2luU2V0dGluZ3NUeXBlO1xuXG5cdGNvbnRhaW5lcjogRWxlbWVudDtcblx0dG9vbGJhcjogRWxlbWVudDtcblx0c3RydWN0dXJlOiBFbGVtZW50O1xuXHRnZW5lcmF0ZVByZXZpZXdQYXJlbnQ6IEVsZW1lbnQ7XG5cdGdlbmVyYXRlTWFya2Rvd25QYXJlbnQ6IEVsZW1lbnQ7XG5cdGdlbmVyYXRlU2xpZGVzUGFyZW50OiBFbGVtZW50O1xuXG5cdGxpbmtzVHJlZTogTGlua1RyZWVUeXBlW10gPSBbXTtcblx0bG9hZGVkRmlsZXM6IFRBYnN0cmFjdEZpbGVbXSA9IFtdO1xuXHRtYXhMZXZlbDogbnVtYmVyID0gMDtcblx0cHJvY2Vzc2VkOiBzdHJpbmdbXSA9IFtdO1xuXHRtYWluTmFtZUxpbmtzOiBzdHJpbmdbXSA9IFtdO1xuXG5cdG1hcmtkb3duOiBzdHJpbmcgPSBcIlwiO1xuXHRpZ25vcmVkTGlua3M6IHN0cmluZ1tdID0gW107XG5cdGltYWdlczogc3RyaW5nW10gPSBbXTtcblxuXHRzdGF0aWMgaW1hZ2VUeXBlcyA9IFsnanBnJywgJ2pwZWcnLCAncG5nJywgJ2dpZicsICd3ZWJwJywgJ3RpZmYnLCAnYm1wJ10ubWFwKChpdDogc3RyaW5nKSA9PiBgLiR7aXR9YCk7XG5cblx0Y29uc3RydWN0b3IobGVhZjogV29ya3NwYWNlTGVhZiwgc2V0dGluZ3M6IEdlbmVyYXRlTWFya2Rvd25QbHVnaW5TZXR0aW5nc1R5cGUpIHtcblx0XHRzdXBlcihsZWFmKTtcblx0XHR0aGlzLnNldHRpbmdzID0gc2V0dGluZ3M7XG5cdH1cblxuXHRhc3luYyBvbk9wZW4oKSB7XG5cdFx0Y29uc3QgY29udGFpbmVyID0gdGhpcy5jb250YWluZXJFbC5jaGlsZHJlblsxXTtcblxuXHRcdHRoaXMuY29udGFpbmVyID0gY29udGFpbmVyO1xuXHRcdGNvbnRhaW5lci5lbXB0eSgpO1xuXG5cdFx0dGhpcy50b29sYmFyID0gY29udGFpbmVyLmNyZWF0ZUVsKFwiZGl2XCIpO1xuXHRcdHRoaXMuZ2VuZXJhdGVQcmV2aWV3UGFyZW50ID0gdGhpcy50b29sYmFyLmNyZWF0ZUVsKCdzcGFuJyk7XG5cdFx0dGhpcy5nZW5lcmF0ZU1hcmtkb3duUGFyZW50ID0gdGhpcy50b29sYmFyLmNyZWF0ZUVsKCdzcGFuJyk7XG5cdFx0dGhpcy5nZW5lcmF0ZVNsaWRlc1BhcmVudCA9IHRoaXMudG9vbGJhci5jcmVhdGVFbCgnc3BhbicpO1xuXHRcdHRoaXMuc3RydWN0dXJlID0gdGhpcy5jb250YWluZXIuY3JlYXRlRWwoXCJkaXZcIik7XG5cblx0XHRuZXcgQnV0dG9uKHRoaXMuZ2VuZXJhdGVQcmV2aWV3UGFyZW50LCAnR2VuZXJhdGUgcHJldmlldycsICgpID0+IHtcblx0XHRcdC8vIGVtcHR5IHN0YXRlXG5cdFx0XHR0aGlzLmxpbmtzVHJlZSA9IFtdO1xuXHRcdFx0dGhpcy5tYXhMZXZlbCA9IDA7XG5cdFx0XHR0aGlzLnByb2Nlc3NlZCA9IFtdO1xuXHRcdFx0dGhpcy5tYWluTmFtZUxpbmtzID0gW107XG5cdFx0XHR0aGlzLmlnbm9yZWRMaW5rcyA9IFtdO1xuXHRcdFx0dGhpcy5tYXJrZG93biA9IFwiXCI7XG5cdFx0XHRcblx0XHRcdHRoaXMuc3RydWN0dXJlLmVtcHR5KCk7XG5cdFx0XHR0aGlzLmdlbmVyYXRlTWFya2Rvd25QYXJlbnQuZW1wdHkoKTtcblx0XHRcdHRoaXMuZ2VuZXJhdGVTbGlkZXNQYXJlbnQuZW1wdHkoKTtcblx0XHRcdHRoaXMucmVhZFNlbGVjdGVkTm90ZSgpO1xuXHRcdH0pO1xuXHR9XG5cblx0cGFyc2VMaW5rcyh0ZXh0OiBzdHJpbmcsIGluZGV4OiBib29sZWFuID0gZmFsc2UpIHtcblx0XHRjb25zdCBsaW5rcyA9IHRleHQubWF0Y2hBbGwoL1xcW1xcWyguKj8pXFxdXFxdL2cpO1xuXHRcdGxldCBjbGVhbkxpbmtzID0gWy4uLmxpbmtzXS5tYXAobCA9PiBsWzFdKTtcblxuXHRcdGNsZWFuTGlua3MgPSBbLi4ubmV3IFNldChjbGVhbkxpbmtzKV07XG5cblx0XHQvLyBmaWx0ZXIgb3V0IGFuY2hvciBsaW5rcyAoW1sjZm9vYmFyXV0pXG5cdFx0Y2xlYW5MaW5rcyA9IGNsZWFuTGlua3MuZmlsdGVyKGNsID0+ICFjbC5zdGFydHNXaXRoKCcjJykpO1xuXHRcdFxuXHRcdGNsZWFuTGlua3MgPSBjbGVhbkxpbmtzLmZpbHRlcihjbCA9PiAhY2wuc3RhcnRzV2l0aChgJHt0aGlzLnNldHRpbmdzLmxpdGVyYXR1cmVOb3RlfSNgKSk7XG5cblx0XHRjb25zdCBleGlzdGluZ05vdGVzID0gY2xlYW5MaW5rcy5tYXAoKGNsOiBzdHJpbmcpID0+IHtcblx0XHRcdGNsID0gZml4U3BhY2VJbk5hbWUoY2wpO1xuXG5cdFx0XHRpZiAoISFHZW5lcmF0ZU1hcmtkb3duLmltYWdlVHlwZXMuZmlsdGVyKChpdDogc3RyaW5nKSA9PiBjbC5pbmNsdWRlcyhpdC50b0xvd2VyQ2FzZSgpKSkubGVuZ3RoKSB7XG5cdFx0XHRcdHRoaXMuaW1hZ2VzLnB1c2goY2wpXG5cdFx0XHRcdHJldHVybiBmYWxzZTtcblx0XHRcdH1cblxuXHRcdFx0bGV0IGlzSW5saW5lID0gdHJ1ZTtcdFx0XHRcblx0XHRcdGlmICh0ZXh0LmluY2x1ZGVzKHRoaXMuc2V0dGluZ3MubGlzdE9mTGlua3NLZXl3b3JkKSkge1xuXHRcdFx0XHRsZXQgW2lubGluZVRleHQsIGxpbmtzVGV4dF0gPSB0ZXh0LnNwbGl0KHRoaXMuc2V0dGluZ3MubGlzdE9mTGlua3NLZXl3b3JkKTtcblx0XHRcdFx0aWYgKCFpbmxpbmVUZXh0LmluY2x1ZGVzKGNsKSlcblx0XHRcdFx0XHRpc0lubGluZSA9IGZhbHNlO1xuXHRcdFx0fVxuXG5cdFx0XHRsZXQgaXNJbmRleCA9IGZhbHNlO1xuXHRcdFx0aWYgKGluZGV4KSB7XG5cdFx0XHRcdGlzSW5saW5lID0gZmFsc2U7XG5cdFx0XHRcdGlzSW5kZXggPSB0cnVlO1xuXHRcdFx0fVxuXG5cdFx0XHRjb25zdCBub3RlID0gdGhpcy5sb2FkZWRGaWxlcy5maW5kKChmOiBURmlsZSkgPT4gZlsnYmFzZW5hbWUnXSA9PT0gY2wpO1xuXG5cdFx0XHRyZXR1cm4ge1xuXHRcdFx0XHRuYW1lOiBjbCxcblx0XHRcdFx0ZXhpc3RzOiAhIW5vdGUsXHRcblx0XHRcdFx0aW5saW5lOiBpc0lubGluZSxcblx0XHRcdFx0aW5kZXg6IGlzSW5kZXgsXG5cdFx0XHRcdHBhdGg6IG5vdGU/LnBhdGhcblx0XHRcdH07XG5cdFx0fSkuZmlsdGVyKEJvb2xlYW4pO1xuXG5cdFx0cmV0dXJuIGV4aXN0aW5nTm90ZXMgYXMgTGlua1RyZWVUeXBlW107XG5cdH1cblxuXHRhc3luYyByZWFkU2VsZWN0ZWROb3RlKCkge1xuXHRcdHRoaXMubG9hZGVkRmlsZXMgPSBhcHAudmF1bHQuZ2V0TWFya2Rvd25GaWxlcygpO1xuXG5cdFx0Y29uc3QgYWN0aXZlTm90ZSA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVGaWxlKCk7XG5cblx0XHRpZiAoIWFjdGl2ZU5vdGUpIHtcblx0XHRcdG5ldyBOb3RpY2UoYFNlbGVjdGVkIG5vdGUgaXMgaW52YWxpZC5gKTtcblx0XHRcdHRocm93IG5ldyBFcnJvcihcIlNlbGVjdGVkIG5vdGUgaXMgaW52YWxpZC5cIik7XG5cdFx0fVxuXHRcdGNvbnN0IGFjdGl2ZU5vdGVUZXh0ID0gYXdhaXQgZ2V0Tm90ZUJ5TmFtZSh0aGlzLmFwcCwgYWN0aXZlTm90ZS5wYXRoKTtcblxuXHRcdGNvbnN0IG1haW5Db250ZW50TGlua3MgPSB0aGlzLnBhcnNlTGlua3MoYWN0aXZlTm90ZVRleHQsIHRydWUpO1xuXHRcdFxuXHRcdHRoaXMubWFpbk5hbWVMaW5rcyA9IG1haW5Db250ZW50TGlua3MubWFwKChsOiBMaW5rVHJlZVR5cGUpID0+IGwubmFtZSk7XG5cblx0XHR0aGlzLmxpbmtzVHJlZSA9IGF3YWl0IHRoaXMuZ2VuZXJhdGVOb3Rlc0hpZXJhcmNoeShtYWluQ29udGVudExpbmtzKTtcblxuXHRcdGNvbnN0IHRpdGxlID0gYWN0aXZlTm90ZS5iYXNlbmFtZTtcblx0XHRuZXcgQmFzZUxpbmsodGhpcy5hcHAsIHRoaXMuc3RydWN0dXJlLCB0aXRsZSk7XG5cblx0XHRuZXcgVHJlZU1lbnUodGhpcy5hcHAsIHRoaXMuc3RydWN0dXJlLCB0aGlzLmxpbmtzVHJlZSwgKGlnbm9yZWRMaW5rczogc3RyaW5nW10pID0+IHtcblx0XHRcdHRoaXMuaWdub3JlZExpbmtzID0gaWdub3JlZExpbmtzO1xuXHRcdH0pO1xuXG5cdFx0bmV3IEJ1dHRvbih0aGlzLmdlbmVyYXRlTWFya2Rvd25QYXJlbnQsICdHZW5lcmF0ZSBtYXJrZG93bicsICgpID0+IHtcblx0XHRcdFxuXHRcdFx0Ly8gY2xlYW51cFxuXHRcdFx0dGhpcy5tYXJrZG93biA9IFwiXCI7XG5cblx0XHRcdHRoaXMuZ2VuZXJhdGVNYXJrZG93bkZpbGUodGhpcy5saW5rc1RyZWUsIGFjdGl2ZU5vdGVUZXh0KTtcblx0XHR9LCB7IGNsczogJ2dlbmVyYXRlLW1hcmtkb3duLWJ0bicgfSk7XG5cblx0XHRuZXcgQnV0dG9uKHRoaXMuZ2VuZXJhdGVTbGlkZXNQYXJlbnQsICdHZW5lcmF0ZSBzbGlkZXNob3cnLCAoKSA9PiB7XG5cdFx0XHRuZXcgU2xpZGVzTW9kYWwodGhpcy5hcHAsIHRoaXMubGlua3NUcmVlLCB0aGlzLmlnbm9yZWRMaW5rcywgKHNsaWRlczogU2xpZGVUeXBlW10sIGhhc1RpdGxlU2xpZGU6IGJvb2xlYW4sIGhhc0xhc3RTbGlkZTogYm9vbGVhbikgPT4ge1xuXHRcdFx0XHRjb25zdCBzbGlkZXNNRCA9IG5ldyBTbGlkZXNNYXJrZG93bihzbGlkZXMsIHRpdGxlLCBoYXNUaXRsZVNsaWRlLCBoYXNMYXN0U2xpZGUpO1xuXG5cdFx0XHRcdG5ldyBTYXZlTW9kYWwodGhpcy5hcHAsIGFzeW5jIChmaWxlTmFtZSkgPT4ge1xuXHRcdFx0XHRcdGF3YWl0IHRoaXMuYXBwLnZhdWx0LmFkYXB0ZXIud3JpdGUoYCR7ZmlsZU5hbWV9Lm1kYCwgc2xpZGVzTUQuc2xpZGVzaG93KVxuXHRcdFx0XHRcdG5ldyBOb3RpY2UoYFNsaWRlc2hvdyAke2ZpbGVOYW1lfSBjcmVhdGVkIHN1Y2Nlc3NmdWxseWApO1xuXHRcdFx0XHRcdHRoaXMuYXBwLndvcmtzcGFjZS5vcGVuTGlua1RleHQoYCR7ZmlsZU5hbWV9Lm1kYCwgXCJcIilcblxuXHRcdFx0XHR9KS5vcGVuKCk7XG5cdFx0XHR9KS5vcGVuKCk7XG5cdFx0fSwgeyBjbHM6ICdnZW5lcmF0ZS1tYXJrZG93bi1idG4nIH0pXG5cdH1cblxuXHRnZW5lcmF0ZU1hcmtkb3duRmlsZShsaW5rczogTGlua1RyZWVUeXBlW10sIG1haW5Ob3RlOiBzdHJpbmcpIHtcblx0XHR0aGlzLmNvbXBvc2VNYXJrZG93bihsaW5rcyk7XG5cblx0XHQvLyB0cmFuc2Zvcm0gbGlua3MgdG8gYW5jaG9yIGluIGluZGV4IG5vdGUgXG5cdFx0dGhpcy5tYWluTmFtZUxpbmtzLmZvckVhY2goKG1ubDogc3RyaW5nKSA9PiB7XG5cblx0XHRcdG1ubCA9IGZpeFNwYWNlSW5OYW1lKG1ubCk7XG5cdFx0XHRtYWluTm90ZSA9IG1haW5Ob3RlLnJlcGxhY2VBbGwoYFtbJHttbmx9XV1gLCBgW1sjJHttbmx9XV1gKVxuXHRcdH0pO1xuXG5cdFx0dGhpcy5tYXJrZG93biA9IG1haW5Ob3RlICsgdGhpcy5tYXJrZG93bjtcblxuXHRcdG5ldyBTYXZlTW9kYWwodGhpcy5hcHAsIGFzeW5jIChmaWxlTmFtZSkgPT4ge1xuXHRcdFx0YXdhaXQgdGhpcy5hcHAudmF1bHQuYWRhcHRlci53cml0ZShgJHtmaWxlTmFtZX0ubWRgLCB0aGlzLm1hcmtkb3duKVxuXHRcdFx0bmV3IE5vdGljZShgTm90ZSAke2ZpbGVOYW1lfSBjcmVhdGVkIHN1Y2Nlc3NmdWxseWApO1xuXHRcdFx0dGhpcy5hcHAud29ya3NwYWNlLm9wZW5MaW5rVGV4dChgJHtmaWxlTmFtZX0ubWRgLCBcIlwiKVxuXHRcdH0pLm9wZW4oKTtcblx0XHRcblx0fVxuXG5cdGNvbXBvc2VNYXJrZG93bihsaW5rczogTGlua1RyZWVUeXBlW10pIHtcblx0XHRsaW5rcy5mb3JFYWNoKGFzeW5jIChsaW5rOiBMaW5rVHJlZVR5cGUpID0+IHtcblx0XHRcdGxldCBub3RlID0gYXdhaXQgZ2V0Tm90ZUJ5TmFtZSh0aGlzLmFwcCwgbGluay5wYXRoKTtcblx0XHRcdGNvbnN0IGxvY2FsTGlua3MgPSB0aGlzLnBhcnNlTGlua3Mobm90ZSk7XG5cblx0XHRcdGlmICh0aGlzLmlnbm9yZWRMaW5rcy5pbmNsdWRlcyhsaW5rLm5hbWUpKVxuXHRcdFx0XHRyZXR1cm47XG5cblx0XHRcdC8vIHRyaW0gZW50ZXJzIGFuZCBzcGFjZXNcblx0XHRcdG5vdGUgPSBub3RlLnRyaW0oKTtcblxuXHRcdFx0aWYgKG5vdGUubGVuZ3RoID09IDApXG5cdFx0XHRcdHJldHVybjtcblxuXHRcdFx0Ly8gdHJhbnNmb3JtIGxpbmtzIHRvIGFuY2hvcnNcblx0XHRcdGxvY2FsTGlua3MuZm9yRWFjaCgobG9jYWxMaW5rOiBMaW5rVHJlZVR5cGUpID0+IHtcblx0XHRcdFx0aWYgKGxvY2FsTGluay5pbmxpbmUgJiYgdGhpcy5pZ25vcmVkTGlua3MuaW5jbHVkZXMobG9jYWxMaW5rLm5hbWUpKVxuXHRcdFx0XHRcdG5vdGUgPSBub3RlLnJlcGxhY2VBbGwoYFtbJHtsb2NhbExpbmsubmFtZX1dXWAsIGxvY2FsTGluay5uYW1lKTtcblx0XHRcdFx0ZWxzZVxuXHRcdFx0XHRcdG5vdGUgPSBub3RlLnJlcGxhY2VBbGwoYFtbJHtsb2NhbExpbmsubmFtZX1dXWAsIGBbWyMke2xvY2FsTGluay5uYW1lfV1dYClcblx0XHRcdH0pXG5cblx0XHRcdC8vIHJlbW92ZSB0aXRsZSBvbiBhIGZpcnN0IGxpbmVcblx0XHRcdGxldCBub3RlUm93cyA9IG5vdGUuc3BsaXQoJ1xcbicpO1xuXHRcdFx0bGV0IGZpcnN0Um93ID0gZml4U3BhY2VJbk5hbWUobm90ZVJvd3NbMF0pO1xuXHRcdFx0aWYgKGZpcnN0Um93LmluY2x1ZGVzKGAjICR7bGluay5uYW1lfWApKSB7XG5cdFx0XHRcdG5vdGVSb3dzLnNoaWZ0KCk7XG5cdFx0XHRcdG5vdGUgPSBub3RlUm93cy5qb2luKFwiXFxuXCIpLnRyaW0oKTtcblx0XHRcdH1cblx0XHRcdFxuXHRcdFx0Ly8gcmVtb3ZlICdLYW0gZFx1MDBFMWwnIHBhcnRcblx0XHRcdGlmIChub3RlLmluY2x1ZGVzKHRoaXMuc2V0dGluZ3MubGlzdE9mTGlua3NLZXl3b3JkKSkge1xuXHRcdFx0XHRsZXQgW2ltcG9ydGFudFBhcnQsIGVuZFBhcnRdID0gbm90ZS5zcGxpdCh0aGlzLnNldHRpbmdzLmxpc3RPZkxpbmtzS2V5d29yZCk7XG5cdFx0XHRcdG5vdGUgPSBpbXBvcnRhbnRQYXJ0LnRyaW0oKTtcblx0XHRcdH1cblx0XHRcdFxuXHRcdFx0Ly8gZ2VuZXJhdGUgbmVzdGVkIHRpdGxlIGUuZy4gaDMgLT4gIyMjIHRpdGxlM1xuXHRcdFx0bGV0IHRpdGxlID0gXCJcIjtcblx0XHRcdGlmIChsaW5rLmlubGluZSkge1xuXHRcdFx0XHQvLyBoNVxuXHRcdFx0XHR0aXRsZSA9IGAjIyMjIyAke2xpbmsubmFtZX1gO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0Y29uc3QgbmVzdGVkTGV2ZWwgPSBBcnJheShsaW5rLmxldmVsKS5maWxsKCcjJykuam9pbignJyk7XG5cdFx0XHRcdHRpdGxlID0gYCR7bmVzdGVkTGV2ZWx9ICR7bGluay5uYW1lfWA7XG5cdFx0XHR9XG5cblx0XHRcdG5vdGUgPSBgXFxuXFxuJHt0aXRsZX1cXG4ke25vdGV9YDtcblxuXHRcdFx0Ly8gc2hvdWxkIGJlIGxhc3Rcblx0XHRcdHRoaXMubWFya2Rvd24gKz0gbm90ZTtcblxuXHRcdFx0aWYgKCdjaGlsZHJlbicgaW4gbGluaylcblx0XHRcdFx0dGhpcy5jb21wb3NlTWFya2Rvd24obGluay5jaGlsZHJlbik7XG5cdFx0fSk7XG5cdH1cblxuXHRhc3luYyBnZW5lcmF0ZU5vdGVzSGllcmFyY2h5KGxpbmtzOiBMaW5rVHJlZVR5cGVbXSkge1xuXHRcdGNvbnN0IGxpbmtzT2JqOiBCdWlsZExpbmtUcmVlVHlwZSA9IGF3YWl0IHRoaXMuZGZzKGxpbmtzLCAwLCBbXSk7XG5cdFx0bGV0IGxpbmtzQXJyOiBMaW5rVHJlZVR5cGVbXSA9IFtdO1xuXHRcdFxuXHRcdE9iamVjdC5rZXlzKGxpbmtzT2JqKS5mb3JFYWNoKGtleSA9PiB7XG5cdFx0XHRjb25zdCB7cGFyZW50UmVmLCAuLi5yZXN0fSA9IGxpbmtzT2JqW2tleSBhcyBrZXlvZiBCdWlsZExpbmtUcmVlVHlwZV0gYXMgQnVpbGRMaW5rVHJlZVR5cGU7IFxuXHRcdFx0bGlua3NBcnIucHVzaCh7Li4ucmVzdCwgcGFyZW50OiAobGlua3NPYmpba2V5IGFzIGtleW9mIEJ1aWxkTGlua1RyZWVUeXBlXSBhcyBCdWlsZExpbmtUcmVlVHlwZSk/LnBhcmVudFJlZj8ubmFtZX0pO1xuXHRcdH0pO1xuXG5cdFx0Y29uc3QgZ2V0TmVzdGVkQ2hpbGRyZW4gPSAoYXJyOiBMaW5rVHJlZVR5cGVbXSwgcGFyZW50OiBzdHJpbmcgfCB1bmRlZmluZWQpID0+IHtcblx0XHRcdGxldCBjaGlsZHJlbiA9IFtdO1xuXHRcdFx0Zm9yKGxldCBpID0gMDsgaSA8IGFyci5sZW5ndGg7IGkrKykge1xuXHRcdFx0XHRpZihhcnJbaV0ucGFyZW50ID09IHBhcmVudCkge1xuXHRcdFx0XHRcdGNvbnN0IGdyYW5kQ2hpbGRyZW4gPSBnZXROZXN0ZWRDaGlsZHJlbihhcnIsIGFycltpXS5uYW1lKTtcblx0XHRcdFx0XHRpZihncmFuZENoaWxkcmVuLmxlbmd0aCkge1xuXHRcdFx0XHRcdFx0YXJyW2ldLmNoaWxkcmVuID0gZ3JhbmRDaGlsZHJlbjtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0Y2hpbGRyZW4ucHVzaChhcnJbaV0pO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0XHRyZXR1cm4gY2hpbGRyZW47XG5cdFx0fVxuXHRcdHJldHVybiBnZXROZXN0ZWRDaGlsZHJlbihsaW5rc0FyciwgdW5kZWZpbmVkKTtcblx0fVxuXG5cdGFzeW5jIGRmcyhsaW5rczogQnVpbGRMaW5rVHJlZVR5cGVbXSwgbGV2ZWw6IG51bWJlciwgcHJvY2Vzc2VkOiBzdHJpbmdbXSwgcGFyZW50UmVmPzogb2JqZWN0LCB0aXRsZU1hcHBpbmc/OiBvYmplY3QpIHtcblx0XHR0aXRsZU1hcHBpbmcgPSAodGl0bGVNYXBwaW5nIGFzIEJ1aWxkTGlua1RyZWVUeXBlKSA/PyB7fTsgXG5cblx0XHRmb3IgYXdhaXQgKGNvbnN0IFtvcmRlciwgbGlua10gb2YgbGlua3MuZW50cmllcygpKSB7XG5cblx0XHRcdC8vIHNraXAgbGluayBmcm9tIG1haW5Db250ZW50XG5cdFx0XHRpZiAodGhpcy5tYWluTmFtZUxpbmtzLmluY2x1ZGVzKGxpbmsubmFtZSkgJiYgbGV2ZWwgIT0gMClcblx0XHRcdFx0Y29udGludWU7XG5cblx0XHRcdC8vIHNraXAgaWYgbGluayBpcyBhbHJlYWR5IHByb2Nlc3NlZFxuXHRcdFx0aWYgKHByb2Nlc3NlZC5pbmNsdWRlcyhsaW5rLm5hbWUpKSB7XG5cdFx0XHRcdGNvbnRpbnVlO1xuXHRcdFx0fVxuXHRcdFx0cHJvY2Vzc2VkLnB1c2gobGluay5uYW1lKTtcblxuXHRcdFx0Y29uc3Qgbm90ZSA9IGF3YWl0IGdldE5vdGVCeU5hbWUodGhpcy5hcHAsIGxpbmsucGF0aClcblx0XHRcdGNvbnN0IHN1YkxpbmtzID0gdGhpcy5wYXJzZUxpbmtzKG5vdGUpO1xuXHRcdFxuXHRcdFx0dGhpcy5tYXhMZXZlbCA9IGxldmVsICsgMTtcblxuXHRcdFx0KHRpdGxlTWFwcGluZyBhcyBhbnkpW2xpbmsubmFtZV0gPSB7IC4uLmxpbmssIHBhcmVudFJlZiwgbGV2ZWw6IHRoaXMubWF4TGV2ZWwsIG9yZGVyfTtcblxuXHRcdFx0aWYgKGxpbmtzLmxlbmd0aCA+IDApXG5cdFx0XHRcdGF3YWl0IHRoaXMuZGZzKHN1YkxpbmtzLCB0aGlzLm1heExldmVsLCBwcm9jZXNzZWQsICh0aXRsZU1hcHBpbmcgYXMgYW55KVtsaW5rLm5hbWVdLCB0aXRsZU1hcHBpbmcpO1xuXHRcdH1cblxuXHRcdHJldHVybiB0aXRsZU1hcHBpbmcgYXMgQnVpbGRMaW5rVHJlZVR5cGU7XG5cdH1cblxuXHRhc3luYyBvbkNsb3NlKCkge1xuXHRcdC8vIE5vdGhpbmcgdG8gY2xlYW4gdXAuXG5cdH1cblxuXHRnZXRWaWV3VHlwZSgpIHtcblx0XHRyZXR1cm4gVklFV19DT05URU5UX0NPTVBPU0VfTk9URVM7XG5cdH1cblxuXHRnZXREaXNwbGF5VGV4dCgpIHtcblx0XHRyZXR1cm4gXCJOb3RlcyBNZXJnZXJcIjtcblx0fVxufVxuIiwgImltcG9ydCB7IFRGaWxlLCBBcHAgfSBmcm9tICdvYnNpZGlhbic7XG5cbmV4cG9ydCBjb25zdCBmaXhTcGFjZUluTmFtZSA9IChuYW1lOiBzdHJpbmcpID0+IHtcblx0cmV0dXJuIG5hbWUucmVwbGFjZSgvW1xcdTAwQTBcXHUxNjgwXFx1MTgwRVxcdTIwMDAtXFx1MjAwQlxcdTIwMkZcXHUyMDVGXFx1MzAwMFxcdUZFRkZdLywgXCIgXCIpLnRyaW0oKTtcbn1cblxuZXhwb3J0IGNvbnN0IGdldE5vdGVCeU5hbWUgPSBhc3luYyAoYXBwOiBBcHAsIHBhdGg6IHN0cmluZykgPT4ge1xuXHRjb25zdCBmaWxlID0gYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChwYXRoKTtcblxuXHRpZiAoIShmaWxlIGluc3RhbmNlb2YgVEZpbGUpKVxuXHRcdHJldHVybiBcIlwiO1x0XG5cblx0cmV0dXJuIGF3YWl0IGFwcC52YXVsdC5jYWNoZWRSZWFkKGZpbGUpO1xufVxuIiwgImltcG9ydCB7IFNsaWRlVHlwZSB9IGZyb20gXCJzcmMvdHlwZXNcIjtcblxuZXhwb3J0IGNsYXNzIFNsaWRlc01hcmtkb3duIHtcblxuXHRzbGlkZXM6IFNsaWRlVHlwZVtdID0gW107XG5cdHNsaWRlc2hvdzogc3RyaW5nID0gXCJcIjtcblxuXHRjb25zdHJ1Y3RvcihzbGlkZXM6IFNsaWRlVHlwZVtdLCB0aXRsZTogc3RyaW5nLCBoYXNUaXRsZVNsaWRlOiBib29sZWFuLCBoYXNMYXN0U2xpZGU6IGJvb2xlYW4pIHtcblx0XHR0aGlzLnNsaWRlcyA9IHNsaWRlcztcblxuXHRcdHRoaXMuc2xpZGVzaG93ICs9IHRoaXMuY3JlYXRlUHJvcGVydGllcygpO1xuXG5cdFx0aWYgKGhhc1RpdGxlU2xpZGUpXG5cdFx0XHR0aGlzLnNsaWRlc2hvdyArPSB0aGlzLmNyZWF0ZVRpdGxlU2xpZGUodGl0bGUpO1xuXHRcdFxuXHRcdHNsaWRlcy5mb3JFYWNoKChzbGlkZTogU2xpZGVUeXBlKSA9PiB7XG5cdFx0XHRpZiAoc2xpZGUudHlwZSA9PT0gJ2Jhc2ljJylcblx0XHRcdFx0dGhpcy5zbGlkZXNob3cgKz0gdGhpcy5jcmVhdGVCYXNpY1NsaWRlKHNsaWRlLmxpbmsubmFtZSk7XG5cdFx0XHRlbHNlIGlmIChzbGlkZS50eXBlID09PSAnc3BsaXQnKVxuXHRcdFx0XHR0aGlzLnNsaWRlc2hvdyArPSB0aGlzLmNyZWF0ZVNwbGl0U2xpZGUoc2xpZGUubGluay5uYW1lKTtcblx0XHR9KTtcblxuXHRcdGlmIChoYXNMYXN0U2xpZGUpXG5cdFx0XHR0aGlzLnNsaWRlc2hvdyArPSB0aGlzLmNyZWF0ZUxhc3RTbGlkZSgpO1xuXG5cdFx0cmV0dXJuIHRoaXM7XG5cdH1cblxuXHRjcmVhdGVQcm9wZXJ0aWVzKCkge1xuXHRcdHJldHVybiBgLS0tXFxuYCArIFxuXHRcdFx0XHRgdGhlbWU6IGNvbnN1bHRcXG5gICsgXG5cdFx0XHRcdGBoZWlnaHQ6IDU0MFxcbmAgKyBcblx0XHRcdFx0YG1hcmdpbjogMFxcbmAgK1xuXHRcdFx0XHRgbWF4U2NhbGU6IDRcXG5gICsgXG5cdFx0XHRcdGAtLS1cXG5cXG5gO1xuXHR9XG5cblx0Y3JlYXRlVGl0bGVTbGlkZSh0aXRsZTogc3RyaW5nKSB7XG5cdFx0cmV0dXJuIGBcXG48IS0tIHNsaWRlIHRlbXBsYXRlPVwiW1t0cGwtY29uLXRpdGxlXV1cIiAtLT5cXG5cXG5gICtcblx0XHRcdFx0YCMjICR7dGl0bGV9XFxuYCArIFxuXHRcdFx0XHRgOjo6IGJsb2NrXFxuYCArIFxuXHRcdFx0XHRgIyMjIyBhZGQgYXV0aG9yIGhlcmVcXG5gICtcblx0XHRcdFx0YDo6OlxcblxcbmA7XG5cdH1cblxuXHRjcmVhdGVMYXN0U2xpZGUoKSB7XG5cdFx0cmV0dXJuIGBcXG4tLS1cXG5gICtcblx0XHRcdGA8IS0tIHNsaWRlIHRlbXBsYXRlPVwiW1t0cGwtY29uLXNwbGFzaF1dXCIgLS0+XFxuXFxuYCArXG5cdFx0XHRgIyAqKlRoYW5rIHlvdSBmb3IgeW91ciBhdHRlbnRpb24qKlxcblxcbmA7XG5cdH1cblxuXHRjcmVhdGVCYXNpY1NsaWRlKG5hbWU6IHN0cmluZykge1xuXHRcdHJldHVybiBgXFxuLS0tXFxuYCArIFxuXHRcdFx0YDwhLS0gc2xpZGUgdGVtcGxhdGU9XCJbW3RwbC1jb24tZGVmYXVsdC1ib3hdXVwiIC0tPlxcblxcbmAgK1xuXHRcdFx0YDo6OiB0aXRsZVxcbmAgK1xuXHRcdFx0YCMjIyBfKioke25hbWV9KipfXFxuYCArXG5cdFx0XHRgOjo6XFxuXFxuYCArXG5cdFx0XHRgOjo6IGJsb2NrXFxuYCArIFxuXHRcdFx0YC1cXG5gICsgXG5cdFx0XHRgLVxcbmAgK1xuXHRcdFx0YC1cXG5gICtcblx0XHRcdGA6OjpcXG5cXG5gO1xuXHR9XG5cblx0Y3JlYXRlU3BsaXRTbGlkZShuYW1lOiBzdHJpbmcpIHtcblx0XHRyZXR1cm4gYFxcbi0tLVxcbmAgKyBcblx0XHRcdGA8IS0tIHNsaWRlIHRlbXBsYXRlPVwiW1t0cGwtY29uLTItMS1ib3hdXVwiIC0tPlxcblxcbmAgK1xuXHRcdFx0YDo6OiB0aXRsZVxcbmAgKyBcblx0XHRcdGAjIyMgXyoqJHtuYW1lfSoqX1xcbmAgK1xuXHRcdFx0YDo6OlxcblxcbmAgKyBcblx0XHRcdGA6OjogbGVmdFxcbmAgKyBcblx0XHRcdGAqKnRleHQgaW4gbGVmdCBib3gqKlxcbmAgKyBcblx0XHRcdGAtIGxvcmVtIGlwc3VtXFxuYCArXG5cdFx0XHRgLVxcbmAgKyBcblx0XHRcdGAtXFxuYCArXG5cdFx0XHRgOjo6XFxuXFxuYCArXG5cdFx0XHRgOjo6IHJpZ2h0XFxuYCArXG5cdFx0XHRgKip0ZXh0IGluIHJpZ2h0IGJveCoqXFxuYCArIFxuXHRcdFx0YC0gbG9yZW0gaXBzdW1cXG5gICsgXG5cdFx0XHRgLVxcbmAgKyAgXG5cdFx0XHRgLVxcbmAgK1xuXHRcdFx0YDo6OlxcblxcbmA7XG5cdH1cbn1cbiIsICJleHBvcnQgY2xhc3MgQnV0dG9uIHtcclxuXHRidG46IEhUTUxCdXR0b25FbGVtZW50O1xyXG5cclxuXHRjb25zdHJ1Y3RvcihlbGVtZW50OiBFbGVtZW50LCB0ZXh0OiBzdHJpbmcsIG9uQ2xpY2s6IChjb250ZXh0OiBCdXR0b24pID0+IHZvaWQsIGFyZ3M/OiBvYmplY3QpIHtcclxuXHRcdHRoaXMuYnRuID0gZWxlbWVudC5jcmVhdGVFbCgnYnV0dG9uJywgeyB0ZXh0LCAuLi5hcmdzIH0pO1xyXG5cdFx0dGhpcy5idG4ub25jbGljayA9ICgpID0+IHtcclxuXHRcdFx0b25DbGljayh0aGlzKTtcclxuXHRcdH07XHRcclxuXHRcdHJldHVybiB0aGlzO1xyXG5cdH1cclxufVxyXG4iLCAiaW1wb3J0IHsgQXBwIH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgeyBMaW5rVHJlZVR5cGUgfSBmcm9tIFwic3JjL3R5cGVzXCI7XG5cbmV4cG9ydCBjbGFzcyBCYXNlTGluayB7XG5cdGNvbnRleHQ6IEFwcDtcblx0ZWxlbWVudDogRWxlbWVudDtcblx0bmFtZTogc3RyaW5nO1xuXG5cdGNvbnN0cnVjdG9yKGNvbnRleHQ6IEFwcCwgZWxlbWVudDogRWxlbWVudCwgbmFtZTogc3RyaW5nKSB7XG5cdFx0dGhpcy5jb250ZXh0ID0gY29udGV4dDtcblx0XHR0aGlzLmVsZW1lbnQgPSBlbGVtZW50O1xuXHRcdHRoaXMubmFtZSA9IG5hbWU7XG5cblx0XHR0aGlzLnJlbmRlcigpO1xuXHR9XG5cblx0cmVuZGVyKCkge1xuXHRcdGNvbnN0IGhyZWZUaXRsZSA9IHRoaXMuZWxlbWVudC5jcmVhdGVFbCgnYScsIHsgdGV4dDogdGhpcy5uYW1lLCBjbHM6ICdjb250X190aXRsZScgfSk7XG5cdFx0aHJlZlRpdGxlLm9uY2xpY2sgPSAoKSA9PiB7XG5cdFx0XHR0aGlzLmNvbnRleHQud29ya3NwYWNlLm9wZW5MaW5rVGV4dCh0aGlzLm5hbWUsIFwiXCIpO1xuXHRcdH1cblx0fVxuXG59XG5cbi8vIExpbmsgd2l0aCBpbm5lciBzdGF0ZSBhbmQgaGVscGVyIGZuY3NcbmV4cG9ydCBjbGFzcyBMaW5rIHtcblxuXHRjb250ZXh0OiBBcHA7XG5cdGE6IEhUTUxFbGVtZW50O1xuXHRsaW5rOiBMaW5rVHJlZVR5cGU7XG5cdGVsZW1lbnQ6IEVsZW1lbnQ7XG5cdHRvZ2dsZWRTdGF0ZTogYm9vbGVhbiA9IGZhbHNlO1xuXG5cdGNvbnN0cnVjdG9yKGNvbnRleHQ6IEFwcCwgZWxlbWVudDogRWxlbWVudCwgbGluazogTGlua1RyZWVUeXBlLCByZW5kZXJOb3c6IGJvb2xlYW4gPSB0cnVlKSB7XG5cdFx0dGhpcy5saW5rID0gbGluaztcblx0XHR0aGlzLmNvbnRleHQgPSBjb250ZXh0O1xuXHRcdHRoaXMuZWxlbWVudCA9IGVsZW1lbnQ7XG5cblx0XHRpZiAocmVuZGVyTm93KVxuXHRcdFx0dGhpcy5yZW5kZXIoZmFsc2UpO1xuXG5cdFx0cmV0dXJuIHRoaXM7XG5cdH1cblxuXHRyZW5kZXIoc3RhdGU6IGJvb2xlYW4pIHtcblx0XHR0aGlzLmEgPSB0aGlzLmVsZW1lbnQuY3JlYXRlRWwoJ2EnLCB7IHRleHQ6IHRoaXMubGluay5uYW1lLCBjbHM6IFwibGlua1wiIH0pO1xuXHRcdCF0aGlzLmxpbmsuZXhpc3RzICYmIHRoaXMuYS5hZGRDbGFzcyhcImNvbnRfX2xpbmstbm90LWV4aXN0XCIpO1xuXHRcdHRoaXMubGluay5pbmxpbmUgJiYgdGhpcy5hLmFkZENsYXNzKFwiaW5saW5lXCIpO1xuXHRcdHRoaXMuYS5vbmNsaWNrID0gKCkgPT4ge1xuXHRcdFx0dGhpcy5jb250ZXh0LndvcmtzcGFjZS5vcGVuTGlua1RleHQodGhpcy5saW5rLm5hbWUsIFwiXCIpO1xuXHRcdFx0IXRoaXMubGluay5leGlzdHMgJiYgdGhpcy5hLnJlbW92ZUNsYXNzKFwiY29udF9fbGluay1ub3QtZXhpc3RcIik7XG5cdFx0fTtcblxuXHRcdHRoaXMudG9nZ2xlKHN0YXRlKTtcblx0fVxuXG5cdHRvZ2dsZShzdGF0ZTogYm9vbGVhbikge1xuXHRcdGlmIChzdGF0ZSlcblx0XHRcdHRoaXMuYS5yZW1vdmVDbGFzcygnc3RyaWtldGhyb3VnaCcpO1xuXHRcdGVsc2Vcblx0XHRcdHRoaXMuYS5hZGRDbGFzcygnc3RyaWtldGhyb3VnaCcpO1xuXHR9XG59XG4iLCAiaW1wb3J0IHsgQXBwLCBNb2RhbCwgU2V0dGluZyB9IGZyb20gXCJvYnNpZGlhblwiO1xyXG5cclxuZXhwb3J0IGNsYXNzIFNhdmVNb2RhbCBleHRlbmRzIE1vZGFsIHtcclxuICByZXN1bHQ6IHN0cmluZztcclxuICBvblN1Ym1pdDogKHJlc3VsdDogc3RyaW5nKSA9PiB2b2lkO1xyXG5cclxuICBjb25zdHJ1Y3RvcihhcHA6IEFwcCwgb25TdWJtaXQ6IChyZXN1bHQ6IHN0cmluZykgPT4gdm9pZCkge1xyXG4gICAgc3VwZXIoYXBwKTtcclxuICAgIHRoaXMub25TdWJtaXQgPSBvblN1Ym1pdDtcclxuICB9XHJcblxyXG4gIG9uT3BlbigpIHtcclxuICAgIGNvbnN0IHsgY29udGVudEVsIH0gPSB0aGlzO1xyXG5cclxuICAgIGNvbnRlbnRFbC5jcmVhdGVFbChcImgxXCIsIHsgdGV4dDogXCJTYXZlIGFzXCIgfSk7XHJcblxyXG4gICAgbmV3IFNldHRpbmcoY29udGVudEVsKVxyXG4gICAgICAuc2V0TmFtZShcIkZpbGUgbmFtZTogXCIpXHJcbiAgICAgIC5hZGRUZXh0KCh0ZXh0KSA9PlxyXG4gICAgICAgIHRleHQub25DaGFuZ2UoKHZhbHVlKSA9PiB7XHJcbiAgICAgICAgICB0aGlzLnJlc3VsdCA9IHZhbHVlXHJcbiAgICAgICAgfSkpO1xyXG5cclxuICAgIG5ldyBTZXR0aW5nKGNvbnRlbnRFbClcclxuICAgICAgLmFkZEJ1dHRvbigoYnRuKSA9PlxyXG4gICAgICAgIGJ0blxyXG4gICAgICAgICAgLnNldEJ1dHRvblRleHQoXCJHZW5lcmF0ZSBtYXJrZG93biBub3RlXCIpXHJcbiAgICAgICAgICAuc2V0Q3RhKClcclxuICAgICAgICAgIC5vbkNsaWNrKCgpID0+IHtcclxuICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgICAgICAgICB0aGlzLm9uU3VibWl0KHRoaXMucmVzdWx0KTtcclxuICAgICAgICAgIH0pKTtcclxuICB9XHJcblxyXG4gIG9uQ2xvc2UoKSB7XHJcbiAgICBsZXQgeyBjb250ZW50RWwgfSA9IHRoaXM7XHJcbiAgICBjb250ZW50RWwuZW1wdHkoKTtcclxuICB9XHJcbn1cclxuIiwgImltcG9ydCB7IEFwcCB9IGZyb20gJ29ic2lkaWFuJztcbmltcG9ydCB7IExpbmtUcmVlVHlwZSB9IGZyb20gJ3NyYy90eXBlcyc7XG5pbXBvcnQge1xuXHRMaW5rLCBDaGVja2JveFxufSBmcm9tICcuL2luZGV4JztcblxuXG5mdW5jdGlvbiBmbGF0dGVuQ2hpbGRyZW4obGluazogTGlua1RyZWVUeXBlLCBjaGlsZHJlbjogc3RyaW5nW10pIHtcblx0aWYgKCdjaGlsZHJlbicgaW4gbGluaykge1xuXHRcdGNvbnN0IGNoaWxkcmVuTGlua05hbWVzID0gbGluay5jaGlsZHJlbi5tYXAoKGw6IExpbmtUcmVlVHlwZSkgPT4gbC5uYW1lKTsgXG5cdFx0Y2hpbGRyZW4ucHVzaCguLi5jaGlsZHJlbkxpbmtOYW1lcyk7XG5cdFx0bGluay5jaGlsZHJlbi5mb3JFYWNoKChsOiBMaW5rVHJlZVR5cGUpID0+IHtcblx0XHRcdGZsYXR0ZW5DaGlsZHJlbihsLCBjaGlsZHJlbik7XG5cdFx0fSlcblx0fVxuXHRyZXR1cm4gY2hpbGRyZW47XG59XG5cbmV4cG9ydCBjbGFzcyBUcmVlTWVudSB7XG5cdGFwcDogQXBwO1xuXHRVTDogRWxlbWVudDtcblxuXHRpZ25vcmVkTGlua3M6IHN0cmluZ1tdID0gW107XG5cdGxpbmtzVHJlZTogTGlua1RyZWVUeXBlW10gPSBbXTtcblxuXHRjb25zdHJ1Y3RvcihhcHA6IEFwcCwgc3RydWN0dXJlOiBFbGVtZW50LCBsaW5rc1RyZWU6IExpbmtUcmVlVHlwZVtdLCBldmVudDogKGlnbm9yZWRMaW5rczogc3RyaW5nW10pID0+IHZvaWQpIHtcblx0XHR0aGlzLmFwcCA9IGFwcDtcblx0XHRsZXQgbWVudSA9IHN0cnVjdHVyZS5jcmVhdGVFbCgnZGl2JywgeyBjbHM6ICd0cmVlLW1lbnUnfSk7XG5cdFx0dGhpcy5VTCA9IG1lbnUuY3JlYXRlRWwoJ3VsJyk7XG5cdFx0dGhpcy5saW5rc1RyZWUgPSBsaW5rc1RyZWU7XG5cblx0XHR0aGlzLnJlbmRlcih0aGlzLmxpbmtzVHJlZSwgdGhpcy5VTCwgW10sIGV2ZW50KTtcblx0fVxuXG5cdHJlbmRlcihsaW5rczogTGlua1RyZWVUeXBlW10sIG1lbnVFbDogRWxlbWVudCwgY2hpbGRyZW5MaW5rczogc3RyaW5nW10sIGV2ZW50OiAobGlua3M6IHN0cmluZ1tdKSA9PiB2b2lkKSB7XG5cdFx0aWYgKCFjaGlsZHJlbkxpbmtzKSBcblx0XHRcdGNoaWxkcmVuTGlua3MgPSBbXTtcblxuXHRcdGxpbmtzLmZvckVhY2goKGxpbms6IExpbmtUcmVlVHlwZSkgPT4ge1xuXHRcdFx0Y29uc3QgbGkgPSBtZW51RWwuY3JlYXRlRWwoJ2xpJyk7XG5cdFx0XHRjb25zdCBsaW5rRWwgPSBuZXcgTGluayh0aGlzLmFwcCwgbGksIGxpbmssIGZhbHNlKTtcblxuXHRcdFx0bGV0IHN0YXRlOiBib29sZWFuID0gIWNoaWxkcmVuTGlua3MuaW5jbHVkZXMobGlua0VsLmxpbmsubmFtZSk7XG5cblx0XHRcdGlmICghbGluay5leGlzdHMpXG5cdFx0XHRcdHN0YXRlID0gZmFsc2U7IFxuXG5cdFx0XHRuZXcgQ2hlY2tib3gobGksIHN0YXRlLCBsaW5rLmV4aXN0cywgKCkgPT4ge1xuXHRcdFx0XHRjb25zdCBpZ25vcmVkQ2hpbGRyZW4gPSBbbGlua0VsLmxpbmsubmFtZSwgLi4uZmxhdHRlbkNoaWxkcmVuKGxpbmtFbC5saW5rLCBbXSldO1xuXG5cdFx0XHRcdGlmIChzdGF0ZSA9PSBmYWxzZSkgeyBcblx0XHRcdFx0XHQvLyByZW1vdmUgY2hpbGRyZW4gZnJvbSBjaGlsZHJlbkxpbmtzXG5cdFx0XHRcdFx0Y2hpbGRyZW5MaW5rcyA9IGNoaWxkcmVuTGlua3MuZmlsdGVyKChjbDogc3RyaW5nKSA9PiAhaWdub3JlZENoaWxkcmVuLmluY2x1ZGVzKGNsKSk7XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0Y2hpbGRyZW5MaW5rcy5wdXNoKC4uLmlnbm9yZWRDaGlsZHJlbik7XG5cdFx0XHRcdFx0XG5cdFx0XHRcdFx0Ly8gcmVtb3ZlIGR1cGVzXG5cdFx0XHRcdFx0Y2hpbGRyZW5MaW5rcyA9IFsuLi5uZXcgU2V0KGNoaWxkcmVuTGlua3MpXVxuXHRcdFx0XHR9XG5cblx0XHRcdFx0dGhpcy5pZ25vcmVkTGlua3MgPSBjaGlsZHJlbkxpbmtzO1xuXHRcdFx0XHRcblx0XHRcdFx0Ly8gY2xlYW51cCBhbmQgcmVyZW5kZXJcblx0XHRcdFx0dGhpcy5VTC5lbXB0eSgpXG5cdFx0XHRcdHRoaXMucmVuZGVyKHRoaXMubGlua3NUcmVlLCB0aGlzLlVMLCBjaGlsZHJlbkxpbmtzLCBldmVudCk7XG5cdFx0XHR9KTtcblxuXHRcdFx0bGlua0VsLnJlbmRlcihzdGF0ZSk7XG5cblx0XHRcdGlmICgnY2hpbGRyZW4nIGluIGxpbmspIHtcblx0XHRcdFx0Y29uc3QgdWwgPSBsaS5jcmVhdGVFbCgndWwnKTtcblx0XHRcdFx0dGhpcy5yZW5kZXIobGluay5jaGlsZHJlbiwgdWwsIGNoaWxkcmVuTGlua3MsIGV2ZW50KTtcblx0XHRcdH1cblx0XHR9KTtcblxuXHRcdHJldHVybiBldmVudCh0aGlzLmlnbm9yZWRMaW5rcyk7XG5cdH1cbn1cbiIsICJleHBvcnQgY2xhc3MgQ2hlY2tib3gge1xyXG5cclxuXHRjYjogSFRNTElucHV0RWxlbWVudDtcclxuXHRjb25zdHJ1Y3RvcihlbGVtZW50OiBFbGVtZW50LCBzdGF0ZTogYm9vbGVhbiwgZXhpc3RzOiBib29sZWFuLCBvbkNsaWNrOiAoY29udGV4dDogQ2hlY2tib3gpID0+IHZvaWQpIHtcclxuXHRcdHRoaXMuY2IgPSBlbGVtZW50LmNyZWF0ZUVsKFwiaW5wdXRcIiwge1xyXG5cdFx0XHR0eXBlOiAnY2hlY2tib3gnLFxyXG5cdFx0XHRjbHM6ICdjaGVja2JveC1idG4nXHJcblx0XHR9KTtcclxuXHJcblx0XHR0aGlzLmNiLmNoZWNrZWQgPSBzdGF0ZTtcclxuXHJcblx0XHRpZiAoIWV4aXN0cykge1xyXG5cdFx0XHR0aGlzLmNiLmRpc2FibGVkID0gdHJ1ZTtcclxuXHRcdFx0dGhpcy5jYi5jaGVja2VkID0gZmFsc2U7XHJcblx0XHRcdHRoaXMuY2IuYWRkQ2xhc3MoJ2NoZWNrYm94LWJ0bi1kaXNhYmxlZCcpO1xyXG5cdFx0fVxyXG5cdFx0dGhpcy5jYi5vbmNsaWNrID0gKCkgPT4ge1xyXG5cdFx0XHRvbkNsaWNrKHRoaXMpO1xyXG5cdFx0fTtcdFxyXG5cdFx0cmV0dXJuIHRoaXM7XHJcblx0fVxyXG59XHJcbiIsICJpbXBvcnQgeyBBcHAsIEJ1dHRvbkNvbXBvbmVudCwgRHJvcGRvd25Db21wb25lbnQsIE1vZGFsLCBTZXR0aW5nIH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgeyBMaW5rVHJlZVR5cGUsIFNsaWRlVHlwZSB9IGZyb20gXCJzcmMvdHlwZXNcIjtcbmltcG9ydCB7IENoZWNrYm94IH0gZnJvbSBcIi4vaW5kZXhcIjtcblxuXG5leHBvcnQgY2xhc3MgU2xpZGVzTW9kYWwgZXh0ZW5kcyBNb2RhbCB7XG4gIG9uU3VibWl0OiAoc2xpZGVzOiBTbGlkZVR5cGVbXSwgdGl0bGVTbGlkZTogYm9vbGVhbiwgbGFzdFNsaWRlOiBib29sZWFuKSA9PiB2b2lkO1xuICBsaW5rc0VsOiBFbGVtZW50O1xuICBsaW5rczogTGlua1RyZWVUeXBlW107XG4gIGZsYXR0ZW5lZExpbmtzOiBMaW5rVHJlZVR5cGVbXSA9IFtdO1xuICBzbGlkZXM6IFNsaWRlVHlwZVtdO1xuICBpZ25vcmVkTGlua3M6IHN0cmluZ1tdO1xuICBkZXB0aDogbnVtYmVyO1xuICBtYXhEZXB0aCA9IDE7XG4gIHRpdGxlU2xpZGU6IGJvb2xlYW4gPSBmYWxzZTtcbiAgbGFzdFNsaWRlOiBib29sZWFuID0gZmFsc2U7XG5cbiAgY29uc3RydWN0b3IoYXBwOiBBcHAsIGxpbmtzOiBMaW5rVHJlZVR5cGVbXSwgaWdub3JlZExpbmtzOiBzdHJpbmdbXSwgb25TdWJtaXQ6IChzbGlkZXM6IFNsaWRlVHlwZVtdLCB0aXRsZVNsaWRlOiBib29sZWFuLCBsYXN0U2xpZGU6IGJvb2xlYW4pID0+IHZvaWQpIHtcbiAgICBzdXBlcihhcHApO1xuXHR0aGlzLmxpbmtzID0gbGlua3M7XG5cdHRoaXMuaWdub3JlZExpbmtzID0gaWdub3JlZExpbmtzO1xuICAgIHRoaXMub25TdWJtaXQgPSBvblN1Ym1pdDtcbiAgfVxuXG4gIG9uT3BlbigpIHtcbiAgICBjb25zdCB7IGNvbnRlbnRFbCB9ID0gdGhpcztcblxuXHRjb250ZW50RWwuZW1wdHkoKTtcbiAgICBjb250ZW50RWwuY3JlYXRlRWwoXCJoMVwiLCB7IHRleHQ6IFwiU2xpZGVzaG93XCIgfSk7XG5cblx0dGhpcy5mbGF0dGVuTGlua3ModGhpcy5saW5rcyk7XG5cblx0Y29uc3Qgc2V0dGluZ3NFbCA9IGNvbnRlbnRFbC5jcmVhdGVFbCgnZGl2Jyk7XG5cblx0Y29uc3QgZGVwdGhTdHIgPSAoZGVwdGg6IG51bWJlcikgPT4gYFNsaWRlcyBkZXB0aDogJHtkZXB0aH1gO1xuXG5cdHRoaXMuZGVwdGggPSB0aGlzLm1heERlcHRoO1xuXG5cdGNvbnRlbnRFbC5jcmVhdGVFbCgnZGl2JywgeyB0ZXh0OiAnSW5jbHVkZTogJ30pXG5cblx0Y29uc3QgdGl0bGVTbGlkZUVsID0gY29udGVudEVsLmNyZWF0ZUVsKCdkaXYnKTtcblx0bmV3IENoZWNrYm94KHRpdGxlU2xpZGVFbCwgdGhpcy50aXRsZVNsaWRlLCB0cnVlLCAoKSA9PiB7XG5cdFx0dGhpcy50aXRsZVNsaWRlID0gIXRoaXMudGl0bGVTbGlkZTtcblx0XHR0aGlzLnJlbmRlcigpO1xuXHR9KVxuXHR0aXRsZVNsaWRlRWwuY3JlYXRlRWwoJ3NwYW4nLCB7IHRleHQ6ICd0aXRsZSBzbGlkZSd9KVxuXG5cdGNvbnN0IGxhc3RTbGlkZUVsID0gY29udGVudEVsLmNyZWF0ZUVsKCdkaXYnKTtcblx0bmV3IENoZWNrYm94KGxhc3RTbGlkZUVsLCB0aGlzLmxhc3RTbGlkZSwgdHJ1ZSwgKCkgPT4ge1xuXHRcdHRoaXMubGFzdFNsaWRlID0gIXRoaXMubGFzdFNsaWRlO1xuXHRcdHRoaXMucmVuZGVyKCk7XG5cdH0pXG5cdGxhc3RTbGlkZUVsLmNyZWF0ZUVsKCdzcGFuJywgeyB0ZXh0OiAnbGFzdCBzbGlkZSd9KVxuXHRcblx0dGhpcy5saW5rc0VsID0gY29udGVudEVsLmNyZWF0ZUVsKCdkaXYnKTtcblxuICAgIG5ldyBTZXR0aW5nKHNldHRpbmdzRWwpXG5cdFx0LnNldE5hbWUoZGVwdGhTdHIodGhpcy5tYXhEZXB0aCkpXG5cdFx0LnNldERlc2MoJ1NldCBkZXB0aCBvZiBwcmV2aWV3IGNvbnRlbnQgdG8gY3JlYXRlIHNsaWRlcyBmcm9tLicpXG5cdFx0LmFkZFNsaWRlcihzbGlkZXIgPT4gc2xpZGVyXG5cdFx0XHQuc2V0VmFsdWUodGhpcy5tYXhEZXB0aClcblx0XHRcdC5zZXRMaW1pdHMoMSwgdGhpcy5tYXhEZXB0aCwgMSlcblx0XHRcdC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcblx0XHRcdFx0Y29uc3QgZGVwdGhFbCA9IHNldHRpbmdzRWwuY2hpbGRyZW5bMF0uY2hpbGRyZW5bMF0uY2hpbGRyZW5bMF07XG5cdFx0XHRcdGRlcHRoRWwuZW1wdHkoKVxuXHRcdFx0XHRkZXB0aEVsLmNyZWF0ZUVsKCdkaXYnLCB7IHRleHQ6IGRlcHRoU3RyKHZhbHVlKX0pO1xuXHRcdFx0XHR0aGlzLmRlcHRoID0gdmFsdWU7XG5cdFx0XHRcdHNsaWRlci5zaG93VG9vbHRpcCgpO1xuXG5cdFx0XHRcdHRoaXMucmVuZGVyKCk7XG5cdFx0XHR9KSk7XG5cdFxuXHR0aGlzLnJlbmRlcigpO1xuXG5cdG5ldyBCdXR0b25Db21wb25lbnQoY29udGVudEVsKS5zZXRCdXR0b25UZXh0KCdHZW5lcmF0ZScpLm9uQ2xpY2soKCkgPT4ge1xuXHRcdHRoaXMub25TdWJtaXQodGhpcy5zbGlkZXMsIHRoaXMudGl0bGVTbGlkZSwgdGhpcy5sYXN0U2xpZGUpO1xuXHRcdHRoaXMuY2xvc2UoKTtcblx0fSlcbiAgfVxuXG4gIGZsYXR0ZW5MaW5rcyhsaW5rczogTGlua1RyZWVUeXBlW10pIHtcblx0bGlua3MuZm9yRWFjaCgobGluazogTGlua1RyZWVUeXBlKSA9PiB7XG5cdFx0aWYgKHRoaXMuaWdub3JlZExpbmtzLmluY2x1ZGVzKGxpbmsubmFtZSkpXG5cdFx0XHRyZXR1cm5cblxuXHRcdGlmIChsaW5rLmxldmVsICYmIHRoaXMubWF4RGVwdGggPD0gbGluay5sZXZlbCkgXG5cdFx0XHR0aGlzLm1heERlcHRoID0gbGluay5sZXZlbDtcblxuXHRcdHRoaXMuZmxhdHRlbmVkTGlua3MucHVzaChsaW5rKTtcblx0XHRpZiAoJ2NoaWxkcmVuJyBpbiBsaW5rICYmIGxpbmsubGV2ZWwpIHtcblx0XHRcdHRoaXMuZmxhdHRlbkxpbmtzKGxpbmsuY2hpbGRyZW4pO1xuXHRcdH1cblx0fSlcbiAgfVxuXG4gIHJlbmRlcigpIHtcblx0dGhpcy5saW5rc0VsLmVtcHR5KCk7XG5cdGNvbnN0IGRlcHRoTGlua3MgPSB0aGlzLmZsYXR0ZW5lZExpbmtzLmZpbHRlcigobGluazogTGlua1RyZWVUeXBlKSA9PiBsaW5rLmxldmVsICYmIGxpbmsubGV2ZWwgPD0gdGhpcy5kZXB0aCk7XG5cblx0dGhpcy5zbGlkZXMgPSBkZXB0aExpbmtzLm1hcCgobGluazogTGlua1RyZWVUeXBlKSA9PiAoeyBsaW5rOiBsaW5rLCB0eXBlOiAnYmFzaWMnIH0pKVxuXHRcblx0aWYgKHRoaXMudGl0bGVTbGlkZSkge1xuXHRcdGNvbnN0IHNsaWRlID0gdGhpcy5saW5rc0VsLmNyZWF0ZUVsKFwiZGl2XCIsIHsgY2xzOiAnc2xpZGUtcm93J30pO1xuXHRcdHNsaWRlLmNyZWF0ZUVsKCdzcGFuJywgeyB0ZXh0OiAnMS4gVGl0bGUgc2xpZGUnIH0pO1xuXHRcdGNvbnN0IGRyb3Bkb3duRWwgPSBzbGlkZS5jcmVhdGVFbCgnc3BhbicsIHsgY2xzOiAncm93LXJpZ2h0J30pXG5cdFx0bmV3IERyb3Bkb3duQ29tcG9uZW50KGRyb3Bkb3duRWwpXG5cdFx0XHQuc2V0RGlzYWJsZWQodHJ1ZSlcblx0XHRcdC5hZGRPcHRpb24oXCJ0aXRsZVwiLCBcInRpdGxlXCIpXG5cdH1cblx0XG5cdGRlcHRoTGlua3MuZm9yRWFjaCgobGluazogTGlua1RyZWVUeXBlKSA9PiB7XG5cdFx0Y29uc3Qgc2xpZGUgPSB0aGlzLmxpbmtzRWwuY3JlYXRlRWwoXCJkaXZcIiwgeyBjbHM6ICdzbGlkZS1yb3cnfSk7XG5cdFx0c2xpZGUuY3JlYXRlRWwoJ3NwYW4nLCB7IHRleHQ6IGAke2xpbmsubGV2ZWx9OiAke2xpbmsubmFtZX1gIH0pO1xuXG5cdFx0Y29uc3QgZHJvcGRvd25FbCA9IHNsaWRlLmNyZWF0ZUVsKCdzcGFuJywgeyBjbHM6ICdyb3ctcmlnaHQnfSk7XG5cdFx0bmV3IERyb3Bkb3duQ29tcG9uZW50KGRyb3Bkb3duRWwpXG5cdFx0XHQuYWRkT3B0aW9uKFwiYmFzaWNcIiwgXCJiYXNpY1wiKVxuXHRcdFx0LmFkZE9wdGlvbihcInNwbGl0XCIsIFwic3BsaXRcIilcblx0XHRcdC5hZGRPcHRpb24oJ2ltYWdlJywgJ2ltYWdlJylcblx0XHRcdC5vbkNoYW5nZSgodmFsdWU6IHN0cmluZykgPT4ge1xuXG5cdFx0XHRcdC8vIHVwZGF0ZSBzbGlkZXMgd2l0aCBuZXcgdHlwZSBvZiBzbGlkZSB2YWx1ZVxuXHRcdFx0XHRjb25zdCBpbmRleCA9IHRoaXMuc2xpZGVzLmZpbmRJbmRleCgoeyBsaW5rOiBzbGlkZUxpbmsgfTogeyBsaW5rOiBMaW5rVHJlZVR5cGV9KSA9PiBzbGlkZUxpbmsubmFtZSA9PT0gbGluay5uYW1lKTtcblx0XHRcdFx0dGhpcy5zbGlkZXNbaW5kZXhdWyd0eXBlJ10gPSB2YWx1ZTtcblx0XHRcdH0pO1xuXHR9KVxuXG5cdGlmICh0aGlzLmxhc3RTbGlkZSkge1xuXHRcdGNvbnN0IHNsaWRlID0gdGhpcy5saW5rc0VsLmNyZWF0ZUVsKFwiZGl2XCIsIHsgY2xzOiAnc2xpZGUtcm93J30pO1xuXHRcdHNsaWRlLmNyZWF0ZUVsKCdzcGFuJywgeyB0ZXh0OiAnMS4gTGFzdCBzbGlkZScgfSk7XG5cdFx0Y29uc3QgZHJvcGRvd25FbCA9IHNsaWRlLmNyZWF0ZUVsKCdzcGFuJywgeyBjbHM6ICdyb3ctcmlnaHQnfSlcblx0XHRuZXcgRHJvcGRvd25Db21wb25lbnQoZHJvcGRvd25FbClcblx0XHRcdC5zZXREaXNhYmxlZCh0cnVlKVxuXHRcdFx0LmFkZE9wdGlvbihcImxhc3RcIiwgXCJsYXN0XCIpXG5cdH1cbiAgfVxuXG4gIG9uQ2xvc2UoKSB7XG4gICAgbGV0IHsgY29udGVudEVsIH0gPSB0aGlzO1xuICAgIGNvbnRlbnRFbC5lbXB0eSgpO1xuICB9XG59XG4iXSwKICAibWFwcGluZ3MiOiAiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEsdUJBQXVEOzs7QUNBdkQsdUJBQTJFOzs7QUNBM0Usc0JBQTJCO0FBRXBCLElBQU0saUJBQWlCLENBQUMsU0FBaUI7QUFDL0MsU0FBTyxLQUFLLFFBQVEsNkRBQTZELEdBQUcsRUFBRSxLQUFLO0FBQzVGO0FBRU8sSUFBTSxnQkFBZ0IsT0FBTyxNQUFVLFNBQWlCO0FBQzlELFFBQU0sT0FBTyxLQUFJLE1BQU0sc0JBQXNCLElBQUk7QUFFakQsTUFBSSxDQUFFLGlCQUFnQjtBQUNyQixXQUFPO0FBRVIsU0FBTyxNQUFNLEtBQUksTUFBTSxXQUFXLElBQUk7QUFDdkM7OztBQ1hPLElBQU0saUJBQU4sTUFBcUI7QUFBQSxFQUszQixZQUFZLFFBQXFCLE9BQWUsZUFBd0IsY0FBdUI7QUFIL0Ysa0JBQXNCLENBQUM7QUFDdkIscUJBQW9CO0FBR25CLFNBQUssU0FBUztBQUVkLFNBQUssYUFBYSxLQUFL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
