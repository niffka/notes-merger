/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// main.ts
var main_exports = {};
__export(main_exports, {
  default: () => GenerateMarkdownPlugin
});
module.exports = __toCommonJS(main_exports);
var import_obsidian3 = require("obsidian");

// src/views/generate-markdown.ts
var import_obsidian2 = require("obsidian");

// src/utils.ts
var import_fs = require("fs");
var fixSpaceInName = (name) => {
  return name.replace(/[\u00A0\u1680\u180E\u2000-\u200B\u202F\u205F\u3000\uFEFF]/, " ").trim();
};
var getNoteByName = (name, loadedFiles) => {
  const loadedFile = loadedFiles.find((file) => file.basename === name);
  const fullPath = app.vault.adapter.getFullPath(name);
  if (!loadedFile)
    return "";
  const absolutePath = fullPath.replace(name, loadedFile.path.replace("/", "\\"));
  const note = (0, import_fs.readFileSync)(absolutePath, { encoding: "utf8" });
  return note;
};

// src/components/Button.ts
var Button = class {
  constructor(element, text, onClick, args) {
    this.btn = element.createEl("button", { text, ...args });
    this.btn.onclick = () => {
      onClick(this);
    };
    return this;
  }
};

// src/components/Link.ts
var BaseLink = class {
  constructor(context, element, name) {
    this.context = context;
    this.element = element;
    this.name = name;
    this.render();
  }
  render() {
    const hrefTitle = this.element.createEl("a", { text: this.name, cls: "cont__title" });
    hrefTitle.onclick = () => {
      this.context.workspace.openLinkText(this.name, "");
    };
  }
};
var Link = class {
  constructor(context, element, link, renderNow = true) {
    this.toggledState = false;
    this.link = link;
    this.context = context;
    this.element = element;
    if (renderNow)
      this.render(false);
    return this;
  }
  render(state) {
    this.a = this.element.createEl("a", { text: this.link.name, cls: "link" });
    !this.link.exists && this.a.addClass("cont__link-not-exist");
    this.link.inline && this.a.addClass("inline");
    this.a.onclick = () => {
      this.context.workspace.openLinkText(this.link.name, "");
      !this.link.exists && this.a.removeClass("cont__link-not-exist");
    };
    this.toggle(state);
  }
  toggle(state) {
    if (state)
      this.a.removeClass("strikethrough");
    else
      this.a.addClass("strikethrough");
  }
};

// src/components/SaveModal.ts
var import_obsidian = require("obsidian");
var SaveModal = class extends import_obsidian.Modal {
  constructor(app2, onSubmit) {
    super(app2);
    this.onSubmit = onSubmit;
  }
  onOpen() {
    const { contentEl } = this;
    contentEl.createEl("h1", { text: "Save as" });
    new import_obsidian.Setting(contentEl).setName("File name: ").addText((text) => text.onChange((value) => {
      this.result = value;
    }));
    new import_obsidian.Setting(contentEl).addButton((btn) => btn.setButtonText("Generate markdown note").setCta().onClick(() => {
      this.close();
      this.onSubmit(this.result);
    }));
  }
  onClose() {
    let { contentEl } = this;
    contentEl.empty();
  }
};

// src/components/TreeMenu.ts
function flattenChildren(link, children) {
  if ("children" in link) {
    const childrenLinkNames = link.children.map((l) => l.name);
    children.push(...childrenLinkNames);
    link.children.forEach((l) => {
      flattenChildren(l, children);
    });
  }
  return children;
}
var TreeMenu = class {
  constructor(app2, structure, linksTree, event) {
    this.ignoredLinks = [];
    this.linksTree = [];
    this.app = app2;
    let menu = structure.createEl("div", { cls: "tree-menu" });
    this.UL = menu.createEl("ul");
    this.linksTree = linksTree;
    this.render(this.linksTree, this.UL, [], event);
  }
  render(links, menuEl, childrenLinks, event) {
    if (!childrenLinks)
      childrenLinks = [];
    links.forEach((link) => {
      const li = menuEl.createEl("li");
      const linkEl = new Link(this.app, li, link, false);
      let state = !childrenLinks.includes(linkEl.link.name);
      if (!link.exists)
        state = false;
      new Checkbox(li, state, link.exists, () => {
        const children = [linkEl.link.name, ...flattenChildren(linkEl.link, [])];
        console.log("flatten", children);
        if (state == false) {
          childrenLinks = childrenLinks.filter((cl) => !children.includes(cl));
        } else {
          childrenLinks.push(...children);
          childrenLinks = [...new Set(childrenLinks)];
        }
        this.ignoredLinks = childrenLinks;
        this.UL.empty();
        this.render(this.linksTree, this.UL, childrenLinks, event);
      });
      linkEl.render(state);
      if ("children" in link) {
        const ul = li.createEl("ul");
        this.render(link.children, ul, childrenLinks, event);
      }
    });
    return event(this.ignoredLinks);
  }
};

// src/components/Checkbox.ts
var Checkbox = class {
  constructor(element, state, exists, onClick) {
    this.cb = element.createEl("input", {
      type: "checkbox",
      cls: "checkbox-btn"
    });
    this.cb.checked = state;
    if (!exists) {
      this.cb.disabled = true;
      this.cb.checked = false;
      this.cb.addClass("checkbox-btn-disabled");
    }
    this.cb.onclick = () => {
      onClick(this);
    };
    return this;
  }
};

// src/views/generate-markdown.ts
var VIEW_CONTENT_COMPOSE_NOTES = "view-generate-markdown";
var _GenerateMarkdown = class extends import_obsidian2.ItemView {
  constructor(leaf, settings) {
    super(leaf);
    this.linksTree = [];
    this.loadedFiles = [];
    this.maxLevel = 0;
    this.processed = [];
    this.mainNameLinks = [];
    this.markdown = "";
    this.ignoredLinks = [];
    this.images = [];
    this.settings = settings;
  }
  async onOpen() {
    const container = this.containerEl.children[1];
    this.container = container;
    container.empty();
    this.toolbar = container.createEl("div");
    this.generatePreviewParent = this.toolbar.createEl("span");
    this.generateMarkdownParent = this.toolbar.createEl("span");
    this.structure = this.container.createEl("div");
    new Button(this.generatePreviewParent, "Generate preview", () => {
      this.linksTree = [];
      this.maxLevel = 0;
      this.processed = [];
      this.mainNameLinks = [];
      this.ignoredLinks = [];
      this.markdown = "";
      this.structure.empty();
      this.generateMarkdownParent.empty();
      this.readSelectedNote();
    });
  }
  parseLinks(text, index = false) {
    const links = text.matchAll(/\[\[(.*?)\]\]/g);
    let cleanLinks = [...links].map((l) => l[1]);
    cleanLinks = [...new Set(cleanLinks)];
    cleanLinks = cleanLinks.filter((cl) => !cl.startsWith("#"));
    const existingNotes = cleanLinks.map((cl) => {
      cl = fixSpaceInName(cl);
      if (!!_GenerateMarkdown.imageTypes.filter((it) => cl.includes(it.toLowerCase())).length) {
        this.images.push(cl);
        return false;
      }
      let isInline = true;
      if (text.includes(this.settings.listOfLinksKeyword)) {
        let [inlineText, linksText] = text.split(this.settings.listOfLinksKeyword);
        if (!inlineText.includes(cl))
          isInline = false;
      }
      let isIndex = false;
      if (index) {
        isInline = false;
        isIndex = true;
      }
      const note = this.loadedFiles.find((f) => f["basename"] === cl);
      return {
        name: cl,
        exists: !!note,
        inline: isInline,
        index: isIndex
      };
    }).filter(Boolean);
    return existingNotes;
  }
  readSelectedNote() {
    this.loadedFiles = app.vault.getAllLoadedFiles();
    const activeNote = this.app.workspace.getActiveFile();
    if (!activeNote) {
      new import_obsidian2.Notice(`Selected note is invalid.`);
      throw new Error("Selected note is invalid.");
    }
    const activeNoteText = getNoteByName(activeNote.basename, this.loadedFiles);
    const mainContentLinks = this.parseLinks(activeNoteText, true);
    this.mainNameLinks = mainContentLinks.map((l) => l.name);
    const title = activeNote.basename;
    this.linksTree = this.generateNotesHierarchy(mainContentLinks, title);
    new BaseLink(this.app, this.structure, title);
    new TreeMenu(this.app, this.structure, this.linksTree, (ignoredLinks) => {
      this.ignoredLinks = ignoredLinks;
    });
    new Button(this.generateMarkdownParent, "Generate markdown", () => {
      this.markdown = "";
      this.generateMarkdownFile(this.linksTree, activeNoteText);
    }, { cls: "generate-markdown-btn" });
  }
  generateMarkdownFile(links, mainNote) {
    this.composeMarkdown(links);
    this.mainNameLinks.forEach((mnl) => {
      mainNote = mainNote.replaceAll(`[[${mnl}]]`, `[[#${mnl}]]`);
    });
    this.markdown = mainNote + this.markdown;
    new SaveModal(this.app, (fileName) => {
      this.app.vault.adapter.write(`${fileName}.md`, this.markdown).then(() => {
        new import_obsidian2.Notice(`Note ${fileName} created successfully`);
        this.app.workspace.openLinkText(`${fileName}.md`, "");
      });
    }).open();
  }
  composeMarkdown(links) {
    links.forEach((link) => {
      let note = getNoteByName(link.name, this.loadedFiles);
      const localLinks = this.parseLinks(note);
      if (this.ignoredLinks.includes(link.name))
        return;
      note = note.trim();
      if (note.length == 0)
        return;
      localLinks.forEach((localLink) => {
        if (localLink.inline && this.ignoredLinks.includes(localLink.name))
          note = note.replaceAll(`[[${localLink.name}]]`, localLink.name);
        else
          note = note.replaceAll(`[[${localLink.name}]]`, `[[#${localLink.name}]]`);
      });
      let noteRows = note.split("\n");
      let firstRow = fixSpaceInName(noteRows[0]);
      if (firstRow.includes(`# ${link.name}`)) {
        noteRows.shift();
        note = noteRows.join("\n").trim();
      }
      noteRows = note.split("\n");
      note = noteRows.map((noteRow) => {
        const match = noteRow.match(/# (\w+)/);
        if (match)
          return `**${match[1]}**`;
        return noteRow;
      }).join("\n");
      if (note.includes(this.settings.listOfLinksKeyword)) {
        let [importantPart, endPart] = note.split(this.settings.listOfLinksKeyword);
        note = importantPart.trim();
      }
      let title = "";
      if (link.inline) {
        title = `##### ${link.name}`;
      } else {
        const nestedLevel = Array(link.level).fill("#").join("");
        title = `${nestedLevel} ${link.name}`;
      }
      note = `

${title}
${note}`;
      this.markdown += note;
      if ("children" in link)
        this.composeMarkdown(link.children);
    });
  }
  dfs(links, level, parentRef, titleMapping) {
    titleMapping = titleMapping != null ? titleMapping : {};
    links.forEach((link, order) => {
      if (this.mainNameLinks.includes(link.name) && level != 0)
        return;
      if (this.processed.includes(link.name))
        return;
      this.processed.push(link.name);
      const note = getNoteByName(link.name, this.loadedFiles);
      const subLinks = this.parseLinks(note);
      this.maxLevel = level + 1;
      titleMapping[link.name] = { ...link, parentRef, level: this.maxLevel, order };
      if (subLinks.length > 0) {
        this.dfs(subLinks, this.maxLevel, titleMapping[link.name], titleMapping);
      }
    });
    return titleMapping;
  }
  generateNotesHierarchy(links, title) {
    const linksObj = this.dfs(links, 0);
    console.log("linkobj", linksObj);
    let linksArr = [];
    Object.keys(linksObj).forEach((key) => {
      var _a, _b;
      const { parentRef, ...rest } = linksObj[key];
      linksArr.push({ ...rest, parent: (_b = (_a = linksObj[key]) == null ? void 0 : _a.parentRef) == null ? void 0 : _b.name });
    });
    console.log("LA", linksArr);
    let maxDepth = Number(this.settings.slidesDepth);
    function getChildren(parent) {
      console.log("depth", startDepth);
      let children = linksArr.filter((child) => child.parent === parent.name);
      console.log("children", children);
      if (startDepth <= maxDepth) {
        children.forEach((child) => {
          slidesList += "\n" + "#".repeat(startDepth + 1) + child.name;
          if (startDepth != maxDepth) {
            startDepth += 1;
            getChildren(child);
          } else {
            console.log("\u010Daau");
            return;
          }
          startDepth -= 1;
        });
      }
    }
    let slidesList = "";
    let slides = linksArr.filter((link) => link.level === 1);
    console.log("SLIDES", slides);
    let startDepth;
    slides.forEach((slide) => {
      startDepth = 2;
      slidesList += "\n ##" + slide.name;
      getChildren(slide);
    });
    console.log("slideList", slidesList);
    const createChildrenFromParent = (arr, parent) => {
      let childrenArr = [];
      for (let i = 0; i < arr.length; i++) {
        if (arr[i].parent == parent) {
          const children = createChildrenFromParent(arr, arr[i].name);
          if (children.length) {
            arr[i].children = children;
          }
          childrenArr.push(arr[i]);
        }
      }
      return childrenArr;
    };
    return createChildrenFromParent(linksArr, void 0);
  }
  async onClose() {
  }
  getViewType() {
    return VIEW_CONTENT_COMPOSE_NOTES;
  }
  getDisplayText() {
    return "Notes Merger";
  }
};
var GenerateMarkdown = _GenerateMarkdown;
GenerateMarkdown.imageTypes = ["jpg", "jpeg", "png", "gif", "webp", "tiff", "bmp"].map((it) => `.${it}`);

// main.ts
var DEFAULT_SETTINGS = {
  listOfLinksKeyword: "Kam d\xE1l",
  literatureNote: "Literature",
  slidesDepth: "2"
};
var GenerateMarkdownPlugin = class extends import_obsidian3.Plugin {
  async onload() {
    await this.loadSettings();
    this.addSettingTab(new GenerateMarkdownPluginSettingTab(this.app, this));
    this.registerView(VIEW_CONTENT_COMPOSE_NOTES, (leaf) => new GenerateMarkdown(leaf, this.settings));
    this.addRibbonIcon("scroll", "NotesMerger", () => {
      this.activateGenerateMarkdownView();
    });
  }
  async activateGenerateMarkdownView() {
    this.app.workspace.detachLeavesOfType(VIEW_CONTENT_COMPOSE_NOTES);
    await this.app.workspace.getRightLeaf(false).setViewState({
      type: VIEW_CONTENT_COMPOSE_NOTES,
      active: true
    });
    this.app.workspace.revealLeaf(this.app.workspace.getLeavesOfType(VIEW_CONTENT_COMPOSE_NOTES)[0]);
  }
  onunload() {
    this.app.workspace.detachLeavesOfType(VIEW_CONTENT_COMPOSE_NOTES);
  }
  async loadSettings() {
    this.settings = Object.assign({}, DEFAULT_SETTINGS, await this.loadData());
  }
  async saveSettings() {
    await this.saveData(this.settings);
  }
};
var GenerateMarkdownPluginSettingTab = class extends import_obsidian3.PluginSettingTab {
  constructor(app2, plugin) {
    super(app2, plugin);
    this.plugin = plugin;
  }
  display() {
    const { containerEl } = this;
    containerEl.empty();
    containerEl.createEl("h2", { text: "Settings" });
    new import_obsidian3.Setting(containerEl).setName("List of links keyword").setDesc("Keyword to detect list of links at the end of note").addText((text) => text.setPlaceholder('Defaults to "Kam d\xE1l"').setValue(this.plugin.settings.listOfLinksKeyword).onChange(async (value) => {
      this.plugin.settings.listOfLinksKeyword = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian3.Setting(containerEl).setName("Depth of slides").setDesc("How many layer are gonna be created into slides.").addText((text) => text.setPlaceholder("Default is 2 layers.").setValue(this.plugin.settings.slidesDepth).onChange(async (value) => {
      this.plugin.settings.slidesDepth = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian3.Setting(containerEl).setName("Literature note").setDesc("Name of note with citations").addText((text) => text.setPlaceholder('Defaults to "Literature"').setValue(this.plugin.settings.literatureNote).onChange(async (value) => {
      this.plugin.settings.literatureNote = value;
      await this.plugin.saveSettings();
    }));
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsibWFpbi50cyIsICJzcmMvdmlld3MvZ2VuZXJhdGUtbWFya2Rvd24udHMiLCAic3JjL3V0aWxzLnRzIiwgInNyYy9jb21wb25lbnRzL0J1dHRvbi50cyIsICJzcmMvY29tcG9uZW50cy9MaW5rLnRzIiwgInNyYy9jb21wb25lbnRzL1NhdmVNb2RhbC50cyIsICJzcmMvY29tcG9uZW50cy9UcmVlTWVudS50cyIsICJzcmMvY29tcG9uZW50cy9DaGVja2JveC50cyJdLAogICJzb3VyY2VzQ29udGVudCI6IFsiaW1wb3J0IHsgQXBwLCBQbHVnaW4sIFBsdWdpblNldHRpbmdUYWIsIFNldHRpbmcgfSBmcm9tICdvYnNpZGlhbic7XHJcbmltcG9ydCB7IEdlbmVyYXRlTWFya2Rvd24sIFZJRVdfQ09OVEVOVF9DT01QT1NFX05PVEVTIH0gZnJvbSAnLi9zcmMvdmlld3MvZ2VuZXJhdGUtbWFya2Rvd24nO1xyXG5cclxuZXhwb3J0IGludGVyZmFjZSBHZW5lcmF0ZU1hcmtkb3duUGx1Z2luU2V0dGluZ3NUeXBlIHtcclxuXHRsaXN0T2ZMaW5rc0tleXdvcmQ6IHN0cmluZztcclxuXHRsaXRlcmF0dXJlTm90ZTogc3RyaW5nO1xyXG5cdHNsaWRlc0RlcHRoOiBzdHJpbmc7XHJcbn1cclxuXHJcbmNvbnN0IERFRkFVTFRfU0VUVElOR1M6IEdlbmVyYXRlTWFya2Rvd25QbHVnaW5TZXR0aW5nc1R5cGUgPSB7XHJcblx0bGlzdE9mTGlua3NLZXl3b3JkOiAnS2FtIGRcdTAwRTFsJyxcclxuXHRsaXRlcmF0dXJlTm90ZTogJ0xpdGVyYXR1cmUnLFxyXG5cdHNsaWRlc0RlcHRoOiAnMicsXHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEdlbmVyYXRlTWFya2Rvd25QbHVnaW4gZXh0ZW5kcyBQbHVnaW4ge1xyXG5cdHNldHRpbmdzOiBHZW5lcmF0ZU1hcmtkb3duUGx1Z2luU2V0dGluZ3NUeXBlO1xyXG5cclxuXHRhc3luYyBvbmxvYWQoKSB7XHJcblx0XHRhd2FpdCB0aGlzLmxvYWRTZXR0aW5ncygpO1xyXG5cclxuXHRcdHRoaXMuYWRkU2V0dGluZ1RhYihuZXcgR2VuZXJhdGVNYXJrZG93blBsdWdpblNldHRpbmdUYWIodGhpcy5hcHAsIHRoaXMpKTtcdFxyXG5cclxuXHRcdHRoaXMucmVnaXN0ZXJWaWV3KFxyXG5cdFx0XHRWSUVXX0NPTlRFTlRfQ09NUE9TRV9OT1RFUyxcclxuXHRcdFx0KGxlYWYpID0+IG5ldyBHZW5lcmF0ZU1hcmtkb3duKGxlYWYsIHRoaXMuc2V0dGluZ3MpXHJcblx0XHQpO1xyXG5cdFx0XHJcblx0XHR0aGlzLmFkZFJpYmJvbkljb24oXCJzY3JvbGxcIiwgXCJOb3Rlc01lcmdlclwiLCAoKSA9PiB7XHJcblx0XHRcdHRoaXMuYWN0aXZhdGVHZW5lcmF0ZU1hcmtkb3duVmlldygpO1xyXG5cdFx0fSk7XHJcblx0fVxyXG5cclxuXHRhc3luYyBhY3RpdmF0ZUdlbmVyYXRlTWFya2Rvd25WaWV3KCkge1xyXG5cdFx0dGhpcy5hcHAud29ya3NwYWNlLmRldGFjaExlYXZlc09mVHlwZShWSUVXX0NPTlRFTlRfQ09NUE9TRV9OT1RFUyk7XHJcblx0XHJcblx0XHRhd2FpdCB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0UmlnaHRMZWFmKGZhbHNlKS5zZXRWaWV3U3RhdGUoe1xyXG5cdFx0ICB0eXBlOiBWSUVXX0NPTlRFTlRfQ09NUE9TRV9OT1RFUyxcclxuXHRcdCAgYWN0aXZlOiB0cnVlLFxyXG5cdFx0fSk7XHJcblx0XHJcblx0XHR0aGlzLmFwcC53b3Jrc3BhY2UucmV2ZWFsTGVhZihcclxuXHRcdCAgdGhpcy5hcHAud29ya3NwYWNlLmdldExlYXZlc09mVHlwZShWSUVXX0NPTlRFTlRfQ09NUE9TRV9OT1RFUylbMF1cclxuXHRcdCk7XHJcblx0fVxyXG5cclxuXHRvbnVubG9hZCgpIHtcclxuXHRcdHRoaXMuYXBwLndvcmtzcGFjZS5kZXRhY2hMZWF2ZXNPZlR5cGUoVklFV19DT05URU5UX0NPTVBPU0VfTk9URVMpO1xyXG5cdH1cclxuXHJcblx0YXN5bmMgbG9hZFNldHRpbmdzKCkge1xyXG5cdFx0dGhpcy5zZXR0aW5ncyA9IE9iamVjdC5hc3NpZ24oe30sIERFRkFVTFRfU0VUVElOR1MsIGF3YWl0IHRoaXMubG9hZERhdGEoKSk7XHJcblx0fVxyXG5cclxuXHRhc3luYyBzYXZlU2V0dGluZ3MoKSB7XHJcblx0XHRhd2FpdCB0aGlzLnNhdmVEYXRhKHRoaXMuc2V0dGluZ3MpO1xyXG5cdH1cclxufVxyXG5cclxuY2xhc3MgR2VuZXJhdGVNYXJrZG93blBsdWdpblNldHRpbmdUYWIgZXh0ZW5kcyBQbHVnaW5TZXR0aW5nVGFiIHtcclxuXHRwbHVnaW46IEdlbmVyYXRlTWFya2Rvd25QbHVnaW47XHJcblxyXG5cdGNvbnN0cnVjdG9yKGFwcDogQXBwLCBwbHVnaW46IEdlbmVyYXRlTWFya2Rvd25QbHVnaW4pIHtcclxuXHRcdHN1cGVyKGFwcCwgcGx1Z2luKTtcclxuXHRcdHRoaXMucGx1Z2luID0gcGx1Z2luO1xyXG5cdH1cclxuXHJcblx0ZGlzcGxheSgpOiB2b2lkIHtcclxuXHJcblx0XHRjb25zdCB7IGNvbnRhaW5lckVsIH0gPSB0aGlzO1xyXG5cclxuXHRcdGNvbnRhaW5lckVsLmVtcHR5KCk7XHJcblxyXG5cdFx0Y29udGFpbmVyRWwuY3JlYXRlRWwoJ2gyJywge3RleHQ6ICdTZXR0aW5ncyd9KTtcclxuXHRcdFxyXG5cdFx0bmV3IFNldHRpbmcoY29udGFpbmVyRWwpXHJcblx0XHRcdC5zZXROYW1lKCdMaXN0IG9mIGxpbmtzIGtleXdvcmQnKVxyXG5cdFx0XHQuc2V0RGVzYygnS2V5d29yZCB0byBkZXRlY3QgbGlzdCBvZiBsaW5rcyBhdCB0aGUgZW5kIG9mIG5vdGUnKVxyXG5cdFx0XHQuYWRkVGV4dCh0ZXh0ID0+IHRleHRcclxuXHRcdFx0XHQuc2V0UGxhY2Vob2xkZXIoJ0RlZmF1bHRzIHRvIFwiS2FtIGRcdTAwRTFsXCInKVxyXG5cdFx0XHRcdC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5saXN0T2ZMaW5rc0tleXdvcmQpXHJcblx0XHRcdFx0Lm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xyXG5cdFx0XHRcdFx0dGhpcy5wbHVnaW4uc2V0dGluZ3MubGlzdE9mTGlua3NLZXl3b3JkID0gdmFsdWU7XHJcblx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuXHRcdFx0XHR9KSk7XHJcblx0XHRcclxuXHRcdG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxyXG5cdFx0LnNldE5hbWUoJ0RlcHRoIG9mIHNsaWRlcycpXHJcblx0XHQuc2V0RGVzYygnSG93IG1hbnkgbGF5ZXIgYXJlIGdvbm5hIGJlIGNyZWF0ZWQgaW50byBzbGlkZXMuJylcclxuXHRcdC5hZGRUZXh0KHRleHQgPT4gdGV4dFxyXG5cdFx0XHQuc2V0UGxhY2Vob2xkZXIoJ0RlZmF1bHQgaXMgMiBsYXllcnMuJylcclxuXHRcdFx0LnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLnNsaWRlc0RlcHRoKVxyXG5cdFx0XHQub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XHJcblx0XHRcdFx0dGhpcy5wbHVnaW4uc2V0dGluZ3Muc2xpZGVzRGVwdGggPSB2YWx1ZTtcclxuXHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuXHRcdFx0fSkpO1xyXG5cclxuXHRcdG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxyXG5cdFx0LnNldE5hbWUoJ0xpdGVyYXR1cmUgbm90ZScpXHJcblx0XHQuc2V0RGVzYygnTmFtZSBvZiBub3RlIHdpdGggY2l0YXRpb25zJylcclxuXHRcdC5hZGRUZXh0KHRleHQgPT4gdGV4dFxyXG5cdFx0XHQuc2V0UGxhY2Vob2xkZXIoJ0RlZmF1bHRzIHRvIFwiTGl0ZXJhdHVyZVwiJylcclxuXHRcdFx0LnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmxpdGVyYXR1cmVOb3RlKVxyXG5cdFx0XHQub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XHJcblx0XHRcdFx0dGhpcy5wbHVnaW4uc2V0dGluZ3MubGl0ZXJhdHVyZU5vdGUgPSB2YWx1ZTtcclxuXHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuXHRcdFx0fSkpO1xyXG5cdH1cclxufVxyXG4iLCAiaW1wb3J0IHsgSXRlbVZpZXcsIFdvcmtzcGFjZUxlYWYsIE5vdGljZSwgVEFic3RyYWN0RmlsZSwgVEZpbGUsIEFwcCwgU2V0dGluZyB9IGZyb20gXCJvYnNpZGlhblwiO1xyXG5pbXBvcnQgeyBmaXhTcGFjZUluTmFtZSwgZ2V0Tm90ZUJ5TmFtZSB9IGZyb20gJy4uL3V0aWxzJztcclxuXHJcbmltcG9ydCB7IEdlbmVyYXRlTWFya2Rvd25QbHVnaW5TZXR0aW5nc1R5cGUgfSBmcm9tICcuLi8uLi9tYWluJztcclxuXHJcbmltcG9ydCB7XHJcblx0QnV0dG9uLCBcclxuXHRCYXNlTGluayxcclxuXHRTYXZlTW9kYWwsIFxyXG5cdFRyZWVNZW51LFxyXG59IGZyb20gJy4uL2NvbXBvbmVudHMvaW5kZXgnO1xyXG5cclxuXHJcbmV4cG9ydCBjb25zdCBWSUVXX0NPTlRFTlRfQ09NUE9TRV9OT1RFUyA9IFwidmlldy1nZW5lcmF0ZS1tYXJrZG93blwiO1xyXG5cclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgTGlua1RyZWVUeXBlIHtcclxuXHRuYW1lOiBzdHJpbmc7XHJcblx0cGFyZW50Pzogc3RyaW5nIHwgdW5kZWZpbmVkO1xyXG5cdGNoaWxkcmVuOiBMaW5rVHJlZVR5cGVbXTtcclxuXHRpbmRleDogYm9vbGVhbjtcclxuXHRleGlzdHM6IGJvb2xlYW47XHJcblx0aW5saW5lOiBib29sZWFuO1xyXG5cdGxldmVsPzogbnVtYmVyO1xyXG5cdG9yZGVyPzogbnVtYmVyO1xyXG59XHJcblxyXG5pbnRlcmZhY2UgQnVpbGRMaW5rVHJlZVR5cGUgZXh0ZW5kcyBMaW5rVHJlZVR5cGV7XHJcblx0cGFyZW50UmVmPzogQnVpbGRMaW5rVHJlZVR5cGU7XHJcbn1cclxuXHJcbmV4cG9ydCBjbGFzcyBHZW5lcmF0ZU1hcmtkb3duIGV4dGVuZHMgSXRlbVZpZXcge1xyXG5cdFxyXG5cdHNldHRpbmdzOiBHZW5lcmF0ZU1hcmtkb3duUGx1Z2luU2V0dGluZ3NUeXBlO1xyXG5cclxuXHRjb250YWluZXI6IEVsZW1lbnQ7XHJcblx0dG9vbGJhcjogRWxlbWVudDtcclxuXHRzdHJ1Y3R1cmU6IEVsZW1lbnQ7XHJcblx0Z2VuZXJhdGVQcmV2aWV3UGFyZW50OiBFbGVtZW50O1xyXG5cdGdlbmVyYXRlTWFya2Rvd25QYXJlbnQ6IEVsZW1lbnQ7XHJcblxyXG5cdGxpbmtzVHJlZTogTGlua1RyZWVUeXBlW10gPSBbXTtcclxuXHRsb2FkZWRGaWxlczogVEFic3RyYWN0RmlsZVtdID0gW107XHJcblx0bWF4TGV2ZWw6IG51bWJlciA9IDA7XHJcblx0cHJvY2Vzc2VkOiBzdHJpbmdbXSA9IFtdO1xyXG5cdG1haW5OYW1lTGlua3M6IHN0cmluZ1tdID0gW107XHJcblxyXG5cdG1hcmtkb3duOiBzdHJpbmcgPSBcIlwiO1xyXG5cdGlnbm9yZWRMaW5rczogc3RyaW5nW10gPSBbXTtcclxuXHRpbWFnZXM6IHN0cmluZ1tdID0gW107XHJcblxyXG5cdHN0YXRpYyBpbWFnZVR5cGVzID0gWydqcGcnLCAnanBlZycsICdwbmcnLCAnZ2lmJywgJ3dlYnAnLCAndGlmZicsICdibXAnXS5tYXAoKGl0OiBzdHJpbmcpID0+IGAuJHtpdH1gKTtcclxuXHJcblx0Y29uc3RydWN0b3IobGVhZjogV29ya3NwYWNlTGVhZiwgc2V0dGluZ3M6IEdlbmVyYXRlTWFya2Rvd25QbHVnaW5TZXR0aW5nc1R5cGUpIHtcclxuXHRcdHN1cGVyKGxlYWYpO1xyXG5cdFx0dGhpcy5zZXR0aW5ncyA9IHNldHRpbmdzO1xyXG5cdH1cclxuXHJcblx0YXN5bmMgb25PcGVuKCkge1xyXG5cdFx0Y29uc3QgY29udGFpbmVyID0gdGhpcy5jb250YWluZXJFbC5jaGlsZHJlblsxXTtcclxuXHJcblx0XHQvL2NvbnNvbGUubG9nKHRoaXMuY29udGFpbmVyRWwpO1xyXG5cdFx0dGhpcy5jb250YWluZXIgPSBjb250YWluZXI7XHJcblx0XHRjb250YWluZXIuZW1wdHkoKTtcclxuXHJcblx0XHR0aGlzLnRvb2xiYXIgPSBjb250YWluZXIuY3JlYXRlRWwoXCJkaXZcIik7XHJcblx0XHR0aGlzLmdlbmVyYXRlUHJldmlld1BhcmVudCA9IHRoaXMudG9vbGJhci5jcmVhdGVFbCgnc3BhbicpO1xyXG5cdFx0dGhpcy5nZW5lcmF0ZU1hcmtkb3duUGFyZW50ID0gdGhpcy50b29sYmFyLmNyZWF0ZUVsKCdzcGFuJyk7XHJcblx0XHR0aGlzLnN0cnVjdHVyZSA9IHRoaXMuY29udGFpbmVyLmNyZWF0ZUVsKFwiZGl2XCIpO1xyXG5cclxuXHRcdG5ldyBCdXR0b24odGhpcy5nZW5lcmF0ZVByZXZpZXdQYXJlbnQsICdHZW5lcmF0ZSBwcmV2aWV3JywgKCkgPT4ge1xyXG5cdFx0XHQvLyBlbXB0eSBzdGF0ZVxyXG5cdFx0XHR0aGlzLmxpbmtzVHJlZSA9IFtdO1xyXG5cdFx0XHR0aGlzLm1heExldmVsID0gMDtcclxuXHRcdFx0dGhpcy5wcm9jZXNzZWQgPSBbXTtcclxuXHRcdFx0dGhpcy5tYWluTmFtZUxpbmtzID0gW107XHJcblx0XHRcdHRoaXMuaWdub3JlZExpbmtzID0gW107XHJcblx0XHRcdHRoaXMubWFya2Rvd24gPSBcIlwiO1xyXG5cdFx0XHRcclxuXHRcdFx0dGhpcy5zdHJ1Y3R1cmUuZW1wdHkoKTtcclxuXHRcdFx0dGhpcy5nZW5lcmF0ZU1hcmtkb3duUGFyZW50LmVtcHR5KCk7XHJcblx0XHRcdHRoaXMucmVhZFNlbGVjdGVkTm90ZSgpO1xyXG5cdFx0fSk7XHJcblx0fVxyXG5cclxuXHRwYXJzZUxpbmtzKHRleHQ6IHN0cmluZywgaW5kZXg6IGJvb2xlYW4gPSBmYWxzZSkge1xyXG5cdFx0Y29uc3QgbGlua3MgPSB0ZXh0Lm1hdGNoQWxsKC9cXFtcXFsoLio/KVxcXVxcXS9nKTtcclxuXHRcdC8vY29uc29sZS5sb2coWy4uLmxpbmtzXSk7XHJcblx0XHRsZXQgY2xlYW5MaW5rcyA9IFsuLi5saW5rc10ubWFwKGwgPT4gbFsxXSk7XHJcblxyXG5cdFx0Y2xlYW5MaW5rcyA9IFsuLi5uZXcgU2V0KGNsZWFuTGlua3MpXTtcclxuXHJcblx0XHQvLyBmaWx0ZXIgb3V0IGFuY2hvciBsaW5rcyAoW1sjZm9vYmFyXV0pXHJcblx0XHRjbGVhbkxpbmtzID0gY2xlYW5MaW5rcy5maWx0ZXIoY2wgPT4gIWNsLnN0YXJ0c1dpdGgoJyMnKSk7XHJcblxyXG5cdFx0Y29uc3QgZXhpc3RpbmdOb3RlcyA9IGNsZWFuTGlua3MubWFwKChjbDogc3RyaW5nKSA9PiB7XHJcblx0XHRcdFxyXG5cdFx0XHRjbCA9IGZpeFNwYWNlSW5OYW1lKGNsKTtcclxuXHJcblx0XHRcdGlmICghIUdlbmVyYXRlTWFya2Rvd24uaW1hZ2VUeXBlcy5maWx0ZXIoKGl0OiBzdHJpbmcpID0+IGNsLmluY2x1ZGVzKGl0LnRvTG93ZXJDYXNlKCkpKS5sZW5ndGgpIHtcclxuXHRcdFx0XHR0aGlzLmltYWdlcy5wdXNoKGNsKVxyXG5cdFx0XHRcdHJldHVybiBmYWxzZTtcclxuXHRcdFx0fVxyXG5cclxuXHRcdFx0bGV0IGlzSW5saW5lID0gdHJ1ZTtcdFx0XHRcclxuXHRcdFx0aWYgKHRleHQuaW5jbHVkZXModGhpcy5zZXR0aW5ncy5saXN0T2ZMaW5rc0tleXdvcmQpKSB7XHJcblx0XHRcdFx0bGV0IFtpbmxpbmVUZXh0LCBsaW5rc1RleHRdID0gdGV4dC5zcGxpdCh0aGlzLnNldHRpbmdzLmxpc3RPZkxpbmtzS2V5d29yZCk7XHJcblx0XHRcdFx0aWYgKCFpbmxpbmVUZXh0LmluY2x1ZGVzKGNsKSlcclxuXHRcdFx0XHRcdGlzSW5saW5lID0gZmFsc2U7XHJcblx0XHRcdH1cclxuXHJcblx0XHRcdGxldCBpc0luZGV4ID0gZmFsc2U7XHJcblx0XHRcdGlmIChpbmRleCkge1xyXG5cdFx0XHRcdGlzSW5saW5lID0gZmFsc2U7XHJcblx0XHRcdFx0aXNJbmRleCA9IHRydWU7XHJcblx0XHRcdH1cclxuXHJcblx0XHRcdGNvbnN0IG5vdGUgPSB0aGlzLmxvYWRlZEZpbGVzLmZpbmQoKGY6IFRGaWxlKSA9PiBmWydiYXNlbmFtZSddID09PSBjbCk7XHJcblx0XHRcdHJldHVybiB7XHJcblx0XHRcdFx0bmFtZTogY2wsXHJcblx0XHRcdFx0ZXhpc3RzOiAhIW5vdGUsXHRcclxuXHRcdFx0XHRpbmxpbmU6IGlzSW5saW5lLFxyXG5cdFx0XHRcdGluZGV4OiBpc0luZGV4XHJcblx0XHRcdH07XHJcblxyXG5cdFx0fSkuZmlsdGVyKEJvb2xlYW4pO1xyXG5cdFx0Ly9jb25zb2xlLmxvZyhleGlzdGluZ05vdGVzKTtcclxuXHRcdHJldHVybiBleGlzdGluZ05vdGVzIGFzIExpbmtUcmVlVHlwZVtdO1xyXG5cdH1cclxuXHJcblx0cmVhZFNlbGVjdGVkTm90ZSgpIHtcclxuXHRcdHRoaXMubG9hZGVkRmlsZXMgPSBhcHAudmF1bHQuZ2V0QWxsTG9hZGVkRmlsZXMoKTtcclxuXHJcblx0XHRjb25zdCBhY3RpdmVOb3RlID0gdGhpcy5hcHAud29ya3NwYWNlLmdldEFjdGl2ZUZpbGUoKTtcclxuXHRcdFxyXG5cdFx0aWYgKCFhY3RpdmVOb3RlKSB7XHJcblx0XHRcdG5ldyBOb3RpY2UoYFNlbGVjdGVkIG5vdGUgaXMgaW52YWxpZC5gKTtcclxuXHRcdFx0dGhyb3cgbmV3IEVycm9yKFwiU2VsZWN0ZWQgbm90ZSBpcyBpbnZhbGlkLlwiKTtcclxuXHRcdH1cclxuXHJcblx0XHRjb25zdCBhY3RpdmVOb3RlVGV4dCA9IGdldE5vdGVCeU5hbWUoYWN0aXZlTm90ZS5iYXNlbmFtZSwgdGhpcy5sb2FkZWRGaWxlcyk7XHJcblxyXG5cdFx0Y29uc3QgbWFpbkNvbnRlbnRMaW5rcyA9IHRoaXMucGFyc2VMaW5rcyhhY3RpdmVOb3RlVGV4dCwgdHJ1ZSk7XHJcblxyXG5cdFx0dGhpcy5tYWluTmFtZUxpbmtzID0gbWFpbkNvbnRlbnRMaW5rcy5tYXAoKGw6IExpbmtUcmVlVHlwZSkgPT4gbC5uYW1lKTtcclxuXHRcdFxyXG5cdFx0Y29uc3QgdGl0bGUgPSBhY3RpdmVOb3RlLmJhc2VuYW1lO1xyXG5cdFx0dGhpcy5saW5rc1RyZWUgPSB0aGlzLmdlbmVyYXRlTm90ZXNIaWVyYXJjaHkobWFpbkNvbnRlbnRMaW5rcywgdGl0bGUpO1xyXG5cdFx0Ly9jb25zb2xlLmxvZyhcInRyZWVcIiwgdGhpcy5saW5rc1RyZWUpO1xyXG5cclxuXHRcdFxyXG5cdFx0bmV3IEJhc2VMaW5rKHRoaXMuYXBwLCB0aGlzLnN0cnVjdHVyZSwgdGl0bGUpO1xyXG5cclxuXHRcdG5ldyBUcmVlTWVudSh0aGlzLmFwcCwgdGhpcy5zdHJ1Y3R1cmUsIHRoaXMubGlua3NUcmVlLCAoaWdub3JlZExpbmtzOiBzdHJpbmdbXSkgPT4ge1xyXG5cdFx0XHR0aGlzLmlnbm9yZWRMaW5rcyA9IGlnbm9yZWRMaW5rcztcclxuXHRcdFx0Ly9jb25zb2xlLmxvZyhcImlnbm9yZWRcIixpZ25vcmVkTGlua3MpO1xyXG5cdFx0fSk7XHJcblx0XHRcclxuXHRcdG5ldyBCdXR0b24odGhpcy5nZW5lcmF0ZU1hcmtkb3duUGFyZW50LCAnR2VuZXJhdGUgbWFya2Rvd24nLCAoKSA9PiB7XHJcblx0XHRcdFxyXG5cdFx0XHQvLyBjbGVhbnVwXHJcblx0XHRcdHRoaXMubWFya2Rvd24gPSBcIlwiO1xyXG5cclxuXHRcdFx0dGhpcy5nZW5lcmF0ZU1hcmtkb3duRmlsZSh0aGlzLmxpbmtzVHJlZSwgYWN0aXZlTm90ZVRleHQpO1xyXG5cdFx0fSwgeyBjbHM6ICdnZW5lcmF0ZS1tYXJrZG93bi1idG4nIH0pO1xyXG5cdH1cclxuXHJcblx0Z2VuZXJhdGVNYXJrZG93bkZpbGUobGlua3M6IExpbmtUcmVlVHlwZVtdLCBtYWluTm90ZTogc3RyaW5nKSB7XHJcblx0XHR0aGlzLmNvbXBvc2VNYXJrZG93bihsaW5rcyk7XHJcblxyXG5cdFx0Ly8gdHJhbnNmb3JtIGxpbmtzIHRvIGFuY2hvciBpbiBpbmRleCBub3RlIFxyXG5cdFx0dGhpcy5tYWluTmFtZUxpbmtzLmZvckVhY2goKG1ubDogc3RyaW5nKSA9PiB7XHJcblx0XHRcdFxyXG5cdFx0XHRtYWluTm90ZSA9IG1haW5Ob3RlLnJlcGxhY2VBbGwoYFtbJHttbmx9XV1gLCBgW1sjJHttbmx9XV1gKVxyXG5cdFx0fSk7XHJcblxyXG5cdFx0dGhpcy5tYXJrZG93biA9IG1haW5Ob3RlICsgdGhpcy5tYXJrZG93bjtcclxuXHJcblx0XHRuZXcgU2F2ZU1vZGFsKHRoaXMuYXBwLCAoZmlsZU5hbWUpID0+IHtcclxuXHRcdFx0dGhpcy5hcHAudmF1bHQuYWRhcHRlci53cml0ZShgJHtmaWxlTmFtZX0ubWRgLCB0aGlzLm1hcmtkb3duKS50aGVuKCgpID0+IHtcclxuXHRcdFx0XHRuZXcgTm90aWNlKGBOb3RlICR7ZmlsZU5hbWV9IGNyZWF0ZWQgc3VjY2Vzc2Z1bGx5YCk7XHJcblx0XHRcdFx0dGhpcy5hcHAud29ya3NwYWNlLm9wZW5MaW5rVGV4dChgJHtmaWxlTmFtZX0ubWRgLCBcIlwiKVxyXG5cdFx0XHR9KTtcclxuXHRcdH0pLm9wZW4oKTtcclxuXHRcdFxyXG5cdH1cclxuXHJcblx0Y29tcG9zZU1hcmtkb3duKGxpbmtzOiBMaW5rVHJlZVR5cGVbXSkge1xyXG5cdFx0bGlua3MuZm9yRWFjaCgobGluazogTGlua1RyZWVUeXBlKSA9PiB7XHJcblx0XHRcdGxldCBub3RlID0gZ2V0Tm90ZUJ5TmFtZShsaW5rLm5hbWUsIHRoaXMubG9hZGVkRmlsZXMpO1xyXG5cdFx0XHRjb25zdCBsb2NhbExpbmtzID0gdGhpcy5wYXJzZUxpbmtzKG5vdGUpO1xyXG5cclxuXHRcdFx0aWYgKHRoaXMuaWdub3JlZExpbmtzLmluY2x1ZGVzKGxpbmsubmFtZSkpXHJcblx0XHRcdFx0cmV0dXJuO1xyXG5cclxuXHRcdFx0Ly8gdHJpbSBlbnRlcnMgYW5kIHNwYWNlc1xyXG5cdFx0XHRub3RlID0gbm90ZS50cmltKCk7XHJcblxyXG5cdFx0XHRpZiAobm90ZS5sZW5ndGggPT0gMClcclxuXHRcdFx0XHRyZXR1cm47XHJcblxyXG5cdFx0XHQvLyB0cmFuc2Zvcm0gbGlua3MgdG8gYW5jaG9yc1xyXG5cdFx0XHRsb2NhbExpbmtzLmZvckVhY2goKGxvY2FsTGluazogTGlua1RyZWVUeXBlKSA9PiB7XHJcblx0XHRcdFx0aWYgKGxvY2FsTGluay5pbmxpbmUgJiYgdGhpcy5pZ25vcmVkTGlua3MuaW5jbHVkZXMobG9jYWxMaW5rLm5hbWUpKVxyXG5cdFx0XHRcdFx0bm90ZSA9IG5vdGUucmVwbGFjZUFsbChgW1ske2xvY2FsTGluay5uYW1lfV1dYCwgbG9jYWxMaW5rLm5hbWUpO1xyXG5cdFx0XHRcdGVsc2VcclxuXHRcdFx0XHRcdG5vdGUgPSBub3RlLnJlcGxhY2VBbGwoYFtbJHtsb2NhbExpbmsubmFtZX1dXWAsIGBbWyMke2xvY2FsTGluay5uYW1lfV1dYClcclxuXHRcdFx0fSlcclxuXHJcblx0XHRcdC8vIHJlbW92ZSB0aXRsZSBvbiBhIGZpcnN0IGxpbmVcclxuXHRcdFx0bGV0IG5vdGVSb3dzID0gbm90ZS5zcGxpdCgnXFxuJyk7XHJcblx0XHRcdGxldCBmaXJzdFJvdyA9IGZpeFNwYWNlSW5OYW1lKG5vdGVSb3dzWzBdKTtcclxuXHRcdFx0aWYgKGZpcnN0Um93LmluY2x1ZGVzKGAjICR7bGluay5uYW1lfWApKSB7XHJcblx0XHRcdFx0bm90ZVJvd3Muc2hpZnQoKTtcclxuXHRcdFx0XHRub3RlID0gbm90ZVJvd3Muam9pbihcIlxcblwiKS50cmltKCk7XHJcblx0XHRcdH1cclxuXHJcblx0XHRcdC8vIHJlcGxhY2UgdGl0bGVzIHdpdGgganVzdCBib2xkIHRleHRcclxuXHRcdFx0bm90ZVJvd3MgPSBub3RlLnNwbGl0KCdcXG4nKTtcclxuXHRcdFx0bm90ZSA9IG5vdGVSb3dzLm1hcCgobm90ZVJvdzogc3RyaW5nKSA9PiB7XHJcblx0XHRcdFx0Y29uc3QgbWF0Y2ggPSBub3RlUm93Lm1hdGNoKC8jIChcXHcrKS8pO1xyXG5cdFx0XHRcdFxyXG5cdFx0XHRcdGlmIChtYXRjaClcclxuXHRcdFx0XHRcdHJldHVybiBgKioke21hdGNoWzFdfSoqYDtcclxuXHJcblx0XHRcdFx0cmV0dXJuIG5vdGVSb3c7XHJcblx0XHRcdH0pLmpvaW4oXCJcXG5cIik7XHJcblx0XHRcdFxyXG5cdFx0XHQvLyByZW1vdmUgJ0thbSBkXHUwMEUxbCcgcGFydFxyXG5cdFx0XHRpZiAobm90ZS5pbmNsdWRlcyh0aGlzLnNldHRpbmdzLmxpc3RPZkxpbmtzS2V5d29yZCkpIHtcclxuXHRcdFx0XHRsZXQgW2ltcG9ydGFudFBhcnQsIGVuZFBhcnRdID0gbm90ZS5zcGxpdCh0aGlzLnNldHRpbmdzLmxpc3RPZkxpbmtzS2V5d29yZCk7XHJcblx0XHRcdFx0bm90ZSA9IGltcG9ydGFudFBhcnQudHJpbSgpO1xyXG5cdFx0XHR9XHJcblx0XHRcdFxyXG5cdFx0XHQvLyBnZW5lcmF0ZSBuZXN0ZWQgdGl0bGUgZS5nLiBoMyAtPiAjIyMgdGl0bGUzXHJcblx0XHRcdGxldCB0aXRsZSA9IFwiXCI7XHJcblx0XHRcdGlmIChsaW5rLmlubGluZSkge1xyXG5cdFx0XHRcdC8vIGg1XHJcblx0XHRcdFx0dGl0bGUgPSBgIyMjIyMgJHtsaW5rLm5hbWV9YDtcclxuXHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRjb25zdCBuZXN0ZWRMZXZlbCA9IEFycmF5KGxpbmsubGV2ZWwpLmZpbGwoJyMnKS5qb2luKCcnKTtcclxuXHRcdFx0XHR0aXRsZSA9IGAke25lc3RlZExldmVsfSAke2xpbmsubmFtZX1gO1xyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHRub3RlID0gYFxcblxcbiR7dGl0bGV9XFxuJHtub3RlfWA7XHJcblxyXG5cdFx0XHQvLyBzaG91bGQgYmUgbGFzdFxyXG5cdFx0XHR0aGlzLm1hcmtkb3duICs9IG5vdGU7XHJcblxyXG5cdFx0XHRpZiAoJ2NoaWxkcmVuJyBpbiBsaW5rKVxyXG5cdFx0XHRcdHRoaXMuY29tcG9zZU1hcmtkb3duKGxpbmsuY2hpbGRyZW4pO1xyXG5cdFx0fSk7XHJcblx0fVxyXG5cdFxyXG5cdC8vIHdob2xlIHBhdGggZnJvbSBub3RlIHRvIHJvb3RcclxuXHRkZnMobGlua3M6IEJ1aWxkTGlua1RyZWVUeXBlW10sIGxldmVsOiBudW1iZXIsIHBhcmVudFJlZj86IG9iamVjdCwgdGl0bGVNYXBwaW5nPzogb2JqZWN0KSB7XHJcblxyXG5cdFx0dGl0bGVNYXBwaW5nID0gKHRpdGxlTWFwcGluZyBhcyBCdWlsZExpbmtUcmVlVHlwZSkgPz8ge307IFxyXG5cdFx0XHJcblx0XHRsaW5rcy5mb3JFYWNoKChsaW5rOiBCdWlsZExpbmtUcmVlVHlwZSwgb3JkZXI6IG51bWJlcikgPT4ge1xyXG5cclxuXHRcdFx0Ly8gc2tpcCBsaW5rIGZyb20gbWFpbkNvbnRlbnRcclxuXHRcdFx0aWYgKHRoaXMubWFpbk5hbWVMaW5rcy5pbmNsdWRlcyhsaW5rLm5hbWUpICYmIGxldmVsICE9IDApXHJcblx0XHRcdFx0cmV0dXJuO1xyXG5cclxuXHRcdFx0Ly8gc2tpcCBpZiBsaW5rIGlzIGFscmVhZHkgcHJvY2Vzc2VkXHJcblx0XHRcdGlmICh0aGlzLnByb2Nlc3NlZC5pbmNsdWRlcyhsaW5rLm5hbWUpKVxyXG5cdFx0XHRcdHJldHVybjtcclxuXHJcblx0XHRcdHRoaXMucHJvY2Vzc2VkLnB1c2gobGluay5uYW1lKTtcclxuXHRcdFx0Ly9jb25zb2xlLmxvZyhsaW5rLm5hbWUpO1xyXG5cclxuXHRcdFx0Y29uc3Qgbm90ZSA9IGdldE5vdGVCeU5hbWUobGluay5uYW1lLCB0aGlzLmxvYWRlZEZpbGVzKTtcclxuXHRcdFx0Y29uc3Qgc3ViTGlua3MgPSB0aGlzLnBhcnNlTGlua3Mobm90ZSk7XHJcblxyXG5cdFx0XHR0aGlzLm1heExldmVsID0gbGV2ZWwgKyAxO1xyXG5cclxuXHRcdFx0KHRpdGxlTWFwcGluZyBhcyBhbnkpW2xpbmsubmFtZV0gPSB7IC4uLmxpbmssIHBhcmVudFJlZiwgbGV2ZWw6IHRoaXMubWF4TGV2ZWwsIG9yZGVyfTtcclxuXHJcblx0XHQgIGlmIChzdWJMaW5rcy5sZW5ndGggPiAwKSB7XHJcblx0XHRcdHRoaXMuZGZzKHN1YkxpbmtzLCB0aGlzLm1heExldmVsLCAodGl0bGVNYXBwaW5nIGFzIGFueSlbbGluay5uYW1lXSwgdGl0bGVNYXBwaW5nKTtcclxuXHRcdCAgfVxyXG5cdFx0fSk7XHJcblx0XHQvL2NvbnNvbGUubG9nKFwiVE1cIiwgSlNPTi5zdHJpbmdpZnkodGl0bGVNYXBwaW5nKSk7XHJcblx0XHRyZXR1cm4gdGl0bGVNYXBwaW5nIGFzIEJ1aWxkTGlua1RyZWVUeXBlO1x0XHJcblx0fVxyXG5cclxuXHJcblx0Ly9nZXR0aW5nIGNoaWxkcmVuIGZvciBub3Rlc1xyXG5cdGdlbmVyYXRlTm90ZXNIaWVyYXJjaHkobGlua3M6IExpbmtUcmVlVHlwZVtdLCB0aXRsZTogc3RyaW5nKSB7XHJcblx0XHRjb25zdCBsaW5rc09iajogQnVpbGRMaW5rVHJlZVR5cGUgPSB0aGlzLmRmcyhsaW5rcywgMCk7XHJcblx0XHRjb25zb2xlLmxvZyhcImxpbmtvYmpcIiwgbGlua3NPYmopO1xyXG5cdFx0bGV0IGxpbmtzQXJyOiBMaW5rVHJlZVR5cGVbXSA9IFtdO1xyXG5cdFx0XHJcblx0XHRPYmplY3Qua2V5cyhsaW5rc09iaikuZm9yRWFjaChrZXkgPT4ge1xyXG5cdFx0XHRjb25zdCB7cGFyZW50UmVmLCAuLi5yZXN0fSA9IGxpbmtzT2JqW2tleSBhcyBrZXlvZiBCdWlsZExpbmtUcmVlVHlwZV0gYXMgQnVpbGRMaW5rVHJlZVR5cGU7IFxyXG5cdFx0XHRsaW5rc0Fyci5wdXNoKHsuLi5yZXN0LCBwYXJlbnQ6IChsaW5rc09ialtrZXkgYXMga2V5b2YgQnVpbGRMaW5rVHJlZVR5cGVdIGFzIEJ1aWxkTGlua1RyZWVUeXBlKT8ucGFyZW50UmVmPy5uYW1lfSk7XHJcblx0XHR9KTtcclxuXHJcblx0XHRjb25zb2xlLmxvZyhcIkxBXCIsIGxpbmtzQXJyKTtcclxuXHJcblx0XHQvL3ByZXNlbnRhdGlvbiBzbGlkZXNcclxuXHRcdFxyXG5cdFx0bGV0IG1heERlcHRoID0gTnVtYmVyKHRoaXMuc2V0dGluZ3Muc2xpZGVzRGVwdGgpO1xyXG5cdFx0ZnVuY3Rpb24gZ2V0Q2hpbGRyZW4ocGFyZW50OiBMaW5rVHJlZVR5cGUpe1xyXG5cdFx0XHRcclxuXHRcdFx0Y29uc29sZS5sb2coXCJkZXB0aFwiLCBzdGFydERlcHRoKTtcclxuXHRcdFx0bGV0IGNoaWxkcmVuOiBMaW5rVHJlZVR5cGVbXSA9IGxpbmtzQXJyLmZpbHRlcigoY2hpbGQpID0+IGNoaWxkLnBhcmVudCA9PT0gcGFyZW50Lm5hbWUpO1xyXG5cdFx0XHRjb25zb2xlLmxvZyhcImNoaWxkcmVuXCIsIGNoaWxkcmVuKTtcclxuXHRcdFx0aWYoc3RhcnREZXB0aCA8PSBtYXhEZXB0aCl7XHJcblx0XHRcdFx0Y2hpbGRyZW4uZm9yRWFjaChjaGlsZCA9PiB7XHJcblx0XHRcdFx0XHRzbGlkZXNMaXN0ICs9ICBcIlxcblwiICsgXCIjXCIucmVwZWF0KHN0YXJ0RGVwdGggKyAxKSArIGNoaWxkLm5hbWU7XHJcblx0XHRcdFx0XHRpZiAoc3RhcnREZXB0aCAhPSBtYXhEZXB0aCl7XHJcblx0XHRcdFx0XHRcdHN0YXJ0RGVwdGggKz0gMTtcclxuXHRcdFx0XHRcdFx0Z2V0Q2hpbGRyZW4oY2hpbGQpO1xyXG5cdFx0XHRcdFx0fWVsc2Uge1xyXG5cdFx0XHRcdFx0XHRjb25zb2xlLmxvZyhcIlx1MDEwRGFhdVwiKTtcclxuXHRcdFx0XHRcdFx0cmV0dXJuO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0c3RhcnREZXB0aCAtPSAxO1x0XHRcdFx0XHJcblx0XHRcdFx0fSlcclxuXHRcdFx0XHRcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cclxuXHRcdGxldCBzbGlkZXNMaXN0ID0gXCJcIjtcclxuXHRcdGxldCBzbGlkZXMgPSBsaW5rc0Fyci5maWx0ZXIoKGxpbmspID0+IGxpbmsubGV2ZWwgPT09IDEpO1xyXG5cdFx0Y29uc29sZS5sb2coXCJTTElERVNcIiwgc2xpZGVzKTtcclxuXHRcdGxldCBzdGFydERlcHRoOiBudW1iZXI7XHJcblx0XHRzbGlkZXMuZm9yRWFjaChzbGlkZSA9PiB7XHJcblx0XHRcdHN0YXJ0RGVwdGggPSAyO1xyXG5cdFx0XHRzbGlkZXNMaXN0ICs9ICBcIlxcbiAjI1wiICsgc2xpZGUubmFtZTtcclxuXHRcdFx0Z2V0Q2hpbGRyZW4oc2xpZGUpO1x0XHJcblx0XHR9KVxyXG5cdFx0Y29uc29sZS5sb2coXCJzbGlkZUxpc3RcIiwgc2xpZGVzTGlzdCk7XHJcblxyXG5cdFx0XHJcblx0XHRcclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHRcdGNvbnN0IGNyZWF0ZUNoaWxkcmVuRnJvbVBhcmVudCA9IChhcnI6IExpbmtUcmVlVHlwZVtdLCBwYXJlbnQ6IHN0cmluZyB8IHVuZGVmaW5lZCkgPT4ge1xyXG5cdFx0XHRsZXQgY2hpbGRyZW5BcnIgPSBbXTtcclxuXHRcdFx0Zm9yKGxldCBpID0gMDsgaSA8IGFyci5sZW5ndGg7IGkrKykge1xyXG5cdFx0XHRcdC8vaW5kZXggbGlua3MgPSB1bmRlZmluZWRcclxuXHRcdFx0XHRpZihhcnJbaV0ucGFyZW50ID09IHBhcmVudCkge1xyXG5cdFx0XHRcdFx0Y29uc3QgY2hpbGRyZW4gPSBjcmVhdGVDaGlsZHJlbkZyb21QYXJlbnQoYXJyLCBhcnJbaV0ubmFtZSk7XHJcblx0XHRcdFx0XHRpZihjaGlsZHJlbi5sZW5ndGgpIHtcclxuXHRcdFx0XHRcdFx0YXJyW2ldLmNoaWxkcmVuID0gY2hpbGRyZW47XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRjaGlsZHJlbkFyci5wdXNoKGFycltpXSk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHRcdC8vY29uc29sZS5sb2coXCJDSEFcIiwgY2hpbGRyZW5BcnIpO1xyXG5cdFx0XHRyZXR1cm4gY2hpbGRyZW5BcnI7XHJcblx0XHR9XHJcblx0XHQvL2NvbnNvbGUubG9nKFwibmVzdGVkY2hpbGRlclwiLCBnZXROZXN0ZWRDaGlsZHJlbihsaW5rc0FyciwgdW5kZWZpbmVkKSk7XHJcblx0XHRyZXR1cm4gY3JlYXRlQ2hpbGRyZW5Gcm9tUGFyZW50KGxpbmtzQXJyLCB1bmRlZmluZWQpO1xyXG5cdH1cclxuXHJcblx0XHJcblxyXG5cdGFzeW5jIG9uQ2xvc2UoKSB7XHJcblx0XHQvLyBOb3RoaW5nIHRvIGNsZWFuIHVwLlxyXG5cdH1cclxuXHJcblx0Z2V0Vmlld1R5cGUoKSB7XHJcblx0XHRyZXR1cm4gVklFV19DT05URU5UX0NPTVBPU0VfTk9URVM7XHJcblx0fVxyXG5cclxuXHRnZXREaXNwbGF5VGV4dCgpIHtcclxuXHRcdHJldHVybiBcIk5vdGVzIE1lcmdlclwiO1xyXG5cdH1cclxufVxyXG4iLCAiaW1wb3J0IHsgcmVhZEZpbGVTeW5jIH0gZnJvbSAnZnMnO1xyXG5pbXBvcnQgeyBGaWxlU3lzdGVtQWRhcHRlciwgVEFic3RyYWN0RmlsZSwgVEZpbGUgfSBmcm9tICdvYnNpZGlhbic7XHJcblxyXG5leHBvcnQgY29uc3QgZml4U3BhY2VJbk5hbWUgPSAobmFtZTogc3RyaW5nKSA9PiB7XHJcblx0cmV0dXJuIG5hbWUucmVwbGFjZSgvW1xcdTAwQTBcXHUxNjgwXFx1MTgwRVxcdTIwMDAtXFx1MjAwQlxcdTIwMkZcXHUyMDVGXFx1MzAwMFxcdUZFRkZdLywgXCIgXCIpLnRyaW0oKTtcclxufVxyXG5cclxuZXhwb3J0IGNvbnN0IGdldE5vdGVCeU5hbWUgPSAobmFtZTogc3RyaW5nLCBsb2FkZWRGaWxlczogVEFic3RyYWN0RmlsZVtdKSA9PiB7XHJcblx0Y29uc3QgbG9hZGVkRmlsZSA9IGxvYWRlZEZpbGVzLmZpbmQoKGZpbGU6IFRGaWxlKSA9PiBmaWxlLmJhc2VuYW1lID09PSBuYW1lKTtcclxuXHQgXHJcblx0Y29uc3QgZnVsbFBhdGggPSAoYXBwLnZhdWx0LmFkYXB0ZXIgYXMgRmlsZVN5c3RlbUFkYXB0ZXIpLmdldEZ1bGxQYXRoKG5hbWUpO1xyXG5cclxuXHRpZiAoIWxvYWRlZEZpbGUpXHJcblx0XHRyZXR1cm4gXCJcIjtcclxuXHJcblx0Y29uc3QgYWJzb2x1dGVQYXRoID0gZnVsbFBhdGgucmVwbGFjZShuYW1lLCBsb2FkZWRGaWxlLnBhdGgucmVwbGFjZSgnLycsICdcXFxcJykpXHJcblx0Y29uc3Qgbm90ZSA9IHJlYWRGaWxlU3luYyhhYnNvbHV0ZVBhdGgsIHsgZW5jb2Rpbmc6ICd1dGY4JyB9KTtcclxuXHRyZXR1cm4gbm90ZTsgLy8gdGV4dCBvZiBub3RlXHJcbn1cclxuIiwgImV4cG9ydCBjbGFzcyBCdXR0b24ge1xyXG5cdGJ0bjogSFRNTEJ1dHRvbkVsZW1lbnQ7XHJcblxyXG5cdGNvbnN0cnVjdG9yKGVsZW1lbnQ6IEVsZW1lbnQsIHRleHQ6IHN0cmluZywgb25DbGljazogKGNvbnRleHQ6IEJ1dHRvbikgPT4gdm9pZCwgYXJncz86IG9iamVjdCkge1xyXG5cdFx0dGhpcy5idG4gPSBlbGVtZW50LmNyZWF0ZUVsKCdidXR0b24nLCB7IHRleHQsIC4uLmFyZ3MgfSk7XHJcblx0XHR0aGlzLmJ0bi5vbmNsaWNrID0gKCkgPT4ge1xyXG5cdFx0XHRvbkNsaWNrKHRoaXMpO1xyXG5cdFx0fTtcdFxyXG5cdFx0cmV0dXJuIHRoaXM7XHJcblx0fVxyXG59XHJcbiIsICJpbXBvcnQgeyBBcHAgfSBmcm9tIFwib2JzaWRpYW5cIjtcclxuaW1wb3J0IHsgTGlua1RyZWVUeXBlIH0gZnJvbSBcInNyYy92aWV3cy9nZW5lcmF0ZS1tYXJrZG93blwiO1xyXG5cclxuZXhwb3J0IGNsYXNzIEJhc2VMaW5rIHtcclxuXHRjb250ZXh0OiBBcHA7XHJcblx0ZWxlbWVudDogRWxlbWVudDtcclxuXHRuYW1lOiBzdHJpbmc7XHJcblxyXG5cdGNvbnN0cnVjdG9yKGNvbnRleHQ6IEFwcCwgZWxlbWVudDogRWxlbWVudCwgbmFtZTogc3RyaW5nKSB7XHJcblx0XHR0aGlzLmNvbnRleHQgPSBjb250ZXh0O1xyXG5cdFx0dGhpcy5lbGVtZW50ID0gZWxlbWVudDtcclxuXHRcdHRoaXMubmFtZSA9IG5hbWU7XHJcblxyXG5cdFx0dGhpcy5yZW5kZXIoKTtcclxuXHR9XHJcblxyXG5cdHJlbmRlcigpIHtcclxuXHRcdGNvbnN0IGhyZWZUaXRsZSA9IHRoaXMuZWxlbWVudC5jcmVhdGVFbCgnYScsIHsgdGV4dDogdGhpcy5uYW1lLCBjbHM6ICdjb250X190aXRsZScgfSk7XHJcblx0XHRocmVmVGl0bGUub25jbGljayA9ICgpID0+IHtcclxuXHRcdFx0dGhpcy5jb250ZXh0LndvcmtzcGFjZS5vcGVuTGlua1RleHQodGhpcy5uYW1lLCBcIlwiKTtcclxuXHRcdH1cclxuXHR9XHJcblxyXG59XHJcblxyXG4vLyBMaW5rIHdpdGggaW5uZXIgc3RhdGUgYW5kIGhlbHBlciBmbmNzXHJcbmV4cG9ydCBjbGFzcyBMaW5rIHtcclxuXHJcblx0Y29udGV4dDogQXBwO1xyXG5cdGE6IEhUTUxFbGVtZW50O1xyXG5cdGxpbms6IExpbmtUcmVlVHlwZTtcclxuXHRlbGVtZW50OiBFbGVtZW50O1xyXG5cdHRvZ2dsZWRTdGF0ZTogYm9vbGVhbiA9IGZhbHNlO1xyXG5cclxuXHRjb25zdHJ1Y3Rvcihjb250ZXh0OiBBcHAsIGVsZW1lbnQ6IEVsZW1lbnQsIGxpbms6IExpbmtUcmVlVHlwZSwgcmVuZGVyTm93OiBib29sZWFuID0gdHJ1ZSkge1xyXG5cdFx0dGhpcy5saW5rID0gbGluaztcclxuXHRcdHRoaXMuY29udGV4dCA9IGNvbnRleHQ7XHJcblx0XHR0aGlzLmVsZW1lbnQgPSBlbGVtZW50O1xyXG5cclxuXHRcdGlmIChyZW5kZXJOb3cpXHJcblx0XHRcdHRoaXMucmVuZGVyKGZhbHNlKTtcclxuXHJcblx0XHRyZXR1cm4gdGhpcztcclxuXHR9XHJcblxyXG5cdHJlbmRlcihzdGF0ZTogYm9vbGVhbikge1xyXG5cdFx0dGhpcy5hID0gdGhpcy5lbGVtZW50LmNyZWF0ZUVsKCdhJywgeyB0ZXh0OiB0aGlzLmxpbmsubmFtZSwgY2xzOiBcImxpbmtcIiB9KTtcclxuXHRcdCF0aGlzLmxpbmsuZXhpc3RzICYmIHRoaXMuYS5hZGRDbGFzcyhcImNvbnRfX2xpbmstbm90LWV4aXN0XCIpO1xyXG5cdFx0dGhpcy5saW5rLmlubGluZSAmJiB0aGlzLmEuYWRkQ2xhc3MoXCJpbmxpbmVcIik7XHJcblx0XHR0aGlzLmEub25jbGljayA9ICgpID0+IHtcclxuXHRcdFx0dGhpcy5jb250ZXh0LndvcmtzcGFjZS5vcGVuTGlua1RleHQodGhpcy5saW5rLm5hbWUsIFwiXCIpO1xyXG5cdFx0XHQhdGhpcy5saW5rLmV4aXN0cyAmJiB0aGlzLmEucmVtb3ZlQ2xhc3MoXCJjb250X19saW5rLW5vdC1leGlzdFwiKTtcclxuXHRcdH07XHJcblxyXG5cdFx0dGhpcy50b2dnbGUoc3RhdGUpO1xyXG5cdH1cclxuXHJcblx0dG9nZ2xlKHN0YXRlOiBib29sZWFuKSB7XHJcblx0XHRpZiAoc3RhdGUpXHJcblx0XHRcdHRoaXMuYS5yZW1vdmVDbGFzcygnc3RyaWtldGhyb3VnaCcpO1xyXG5cdFx0ZWxzZVxyXG5cdFx0XHR0aGlzLmEuYWRkQ2xhc3MoJ3N0cmlrZXRocm91Z2gnKTtcclxuXHR9XHJcbn1cclxuIiwgImltcG9ydCB7IEFwcCwgTW9kYWwsIFNldHRpbmcgfSBmcm9tIFwib2JzaWRpYW5cIjtcclxuXHJcbmV4cG9ydCBjbGFzcyBTYXZlTW9kYWwgZXh0ZW5kcyBNb2RhbCB7XHJcbiAgcmVzdWx0OiBzdHJpbmc7XHJcbiAgb25TdWJtaXQ6IChyZXN1bHQ6IHN0cmluZykgPT4gdm9pZDtcclxuXHJcbiAgY29uc3RydWN0b3IoYXBwOiBBcHAsIG9uU3VibWl0OiAocmVzdWx0OiBzdHJpbmcpID0+IHZvaWQpIHtcclxuICAgIHN1cGVyKGFwcCk7XHJcbiAgICB0aGlzLm9uU3VibWl0ID0gb25TdWJtaXQ7XHJcbiAgfVxyXG5cclxuICBvbk9wZW4oKSB7XHJcbiAgICBjb25zdCB7IGNvbnRlbnRFbCB9ID0gdGhpcztcclxuXHJcbiAgICBjb250ZW50RWwuY3JlYXRlRWwoXCJoMVwiLCB7IHRleHQ6IFwiU2F2ZSBhc1wiIH0pO1xyXG5cclxuICAgIG5ldyBTZXR0aW5nKGNvbnRlbnRFbClcclxuICAgICAgLnNldE5hbWUoXCJGaWxlIG5hbWU6IFwiKVxyXG4gICAgICAuYWRkVGV4dCgodGV4dCkgPT5cclxuICAgICAgICB0ZXh0Lm9uQ2hhbmdlKCh2YWx1ZSkgPT4ge1xyXG4gICAgICAgICAgdGhpcy5yZXN1bHQgPSB2YWx1ZVxyXG4gICAgICAgIH0pKTtcclxuXHJcbiAgICBuZXcgU2V0dGluZyhjb250ZW50RWwpXHJcbiAgICAgIC5hZGRCdXR0b24oKGJ0bikgPT5cclxuICAgICAgICBidG5cclxuICAgICAgICAgIC5zZXRCdXR0b25UZXh0KFwiR2VuZXJhdGUgbWFya2Rvd24gbm90ZVwiKVxyXG4gICAgICAgICAgLnNldEN0YSgpXHJcbiAgICAgICAgICAub25DbGljaygoKSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgICAgICAgICAgdGhpcy5vblN1Ym1pdCh0aGlzLnJlc3VsdCk7XHJcbiAgICAgICAgICB9KSk7XHJcbiAgfVxyXG5cclxuICBvbkNsb3NlKCkge1xyXG4gICAgbGV0IHsgY29udGVudEVsIH0gPSB0aGlzO1xyXG4gICAgY29udGVudEVsLmVtcHR5KCk7XHJcbiAgfVxyXG59XHJcbiIsICJpbXBvcnQgeyBBcHAgfSBmcm9tICdvYnNpZGlhbic7XHJcbmltcG9ydCB7IExpbmtUcmVlVHlwZSB9IGZyb20gJy4uL3ZpZXdzL2dlbmVyYXRlLW1hcmtkb3duJztcclxuaW1wb3J0IHtcclxuXHRMaW5rLCBDaGVja2JveFxyXG59IGZyb20gJy4vaW5kZXgnO1xyXG5cclxuXHJcbmZ1bmN0aW9uIGZsYXR0ZW5DaGlsZHJlbihsaW5rOiBMaW5rVHJlZVR5cGUsIGNoaWxkcmVuOiBzdHJpbmdbXSkge1xyXG5cdGlmICgnY2hpbGRyZW4nIGluIGxpbmspIHtcclxuXHRcdGNvbnN0IGNoaWxkcmVuTGlua05hbWVzID0gbGluay5jaGlsZHJlbi5tYXAoKGw6IExpbmtUcmVlVHlwZSkgPT4gbC5uYW1lKTsgXHJcblx0XHRjaGlsZHJlbi5wdXNoKC4uLmNoaWxkcmVuTGlua05hbWVzKTtcclxuXHRcdGxpbmsuY2hpbGRyZW4uZm9yRWFjaCgobDogTGlua1RyZWVUeXBlKSA9PiB7XHJcblx0XHRcdGZsYXR0ZW5DaGlsZHJlbihsLCBjaGlsZHJlbik7XHJcblx0XHR9KVxyXG5cdH1cclxuXHRyZXR1cm4gY2hpbGRyZW47XHJcbn1cclxuXHJcbmV4cG9ydCBjbGFzcyBUcmVlTWVudSB7XHJcblx0YXBwOiBBcHA7XHJcblx0VUw6IEVsZW1lbnQ7XHJcblxyXG5cdGlnbm9yZWRMaW5rczogc3RyaW5nW10gPSBbXTtcclxuXHRsaW5rc1RyZWU6IExpbmtUcmVlVHlwZVtdID0gW107XHJcblxyXG5cdGNvbnN0cnVjdG9yKGFwcDogQXBwLCBzdHJ1Y3R1cmU6IEVsZW1lbnQsIGxpbmtzVHJlZTogTGlua1RyZWVUeXBlW10sIGV2ZW50OiAoaWdub3JlZExpbmtzOiBzdHJpbmdbXSkgPT4gdm9pZCkge1xyXG5cdFx0dGhpcy5hcHAgPSBhcHA7XHJcblx0XHRsZXQgbWVudSA9IHN0cnVjdHVyZS5jcmVhdGVFbCgnZGl2JywgeyBjbHM6ICd0cmVlLW1lbnUnfSk7XHJcblx0XHR0aGlzLlVMID0gbWVudS5jcmVhdGVFbCgndWwnKTtcclxuXHRcdHRoaXMubGlua3NUcmVlID0gbGlua3NUcmVlO1xyXG5cclxuXHRcdHRoaXMucmVuZGVyKHRoaXMubGlua3NUcmVlLCB0aGlzLlVMLCBbXSwgZXZlbnQpO1xyXG5cdH1cclxuXHJcblx0cmVuZGVyKGxpbmtzOiBMaW5rVHJlZVR5cGVbXSwgbWVudUVsOiBFbGVtZW50LCBjaGlsZHJlbkxpbmtzOiBzdHJpbmdbXSwgZXZlbnQ6IChsaW5rczogc3RyaW5nW10pID0+IHZvaWQpIHtcclxuXHRcdGlmICghY2hpbGRyZW5MaW5rcykgXHJcblx0XHRcdGNoaWxkcmVuTGlua3MgPSBbXTtcclxuXHJcblx0XHRsaW5rcy5mb3JFYWNoKChsaW5rOiBMaW5rVHJlZVR5cGUpID0+IHtcclxuXHRcdFx0Y29uc3QgbGkgPSBtZW51RWwuY3JlYXRlRWwoJ2xpJyk7XHJcblx0XHRcdGNvbnN0IGxpbmtFbCA9IG5ldyBMaW5rKHRoaXMuYXBwLCBsaSwgbGluaywgZmFsc2UpO1xyXG5cclxuXHRcdFx0bGV0IHN0YXRlOiBib29sZWFuID0gIWNoaWxkcmVuTGlua3MuaW5jbHVkZXMobGlua0VsLmxpbmsubmFtZSk7XHJcblxyXG5cdFx0XHRpZiAoIWxpbmsuZXhpc3RzKVxyXG5cdFx0XHRcdHN0YXRlID0gZmFsc2U7IFxyXG5cclxuXHRcdFx0bmV3IENoZWNrYm94KGxpLCBzdGF0ZSwgbGluay5leGlzdHMsICgpID0+IHtcclxuXHRcdFx0XHRjb25zdCBjaGlsZHJlbiA9IFtsaW5rRWwubGluay5uYW1lLCAuLi5mbGF0dGVuQ2hpbGRyZW4obGlua0VsLmxpbmssIFtdKV07XHJcblx0XHRcdFx0Y29uc29sZS5sb2coXCJmbGF0dGVuXCIsIGNoaWxkcmVuKTtcclxuXHRcdFx0XHRpZiAoc3RhdGUgPT0gZmFsc2UpIHsgXHJcblx0XHRcdFx0XHQvLyByZW1vdmUgY2hpbGRyZW4gZnJvbSBjaGlsZHJlbkxpbmtzXHJcblx0XHRcdFx0XHRjaGlsZHJlbkxpbmtzID0gY2hpbGRyZW5MaW5rcy5maWx0ZXIoKGNsOiBzdHJpbmcpID0+ICFjaGlsZHJlbi5pbmNsdWRlcyhjbCkpO1xyXG5cdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHRjaGlsZHJlbkxpbmtzLnB1c2goLi4uY2hpbGRyZW4pO1xyXG5cdFx0XHRcdFx0XHJcblx0XHRcdFx0XHQvLyByZW1vdmUgZHVwZXNcclxuXHRcdFx0XHRcdGNoaWxkcmVuTGlua3MgPSBbLi4ubmV3IFNldChjaGlsZHJlbkxpbmtzKV1cclxuXHRcdFx0XHR9XHJcblxyXG5cdFx0XHRcdHRoaXMuaWdub3JlZExpbmtzID0gY2hpbGRyZW5MaW5rcztcclxuXHRcdFx0XHRcclxuXHRcdFx0XHQvLyBjbGVhbnVwIGFuZCByZXJlbmRlclxyXG5cdFx0XHRcdHRoaXMuVUwuZW1wdHkoKTtcclxuXHRcdFx0XHR0aGlzLnJlbmRlcih0aGlzLmxpbmtzVHJlZSwgdGhpcy5VTCwgY2hpbGRyZW5MaW5rcywgZXZlbnQpO1xyXG5cdFx0XHR9KTtcclxuXHJcblx0XHRcdGxpbmtFbC5yZW5kZXIoc3RhdGUpO1xyXG5cclxuXHRcdFx0aWYgKCdjaGlsZHJlbicgaW4gbGluaykge1xyXG5cdFx0XHRcdGNvbnN0IHVsID0gbGkuY3JlYXRlRWwoJ3VsJyk7XHJcblx0XHRcdFx0dGhpcy5yZW5kZXIobGluay5jaGlsZHJlbiwgdWwsIGNoaWxkcmVuTGlua3MsIGV2ZW50KTtcclxuXHRcdFx0fVxyXG5cdFx0fSk7XHJcblxyXG5cdFx0cmV0dXJuIGV2ZW50KHRoaXMuaWdub3JlZExpbmtzKTtcclxuXHR9XHJcbn1cclxuIiwgImV4cG9ydCBjbGFzcyBDaGVja2JveCB7XHJcblxyXG5cdGNiOiBIVE1MSW5wdXRFbGVtZW50O1xyXG5cdGNvbnN0cnVjdG9yKGVsZW1lbnQ6IEVsZW1lbnQsIHN0YXRlOiBib29sZWFuLCBleGlzdHM6IGJvb2xlYW4sIG9uQ2xpY2s6IChjb250ZXh0OiBDaGVja2JveCkgPT4gdm9pZCkge1xyXG5cdFx0dGhpcy5jYiA9IGVsZW1lbnQuY3JlYXRlRWwoXCJpbnB1dFwiLCB7XHJcblx0XHRcdHR5cGU6ICdjaGVja2JveCcsXHJcblx0XHRcdGNsczogJ2NoZWNrYm94LWJ0bidcclxuXHRcdH0pO1xyXG5cclxuXHRcdHRoaXMuY2IuY2hlY2tlZCA9IHN0YXRlO1xyXG5cclxuXHRcdGlmICghZXhpc3RzKSB7XHJcblx0XHRcdHRoaXMuY2IuZGlzYWJsZWQgPSB0cnVlO1xyXG5cdFx0XHR0aGlzLmNiLmNoZWNrZWQgPSBmYWxzZTtcclxuXHRcdFx0dGhpcy5jYi5hZGRDbGFzcygnY2hlY2tib3gtYnRuLWRpc2FibGVkJyk7XHJcblx0XHR9XHJcblx0XHR0aGlzLmNiLm9uY2xpY2sgPSAoKSA9PiB7XHJcblx0XHRcdG9uQ2xpY2sodGhpcyk7XHJcblx0XHR9O1x0XHJcblx0XHRyZXR1cm4gdGhpcztcclxuXHR9XHJcbn1cclxuIl0sCiAgIm1hcHBpbmdzIjogIjs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUE7QUFB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
