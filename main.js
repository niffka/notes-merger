/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// main.ts
var main_exports = {};
__export(main_exports, {
  default: () => GenerateMarkdownPlugin
});
module.exports = __toCommonJS(main_exports);
var import_obsidian3 = require("obsidian");

// src/views/generate-markdown.ts
var import_obsidian2 = require("obsidian");

// src/utils.ts
var import_fs = require("fs");
var fixSpaceInName = (name) => {
  return name.replace(/[\u00A0\u1680\u180E\u2000-\u200B\u202F\u205F\u3000\uFEFF]/, " ").trim();
};
var getNoteByName = (name, loadedFiles) => {
  const loadedFile = loadedFiles.find((file) => file.basename === name);
  const fullPath = app.vault.adapter.getFullPath(name);
  if (!loadedFile)
    return "";
  const absolutePath = fullPath.replace(name, loadedFile.path.replace("/", "\\"));
  const note = (0, import_fs.readFileSync)(absolutePath, { encoding: "utf8" });
  return note;
};

// src/components/Button.ts
var Button = class {
  constructor(element, text, onClick, args) {
    this.btn = element.createEl("button", { text, ...args });
    this.btn.onclick = () => {
      onClick(this);
    };
    return this;
  }
};

// src/components/Link.ts
var BaseLink = class {
  constructor(context, element, name) {
    this.context = context;
    this.element = element;
    this.name = name;
    this.render();
  }
  render() {
    const hrefTitle = this.element.createEl("a", { text: this.name, cls: "cont__title" });
    hrefTitle.onclick = () => {
      this.context.workspace.openLinkText(this.name, "");
    };
  }
};
var Link = class {
  constructor(context, element, link, renderNow = true) {
    this.toggledState = false;
    this.link = link;
    this.context = context;
    this.element = element;
    if (renderNow)
      this.render(false);
    return this;
  }
  render(state) {
    this.a = this.element.createEl("a", { text: this.link.name, cls: "link" });
    !this.link.exists && this.a.addClass("cont__link-not-exist");
    this.link.inline && this.a.addClass("inline");
    this.a.onclick = () => {
      this.context.workspace.openLinkText(this.link.name, "");
      !this.link.exists && this.a.removeClass("cont__link-not-exist");
    };
    this.toggle(state);
  }
  toggle(state) {
    if (state)
      this.a.removeClass("strikethrough");
    else
      this.a.addClass("strikethrough");
  }
};

// src/components/SaveModal.ts
var import_obsidian = require("obsidian");
var SaveModal = class extends import_obsidian.Modal {
  constructor(app2, onSubmit) {
    super(app2);
    this.onSubmit = onSubmit;
  }
  onOpen() {
    const { contentEl } = this;
    contentEl.createEl("h1", { text: "Save as" });
    new import_obsidian.Setting(contentEl).setName("File name: ").addText((text) => text.onChange((value) => {
      this.result = value;
    }));
    new import_obsidian.Setting(contentEl).addButton((btn) => btn.setButtonText("Generate markdown note").setCta().onClick(() => {
      this.close();
      this.onSubmit(this.result);
    }));
  }
  onClose() {
    let { contentEl } = this;
    contentEl.empty();
  }
};

// src/components/TreeMenu.ts
function flattenChildren(link, children) {
  if ("children" in link) {
    const childrenLinkNames = link.children.map((l) => l.name);
    children.push(...childrenLinkNames);
    link.children.forEach((l) => {
      flattenChildren(l, children);
    });
  }
  return children;
}
var TreeMenu = class {
  constructor(app2, structure, linksTree, event) {
    this.ignoredLinks = [];
    this.linksTree = [];
    this.app = app2;
    let menu = structure.createEl("div", { cls: "tree-menu" });
    this.UL = menu.createEl("ul");
    this.linksTree = linksTree;
    this.render(this.linksTree, this.UL, [], event);
  }
  render(links, menuEl, childrenLinks, event) {
    if (!childrenLinks)
      childrenLinks = [];
    links.forEach((link) => {
      const li = menuEl.createEl("li");
      const linkEl = new Link(this.app, li, link, false);
      let state = !childrenLinks.includes(linkEl.link.name);
      if (!link.exists)
        state = false;
      new Checkbox(li, state, link.exists, () => {
        const children = [linkEl.link.name, ...flattenChildren(linkEl.link, [])];
        console.log("flatten", children);
        if (state == false) {
          childrenLinks = childrenLinks.filter((cl) => !children.includes(cl));
        } else {
          childrenLinks.push(...children);
          childrenLinks = [...new Set(childrenLinks)];
        }
        this.ignoredLinks = childrenLinks;
        this.UL.empty();
        this.render(this.linksTree, this.UL, childrenLinks, event);
      });
      linkEl.render(state);
      if ("children" in link) {
        const ul = li.createEl("ul");
        this.render(link.children, ul, childrenLinks, event);
      }
    });
    return event(this.ignoredLinks);
  }
};

// src/components/Checkbox.ts
var Checkbox = class {
  constructor(element, state, exists, onClick) {
    this.cb = element.createEl("input", {
      type: "checkbox",
      cls: "checkbox-btn"
    });
    this.cb.checked = state;
    if (!exists) {
      this.cb.disabled = true;
      this.cb.checked = false;
      this.cb.addClass("checkbox-btn-disabled");
    }
    this.cb.onclick = () => {
      onClick(this);
    };
    return this;
  }
};

// src/views/generate-markdown.ts
var VIEW_CONTENT_COMPOSE_NOTES = "view-generate-markdown";
var _GenerateMarkdown = class extends import_obsidian2.ItemView {
  constructor(leaf, settings) {
    super(leaf);
    this.linksTree = [];
    this.loadedFiles = [];
    this.maxLevel = 0;
    this.processed = [];
    this.mainNameLinks = [];
    this.markdown = "";
    this.ignoredLinks = [];
    this.images = [];
    this.settings = settings;
  }
  async onOpen() {
    const container = this.containerEl.children[1];
    this.container = container;
    container.empty();
    this.toolbar = container.createEl("div");
    this.generatePreviewParent = this.toolbar.createEl("span");
    this.generateMarkdownParent = this.toolbar.createEl("span");
    this.structure = this.container.createEl("div");
    new Button(this.generatePreviewParent, "Generate preview", () => {
      this.linksTree = [];
      this.maxLevel = 0;
      this.processed = [];
      this.mainNameLinks = [];
      this.ignoredLinks = [];
      this.markdown = "";
      this.structure.empty();
      this.generateMarkdownParent.empty();
      this.readSelectedNote();
    });
  }
  parseLinks(text, index = false) {
    const links = text.matchAll(/\[\[(.*?)\]\]/g);
    let cleanLinks = [...links].map((l) => l[1]);
    cleanLinks = [...new Set(cleanLinks)];
    cleanLinks = cleanLinks.filter((cl) => !cl.startsWith("#"));
    const existingNotes = cleanLinks.map((cl) => {
      cl = fixSpaceInName(cl);
      if (!!_GenerateMarkdown.imageTypes.filter((it) => cl.includes(it.toLowerCase())).length) {
        this.images.push(cl);
        return false;
      }
      let isInline = true;
      if (text.includes(this.settings.listOfLinksKeyword)) {
        let [inlineText, linksText] = text.split(this.settings.listOfLinksKeyword);
        if (!inlineText.includes(cl))
          isInline = false;
      }
      let isIndex = false;
      if (index) {
        isInline = false;
        isIndex = true;
      }
      const note = this.loadedFiles.find((f) => f["basename"] === cl);
      return {
        name: cl,
        exists: !!note,
        inline: isInline,
        index: isIndex
      };
    }).filter(Boolean);
    return existingNotes;
  }
  readSelectedNote() {
    this.loadedFiles = app.vault.getAllLoadedFiles();
    const activeNote = this.app.workspace.getActiveFile();
    if (!activeNote) {
      new import_obsidian2.Notice(`Selected note is invalid.`);
      throw new Error("Selected note is invalid.");
    }
    const activeNoteText = getNoteByName(activeNote.basename, this.loadedFiles);
    const mainContentLinks = this.parseLinks(activeNoteText, true);
    this.mainNameLinks = mainContentLinks.map((l) => l.name);
    this.linksTree = this.generateNotesHierarchy(mainContentLinks);
    const title = activeNote.basename;
    new BaseLink(this.app, this.structure, title);
    new TreeMenu(this.app, this.structure, this.linksTree, (ignoredLinks) => {
      this.ignoredLinks = ignoredLinks;
    });
    new Button(this.generateMarkdownParent, "Generate markdown", () => {
      this.markdown = "";
      this.generateMarkdownFile(this.linksTree, activeNoteText);
    }, { cls: "generate-markdown-btn" });
  }
  generateMarkdownFile(links, mainNote) {
    this.composeMarkdown(links);
    this.mainNameLinks.forEach((mnl) => {
      mainNote = mainNote.replaceAll(`[[${mnl}]]`, `[[#${mnl}]]`);
    });
    this.markdown = mainNote + this.markdown;
    new SaveModal(this.app, (fileName) => {
      this.app.vault.adapter.write(`${fileName}.md`, this.markdown).then(() => {
        new import_obsidian2.Notice(`Note ${fileName} created successfully`);
        this.app.workspace.openLinkText(`${fileName}.md`, "");
      });
    }).open();
  }
  composeMarkdown(links) {
    links.forEach((link) => {
      let note = getNoteByName(link.name, this.loadedFiles);
      const localLinks = this.parseLinks(note);
      if (this.ignoredLinks.includes(link.name))
        return;
      note = note.trim();
      if (note.length == 0)
        return;
      localLinks.forEach((localLink) => {
        if (localLink.inline && this.ignoredLinks.includes(localLink.name))
          note = note.replaceAll(`[[${localLink.name}]]`, localLink.name);
        else
          note = note.replaceAll(`[[${localLink.name}]]`, `[[#${localLink.name}]]`);
      });
      let noteRows = note.split("\n");
      let firstRow = fixSpaceInName(noteRows[0]);
      if (firstRow.includes(`# ${link.name}`)) {
        noteRows.shift();
        note = noteRows.join("\n").trim();
      }
      noteRows = note.split("\n");
      note = noteRows.map((noteRow) => {
        const match = noteRow.match(/# (\w+)/);
        if (match)
          return `**${match[1]}**`;
        return noteRow;
      }).join("\n");
      if (note.includes(this.settings.listOfLinksKeyword)) {
        let [importantPart, endPart] = note.split(this.settings.listOfLinksKeyword);
        note = importantPart.trim();
      }
      let title = "";
      if (link.inline) {
        title = `##### ${link.name}`;
      } else {
        const nestedLevel = Array(link.level).fill("#").join("");
        title = `${nestedLevel} ${link.name}`;
      }
      note = `

${title}
${note}`;
      this.markdown += note;
      if ("children" in link)
        this.composeMarkdown(link.children);
    });
  }
  dfs(links, level, parentRef, titleMapping) {
    titleMapping = titleMapping != null ? titleMapping : {};
    links.forEach((link, order) => {
      if (this.mainNameLinks.includes(link.name) && level != 0)
        return;
      if (this.processed.includes(link.name))
        return;
      this.processed.push(link.name);
      const note = getNoteByName(link.name, this.loadedFiles);
      const subLinks = this.parseLinks(note);
      this.maxLevel = level + 1;
      titleMapping[link.name] = { ...link, parentRef, level: this.maxLevel, order };
      if (subLinks.length > 0) {
        this.dfs(subLinks, this.maxLevel, titleMapping[link.name], titleMapping);
      }
    });
    return titleMapping;
  }
  generateNotesHierarchy(links) {
    const linksObj = this.dfs(links, 0);
    console.log("linkobj", linksObj);
    let linksArr = [];
    Object.keys(linksObj).forEach((key) => {
      var _a, _b;
      const { parentRef, ...rest } = linksObj[key];
      linksArr.push({ ...rest, parent: (_b = (_a = linksObj[key]) == null ? void 0 : _a.parentRef) == null ? void 0 : _b.name });
    });
    console.log("LA", linksArr);
    let maxDepth = Number(this.settings.slidesDepth);
    function getChildren(parent) {
      console.log("depth", startDepth);
      let children = linksArr.filter((child) => child.parent === parent.name);
      console.log("children", children);
      if (startDepth <= maxDepth) {
        children.forEach((child) => {
          slidesList += "\n" + "#".repeat(startDepth) + child.name;
          if (startDepth != maxDepth) {
            startDepth += 1;
            getChildren(child);
          } else {
            console.log("\u010Daau");
            return;
          }
          startDepth -= 1;
        });
      }
    }
    let slidesList = "";
    let slides = linksArr.filter((link) => link.level === 1);
    console.log("SLIDES", slides);
    let startDepth;
    slides.forEach((slide) => {
      startDepth = 2;
      slidesList += "\n #" + slide.name;
      getChildren(slide);
    });
    console.log("slideList", slidesList);
    const createChildrenFromParent = (arr, parent) => {
      let childrenArr = [];
      for (let i = 0; i < arr.length; i++) {
        if (arr[i].parent == parent) {
          const children = createChildrenFromParent(arr, arr[i].name);
          if (children.length) {
            arr[i].children = children;
          }
          childrenArr.push(arr[i]);
        }
      }
      return childrenArr;
    };
    return createChildrenFromParent(linksArr, void 0);
  }
  async onClose() {
  }
  getViewType() {
    return VIEW_CONTENT_COMPOSE_NOTES;
  }
  getDisplayText() {
    return "Notes Merger";
  }
};
var GenerateMarkdown = _GenerateMarkdown;
GenerateMarkdown.imageTypes = ["jpg", "jpeg", "png", "gif", "webp", "tiff", "bmp"].map((it) => `.${it}`);

// main.ts
var DEFAULT_SETTINGS = {
  listOfLinksKeyword: "Kam d\xE1l",
  literatureNote: "Literature",
  slidesDepth: "2"
};
var GenerateMarkdownPlugin = class extends import_obsidian3.Plugin {
  async onload() {
    await this.loadSettings();
    this.addSettingTab(new GenerateMarkdownPluginSettingTab(this.app, this));
    this.registerView(VIEW_CONTENT_COMPOSE_NOTES, (leaf) => new GenerateMarkdown(leaf, this.settings));
    this.addRibbonIcon("scroll", "NotesMerger", () => {
      this.activateGenerateMarkdownView();
    });
  }
  async activateGenerateMarkdownView() {
    this.app.workspace.detachLeavesOfType(VIEW_CONTENT_COMPOSE_NOTES);
    await this.app.workspace.getRightLeaf(false).setViewState({
      type: VIEW_CONTENT_COMPOSE_NOTES,
      active: true
    });
    this.app.workspace.revealLeaf(this.app.workspace.getLeavesOfType(VIEW_CONTENT_COMPOSE_NOTES)[0]);
  }
  onunload() {
    this.app.workspace.detachLeavesOfType(VIEW_CONTENT_COMPOSE_NOTES);
  }
  async loadSettings() {
    this.settings = Object.assign({}, DEFAULT_SETTINGS, await this.loadData());
  }
  async saveSettings() {
    await this.saveData(this.settings);
  }
};
var GenerateMarkdownPluginSettingTab = class extends import_obsidian3.PluginSettingTab {
  constructor(app2, plugin) {
    super(app2, plugin);
    this.plugin = plugin;
  }
  display() {
    const { containerEl } = this;
    containerEl.empty();
    containerEl.createEl("h2", { text: "Settings" });
    new import_obsidian3.Setting(containerEl).setName("List of links keyword").setDesc("Keyword to detect list of links at the end of note").addText((text) => text.setPlaceholder('Defaults to "Kam d\xE1l"').setValue(this.plugin.settings.listOfLinksKeyword).onChange(async (value) => {
      this.plugin.settings.listOfLinksKeyword = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian3.Setting(containerEl).setName("Depth of slides").setDesc("How many layer are gonna be created into slides.").addText((text) => text.setPlaceholder("Default is 2 layers.").setValue(this.plugin.settings.slidesDepth).onChange(async (value) => {
      this.plugin.settings.slidesDepth = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian3.Setting(containerEl).setName("Literature note").setDesc("Name of note with citations").addText((text) => text.setPlaceholder('Defaults to "Literature"').setValue(this.plugin.settings.literatureNote).onChange(async (value) => {
      this.plugin.settings.literatureNote = value;
      await this.plugin.saveSettings();
    }));
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsibWFpbi50cyIsICJzcmMvdmlld3MvZ2VuZXJhdGUtbWFya2Rvd24udHMiLCAic3JjL3V0aWxzLnRzIiwgInNyYy9jb21wb25lbnRzL0J1dHRvbi50cyIsICJzcmMvY29tcG9uZW50cy9MaW5rLnRzIiwgInNyYy9jb21wb25lbnRzL1NhdmVNb2RhbC50cyIsICJzcmMvY29tcG9uZW50cy9UcmVlTWVudS50cyIsICJzcmMvY29tcG9uZW50cy9DaGVja2JveC50cyJdLAogICJzb3VyY2VzQ29udGVudCI6IFsiaW1wb3J0IHsgQXBwLCBQbHVnaW4sIFBsdWdpblNldHRpbmdUYWIsIFNldHRpbmcgfSBmcm9tICdvYnNpZGlhbic7XHJcbmltcG9ydCB7IEdlbmVyYXRlTWFya2Rvd24sIFZJRVdfQ09OVEVOVF9DT01QT1NFX05PVEVTIH0gZnJvbSAnLi9zcmMvdmlld3MvZ2VuZXJhdGUtbWFya2Rvd24nO1xyXG5cclxuZXhwb3J0IGludGVyZmFjZSBHZW5lcmF0ZU1hcmtkb3duUGx1Z2luU2V0dGluZ3NUeXBlIHtcclxuXHRsaXN0T2ZMaW5rc0tleXdvcmQ6IHN0cmluZztcclxuXHRsaXRlcmF0dXJlTm90ZTogc3RyaW5nO1xyXG5cdHNsaWRlc0RlcHRoOiBzdHJpbmc7XHJcbn1cclxuXHJcbmNvbnN0IERFRkFVTFRfU0VUVElOR1M6IEdlbmVyYXRlTWFya2Rvd25QbHVnaW5TZXR0aW5nc1R5cGUgPSB7XHJcblx0bGlzdE9mTGlua3NLZXl3b3JkOiAnS2FtIGRcdTAwRTFsJyxcclxuXHRsaXRlcmF0dXJlTm90ZTogJ0xpdGVyYXR1cmUnLFxyXG5cdHNsaWRlc0RlcHRoOiAnMicsXHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEdlbmVyYXRlTWFya2Rvd25QbHVnaW4gZXh0ZW5kcyBQbHVnaW4ge1xyXG5cdHNldHRpbmdzOiBHZW5lcmF0ZU1hcmtkb3duUGx1Z2luU2V0dGluZ3NUeXBlO1xyXG5cclxuXHRhc3luYyBvbmxvYWQoKSB7XHJcblx0XHRhd2FpdCB0aGlzLmxvYWRTZXR0aW5ncygpO1xyXG5cclxuXHRcdHRoaXMuYWRkU2V0dGluZ1RhYihuZXcgR2VuZXJhdGVNYXJrZG93blBsdWdpblNldHRpbmdUYWIodGhpcy5hcHAsIHRoaXMpKTtcdFxyXG5cclxuXHRcdHRoaXMucmVnaXN0ZXJWaWV3KFxyXG5cdFx0XHRWSUVXX0NPTlRFTlRfQ09NUE9TRV9OT1RFUyxcclxuXHRcdFx0KGxlYWYpID0+IG5ldyBHZW5lcmF0ZU1hcmtkb3duKGxlYWYsIHRoaXMuc2V0dGluZ3MpXHJcblx0XHQpO1xyXG5cdFx0XHJcblx0XHR0aGlzLmFkZFJpYmJvbkljb24oXCJzY3JvbGxcIiwgXCJOb3Rlc01lcmdlclwiLCAoKSA9PiB7XHJcblx0XHRcdHRoaXMuYWN0aXZhdGVHZW5lcmF0ZU1hcmtkb3duVmlldygpO1xyXG5cdFx0fSk7XHJcblx0fVxyXG5cclxuXHRhc3luYyBhY3RpdmF0ZUdlbmVyYXRlTWFya2Rvd25WaWV3KCkge1xyXG5cdFx0dGhpcy5hcHAud29ya3NwYWNlLmRldGFjaExlYXZlc09mVHlwZShWSUVXX0NPTlRFTlRfQ09NUE9TRV9OT1RFUyk7XHJcblx0XHJcblx0XHRhd2FpdCB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0UmlnaHRMZWFmKGZhbHNlKS5zZXRWaWV3U3RhdGUoe1xyXG5cdFx0ICB0eXBlOiBWSUVXX0NPTlRFTlRfQ09NUE9TRV9OT1RFUyxcclxuXHRcdCAgYWN0aXZlOiB0cnVlLFxyXG5cdFx0fSk7XHJcblx0XHJcblx0XHR0aGlzLmFwcC53b3Jrc3BhY2UucmV2ZWFsTGVhZihcclxuXHRcdCAgdGhpcy5hcHAud29ya3NwYWNlLmdldExlYXZlc09mVHlwZShWSUVXX0NPTlRFTlRfQ09NUE9TRV9OT1RFUylbMF1cclxuXHRcdCk7XHJcblx0fVxyXG5cclxuXHRvbnVubG9hZCgpIHtcclxuXHRcdHRoaXMuYXBwLndvcmtzcGFjZS5kZXRhY2hMZWF2ZXNPZlR5cGUoVklFV19DT05URU5UX0NPTVBPU0VfTk9URVMpO1xyXG5cdH1cclxuXHJcblx0YXN5bmMgbG9hZFNldHRpbmdzKCkge1xyXG5cdFx0dGhpcy5zZXR0aW5ncyA9IE9iamVjdC5hc3NpZ24oe30sIERFRkFVTFRfU0VUVElOR1MsIGF3YWl0IHRoaXMubG9hZERhdGEoKSk7XHJcblx0fVxyXG5cclxuXHRhc3luYyBzYXZlU2V0dGluZ3MoKSB7XHJcblx0XHRhd2FpdCB0aGlzLnNhdmVEYXRhKHRoaXMuc2V0dGluZ3MpO1xyXG5cdH1cclxufVxyXG5cclxuY2xhc3MgR2VuZXJhdGVNYXJrZG93blBsdWdpblNldHRpbmdUYWIgZXh0ZW5kcyBQbHVnaW5TZXR0aW5nVGFiIHtcclxuXHRwbHVnaW46IEdlbmVyYXRlTWFya2Rvd25QbHVnaW47XHJcblxyXG5cdGNvbnN0cnVjdG9yKGFwcDogQXBwLCBwbHVnaW46IEdlbmVyYXRlTWFya2Rvd25QbHVnaW4pIHtcclxuXHRcdHN1cGVyKGFwcCwgcGx1Z2luKTtcclxuXHRcdHRoaXMucGx1Z2luID0gcGx1Z2luO1xyXG5cdH1cclxuXHJcblx0ZGlzcGxheSgpOiB2b2lkIHtcclxuXHJcblx0XHRjb25zdCB7IGNvbnRhaW5lckVsIH0gPSB0aGlzO1xyXG5cclxuXHRcdGNvbnRhaW5lckVsLmVtcHR5KCk7XHJcblxyXG5cdFx0Y29udGFpbmVyRWwuY3JlYXRlRWwoJ2gyJywge3RleHQ6ICdTZXR0aW5ncyd9KTtcclxuXHRcdFxyXG5cdFx0bmV3IFNldHRpbmcoY29udGFpbmVyRWwpXHJcblx0XHRcdC5zZXROYW1lKCdMaXN0IG9mIGxpbmtzIGtleXdvcmQnKVxyXG5cdFx0XHQuc2V0RGVzYygnS2V5d29yZCB0byBkZXRlY3QgbGlzdCBvZiBsaW5rcyBhdCB0aGUgZW5kIG9mIG5vdGUnKVxyXG5cdFx0XHQuYWRkVGV4dCh0ZXh0ID0+IHRleHRcclxuXHRcdFx0XHQuc2V0UGxhY2Vob2xkZXIoJ0RlZmF1bHRzIHRvIFwiS2FtIGRcdTAwRTFsXCInKVxyXG5cdFx0XHRcdC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5saXN0T2ZMaW5rc0tleXdvcmQpXHJcblx0XHRcdFx0Lm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xyXG5cdFx0XHRcdFx0dGhpcy5wbHVnaW4uc2V0dGluZ3MubGlzdE9mTGlua3NLZXl3b3JkID0gdmFsdWU7XHJcblx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuXHRcdFx0XHR9KSk7XHJcblx0XHRcclxuXHRcdG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxyXG5cdFx0LnNldE5hbWUoJ0RlcHRoIG9mIHNsaWRlcycpXHJcblx0XHQuc2V0RGVzYygnSG93IG1hbnkgbGF5ZXIgYXJlIGdvbm5hIGJlIGNyZWF0ZWQgaW50byBzbGlkZXMuJylcclxuXHRcdC5hZGRUZXh0KHRleHQgPT4gdGV4dFxyXG5cdFx0XHQuc2V0UGxhY2Vob2xkZXIoJ0RlZmF1bHQgaXMgMiBsYXllcnMuJylcclxuXHRcdFx0LnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLnNsaWRlc0RlcHRoKVxyXG5cdFx0XHQub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XHJcblx0XHRcdFx0dGhpcy5wbHVnaW4uc2V0dGluZ3Muc2xpZGVzRGVwdGggPSB2YWx1ZTtcclxuXHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuXHRcdFx0fSkpO1xyXG5cclxuXHRcdG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxyXG5cdFx0LnNldE5hbWUoJ0xpdGVyYXR1cmUgbm90ZScpXHJcblx0XHQuc2V0RGVzYygnTmFtZSBvZiBub3RlIHdpdGggY2l0YXRpb25zJylcclxuXHRcdC5hZGRUZXh0KHRleHQgPT4gdGV4dFxyXG5cdFx0XHQuc2V0UGxhY2Vob2xkZXIoJ0RlZmF1bHRzIHRvIFwiTGl0ZXJhdHVyZVwiJylcclxuXHRcdFx0LnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmxpdGVyYXR1cmVOb3RlKVxyXG5cdFx0XHQub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XHJcblx0XHRcdFx0dGhpcy5wbHVnaW4uc2V0dGluZ3MubGl0ZXJhdHVyZU5vdGUgPSB2YWx1ZTtcclxuXHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuXHRcdFx0fSkpO1xyXG5cdH1cclxufVxyXG4iLCAiaW1wb3J0IHsgSXRlbVZpZXcsIFdvcmtzcGFjZUxlYWYsIE5vdGljZSwgVEFic3RyYWN0RmlsZSwgVEZpbGUsIEFwcCwgU2V0dGluZyB9IGZyb20gXCJvYnNpZGlhblwiO1xyXG5pbXBvcnQgeyBmaXhTcGFjZUluTmFtZSwgZ2V0Tm90ZUJ5TmFtZSB9IGZyb20gJy4uL3V0aWxzJztcclxuXHJcbmltcG9ydCB7IEdlbmVyYXRlTWFya2Rvd25QbHVnaW5TZXR0aW5nc1R5cGUgfSBmcm9tICcuLi8uLi9tYWluJztcclxuXHJcbmltcG9ydCB7XHJcblx0QnV0dG9uLCBcclxuXHRCYXNlTGluayxcclxuXHRTYXZlTW9kYWwsIFxyXG5cdFRyZWVNZW51LFxyXG59IGZyb20gJy4uL2NvbXBvbmVudHMvaW5kZXgnO1xyXG5cclxuXHJcbmV4cG9ydCBjb25zdCBWSUVXX0NPTlRFTlRfQ09NUE9TRV9OT1RFUyA9IFwidmlldy1nZW5lcmF0ZS1tYXJrZG93blwiO1xyXG5cclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgTGlua1RyZWVUeXBlIHtcclxuXHRuYW1lOiBzdHJpbmc7XHJcblx0cGFyZW50Pzogc3RyaW5nIHwgdW5kZWZpbmVkO1xyXG5cdGNoaWxkcmVuOiBMaW5rVHJlZVR5cGVbXTtcclxuXHRpbmRleDogYm9vbGVhbjtcclxuXHRleGlzdHM6IGJvb2xlYW47XHJcblx0aW5saW5lOiBib29sZWFuO1xyXG5cdGxldmVsPzogbnVtYmVyO1xyXG5cdG9yZGVyPzogbnVtYmVyO1xyXG59XHJcblxyXG5pbnRlcmZhY2UgQnVpbGRMaW5rVHJlZVR5cGUgZXh0ZW5kcyBMaW5rVHJlZVR5cGV7XHJcblx0cGFyZW50UmVmPzogQnVpbGRMaW5rVHJlZVR5cGU7XHJcbn1cclxuXHJcbmV4cG9ydCBjbGFzcyBHZW5lcmF0ZU1hcmtkb3duIGV4dGVuZHMgSXRlbVZpZXcge1xyXG5cdFxyXG5cdHNldHRpbmdzOiBHZW5lcmF0ZU1hcmtkb3duUGx1Z2luU2V0dGluZ3NUeXBlO1xyXG5cclxuXHRjb250YWluZXI6IEVsZW1lbnQ7XHJcblx0dG9vbGJhcjogRWxlbWVudDtcclxuXHRzdHJ1Y3R1cmU6IEVsZW1lbnQ7XHJcblx0Z2VuZXJhdGVQcmV2aWV3UGFyZW50OiBFbGVtZW50O1xyXG5cdGdlbmVyYXRlTWFya2Rvd25QYXJlbnQ6IEVsZW1lbnQ7XHJcblxyXG5cdGxpbmtzVHJlZTogTGlua1RyZWVUeXBlW10gPSBbXTtcclxuXHRsb2FkZWRGaWxlczogVEFic3RyYWN0RmlsZVtdID0gW107XHJcblx0bWF4TGV2ZWw6IG51bWJlciA9IDA7XHJcblx0cHJvY2Vzc2VkOiBzdHJpbmdbXSA9IFtdO1xyXG5cdG1haW5OYW1lTGlua3M6IHN0cmluZ1tdID0gW107XHJcblxyXG5cdG1hcmtkb3duOiBzdHJpbmcgPSBcIlwiO1xyXG5cdGlnbm9yZWRMaW5rczogc3RyaW5nW10gPSBbXTtcclxuXHRpbWFnZXM6IHN0cmluZ1tdID0gW107XHJcblxyXG5cdHN0YXRpYyBpbWFnZVR5cGVzID0gWydqcGcnLCAnanBlZycsICdwbmcnLCAnZ2lmJywgJ3dlYnAnLCAndGlmZicsICdibXAnXS5tYXAoKGl0OiBzdHJpbmcpID0+IGAuJHtpdH1gKTtcclxuXHJcblx0Y29uc3RydWN0b3IobGVhZjogV29ya3NwYWNlTGVhZiwgc2V0dGluZ3M6IEdlbmVyYXRlTWFya2Rvd25QbHVnaW5TZXR0aW5nc1R5cGUpIHtcclxuXHRcdHN1cGVyKGxlYWYpO1xyXG5cdFx0dGhpcy5zZXR0aW5ncyA9IHNldHRpbmdzO1xyXG5cdH1cclxuXHJcblx0YXN5bmMgb25PcGVuKCkge1xyXG5cdFx0Y29uc3QgY29udGFpbmVyID0gdGhpcy5jb250YWluZXJFbC5jaGlsZHJlblsxXTtcclxuXHJcblx0XHQvL2NvbnNvbGUubG9nKHRoaXMuY29udGFpbmVyRWwpO1xyXG5cdFx0dGhpcy5jb250YWluZXIgPSBjb250YWluZXI7XHJcblx0XHRjb250YWluZXIuZW1wdHkoKTtcclxuXHJcblx0XHR0aGlzLnRvb2xiYXIgPSBjb250YWluZXIuY3JlYXRlRWwoXCJkaXZcIik7XHJcblx0XHR0aGlzLmdlbmVyYXRlUHJldmlld1BhcmVudCA9IHRoaXMudG9vbGJhci5jcmVhdGVFbCgnc3BhbicpO1xyXG5cdFx0dGhpcy5nZW5lcmF0ZU1hcmtkb3duUGFyZW50ID0gdGhpcy50b29sYmFyLmNyZWF0ZUVsKCdzcGFuJyk7XHJcblx0XHR0aGlzLnN0cnVjdHVyZSA9IHRoaXMuY29udGFpbmVyLmNyZWF0ZUVsKFwiZGl2XCIpO1xyXG5cclxuXHRcdG5ldyBCdXR0b24odGhpcy5nZW5lcmF0ZVByZXZpZXdQYXJlbnQsICdHZW5lcmF0ZSBwcmV2aWV3JywgKCkgPT4ge1xyXG5cdFx0XHQvLyBlbXB0eSBzdGF0ZVxyXG5cdFx0XHR0aGlzLmxpbmtzVHJlZSA9IFtdO1xyXG5cdFx0XHR0aGlzLm1heExldmVsID0gMDtcclxuXHRcdFx0dGhpcy5wcm9jZXNzZWQgPSBbXTtcclxuXHRcdFx0dGhpcy5tYWluTmFtZUxpbmtzID0gW107XHJcblx0XHRcdHRoaXMuaWdub3JlZExpbmtzID0gW107XHJcblx0XHRcdHRoaXMubWFya2Rvd24gPSBcIlwiO1xyXG5cdFx0XHRcclxuXHRcdFx0dGhpcy5zdHJ1Y3R1cmUuZW1wdHkoKTtcclxuXHRcdFx0dGhpcy5nZW5lcmF0ZU1hcmtkb3duUGFyZW50LmVtcHR5KCk7XHJcblx0XHRcdHRoaXMucmVhZFNlbGVjdGVkTm90ZSgpO1xyXG5cdFx0fSk7XHJcblx0fVxyXG5cclxuXHRwYXJzZUxpbmtzKHRleHQ6IHN0cmluZywgaW5kZXg6IGJvb2xlYW4gPSBmYWxzZSkge1xyXG5cdFx0Y29uc3QgbGlua3MgPSB0ZXh0Lm1hdGNoQWxsKC9cXFtcXFsoLio/KVxcXVxcXS9nKTtcclxuXHRcdC8vY29uc29sZS5sb2coWy4uLmxpbmtzXSk7XHJcblx0XHRsZXQgY2xlYW5MaW5rcyA9IFsuLi5saW5rc10ubWFwKGwgPT4gbFsxXSk7XHJcblxyXG5cdFx0Y2xlYW5MaW5rcyA9IFsuLi5uZXcgU2V0KGNsZWFuTGlua3MpXTtcclxuXHJcblx0XHQvLyBmaWx0ZXIgb3V0IGFuY2hvciBsaW5rcyAoW1sjZm9vYmFyXV0pXHJcblx0XHRjbGVhbkxpbmtzID0gY2xlYW5MaW5rcy5maWx0ZXIoY2wgPT4gIWNsLnN0YXJ0c1dpdGgoJyMnKSk7XHJcblxyXG5cdFx0Y29uc3QgZXhpc3RpbmdOb3RlcyA9IGNsZWFuTGlua3MubWFwKChjbDogc3RyaW5nKSA9PiB7XHJcblx0XHRcdFxyXG5cdFx0XHRjbCA9IGZpeFNwYWNlSW5OYW1lKGNsKTtcclxuXHJcblx0XHRcdGlmICghIUdlbmVyYXRlTWFya2Rvd24uaW1hZ2VUeXBlcy5maWx0ZXIoKGl0OiBzdHJpbmcpID0+IGNsLmluY2x1ZGVzKGl0LnRvTG93ZXJDYXNlKCkpKS5sZW5ndGgpIHtcclxuXHRcdFx0XHR0aGlzLmltYWdlcy5wdXNoKGNsKVxyXG5cdFx0XHRcdHJldHVybiBmYWxzZTtcclxuXHRcdFx0fVxyXG5cclxuXHRcdFx0bGV0IGlzSW5saW5lID0gdHJ1ZTtcdFx0XHRcclxuXHRcdFx0aWYgKHRleHQuaW5jbHVkZXModGhpcy5zZXR0aW5ncy5saXN0T2ZMaW5rc0tleXdvcmQpKSB7XHJcblx0XHRcdFx0bGV0IFtpbmxpbmVUZXh0LCBsaW5rc1RleHRdID0gdGV4dC5zcGxpdCh0aGlzLnNldHRpbmdzLmxpc3RPZkxpbmtzS2V5d29yZCk7XHJcblx0XHRcdFx0aWYgKCFpbmxpbmVUZXh0LmluY2x1ZGVzKGNsKSlcclxuXHRcdFx0XHRcdGlzSW5saW5lID0gZmFsc2U7XHJcblx0XHRcdH1cclxuXHJcblx0XHRcdGxldCBpc0luZGV4ID0gZmFsc2U7XHJcblx0XHRcdGlmIChpbmRleCkge1xyXG5cdFx0XHRcdGlzSW5saW5lID0gZmFsc2U7XHJcblx0XHRcdFx0aXNJbmRleCA9IHRydWU7XHJcblx0XHRcdH1cclxuXHJcblx0XHRcdGNvbnN0IG5vdGUgPSB0aGlzLmxvYWRlZEZpbGVzLmZpbmQoKGY6IFRGaWxlKSA9PiBmWydiYXNlbmFtZSddID09PSBjbCk7XHJcblx0XHRcdHJldHVybiB7XHJcblx0XHRcdFx0bmFtZTogY2wsXHJcblx0XHRcdFx0ZXhpc3RzOiAhIW5vdGUsXHRcclxuXHRcdFx0XHRpbmxpbmU6IGlzSW5saW5lLFxyXG5cdFx0XHRcdGluZGV4OiBpc0luZGV4XHJcblx0XHRcdH07XHJcblxyXG5cdFx0fSkuZmlsdGVyKEJvb2xlYW4pO1xyXG5cdFx0Ly9jb25zb2xlLmxvZyhleGlzdGluZ05vdGVzKTtcclxuXHRcdHJldHVybiBleGlzdGluZ05vdGVzIGFzIExpbmtUcmVlVHlwZVtdO1xyXG5cdH1cclxuXHJcblx0cmVhZFNlbGVjdGVkTm90ZSgpIHtcclxuXHRcdHRoaXMubG9hZGVkRmlsZXMgPSBhcHAudmF1bHQuZ2V0QWxsTG9hZGVkRmlsZXMoKTtcclxuXHJcblx0XHRjb25zdCBhY3RpdmVOb3RlID0gdGhpcy5hcHAud29ya3NwYWNlLmdldEFjdGl2ZUZpbGUoKTtcclxuXHJcblx0XHRpZiAoIWFjdGl2ZU5vdGUpIHtcclxuXHRcdFx0bmV3IE5vdGljZShgU2VsZWN0ZWQgbm90ZSBpcyBpbnZhbGlkLmApO1xyXG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoXCJTZWxlY3RlZCBub3RlIGlzIGludmFsaWQuXCIpO1xyXG5cdFx0fVxyXG5cclxuXHRcdGNvbnN0IGFjdGl2ZU5vdGVUZXh0ID0gZ2V0Tm90ZUJ5TmFtZShhY3RpdmVOb3RlLmJhc2VuYW1lLCB0aGlzLmxvYWRlZEZpbGVzKTtcclxuXHJcblx0XHRjb25zdCBtYWluQ29udGVudExpbmtzID0gdGhpcy5wYXJzZUxpbmtzKGFjdGl2ZU5vdGVUZXh0LCB0cnVlKTtcclxuXHJcblx0XHR0aGlzLm1haW5OYW1lTGlua3MgPSBtYWluQ29udGVudExpbmtzLm1hcCgobDogTGlua1RyZWVUeXBlKSA9PiBsLm5hbWUpO1xyXG5cclxuXHRcdHRoaXMubGlua3NUcmVlID0gdGhpcy5nZW5lcmF0ZU5vdGVzSGllcmFyY2h5KG1haW5Db250ZW50TGlua3MpO1xyXG5cdFx0Ly9jb25zb2xlLmxvZyhcInRyZWVcIiwgdGhpcy5saW5rc1RyZWUpO1xyXG5cclxuXHRcdGNvbnN0IHRpdGxlID0gYWN0aXZlTm90ZS5iYXNlbmFtZTtcclxuXHRcdG5ldyBCYXNlTGluayh0aGlzLmFwcCwgdGhpcy5zdHJ1Y3R1cmUsIHRpdGxlKTtcclxuXHJcblx0XHRuZXcgVHJlZU1lbnUodGhpcy5hcHAsIHRoaXMuc3RydWN0dXJlLCB0aGlzLmxpbmtzVHJlZSwgKGlnbm9yZWRMaW5rczogc3RyaW5nW10pID0+IHtcclxuXHRcdFx0dGhpcy5pZ25vcmVkTGlua3MgPSBpZ25vcmVkTGlua3M7XHJcblx0XHRcdC8vY29uc29sZS5sb2coXCJpZ25vcmVkXCIsaWdub3JlZExpbmtzKTtcclxuXHRcdH0pO1xyXG5cdFx0XHJcblx0XHRuZXcgQnV0dG9uKHRoaXMuZ2VuZXJhdGVNYXJrZG93blBhcmVudCwgJ0dlbmVyYXRlIG1hcmtkb3duJywgKCkgPT4ge1xyXG5cdFx0XHRcclxuXHRcdFx0Ly8gY2xlYW51cFxyXG5cdFx0XHR0aGlzLm1hcmtkb3duID0gXCJcIjtcclxuXHJcblx0XHRcdHRoaXMuZ2VuZXJhdGVNYXJrZG93bkZpbGUodGhpcy5saW5rc1RyZWUsIGFjdGl2ZU5vdGVUZXh0KTtcclxuXHRcdH0sIHsgY2xzOiAnZ2VuZXJhdGUtbWFya2Rvd24tYnRuJyB9KTtcclxuXHR9XHJcblxyXG5cdGdlbmVyYXRlTWFya2Rvd25GaWxlKGxpbmtzOiBMaW5rVHJlZVR5cGVbXSwgbWFpbk5vdGU6IHN0cmluZykge1xyXG5cdFx0dGhpcy5jb21wb3NlTWFya2Rvd24obGlua3MpO1xyXG5cclxuXHRcdC8vIHRyYW5zZm9ybSBsaW5rcyB0byBhbmNob3IgaW4gaW5kZXggbm90ZSBcclxuXHRcdHRoaXMubWFpbk5hbWVMaW5rcy5mb3JFYWNoKChtbmw6IHN0cmluZykgPT4ge1xyXG5cdFx0XHRcclxuXHRcdFx0bWFpbk5vdGUgPSBtYWluTm90ZS5yZXBsYWNlQWxsKGBbWyR7bW5sfV1dYCwgYFtbIyR7bW5sfV1dYClcclxuXHRcdH0pO1xyXG5cclxuXHRcdHRoaXMubWFya2Rvd24gPSBtYWluTm90ZSArIHRoaXMubWFya2Rvd247XHJcblxyXG5cdFx0bmV3IFNhdmVNb2RhbCh0aGlzLmFwcCwgKGZpbGVOYW1lKSA9PiB7XHJcblx0XHRcdHRoaXMuYXBwLnZhdWx0LmFkYXB0ZXIud3JpdGUoYCR7ZmlsZU5hbWV9Lm1kYCwgdGhpcy5tYXJrZG93bikudGhlbigoKSA9PiB7XHJcblx0XHRcdFx0bmV3IE5vdGljZShgTm90ZSAke2ZpbGVOYW1lfSBjcmVhdGVkIHN1Y2Nlc3NmdWxseWApO1xyXG5cdFx0XHRcdHRoaXMuYXBwLndvcmtzcGFjZS5vcGVuTGlua1RleHQoYCR7ZmlsZU5hbWV9Lm1kYCwgXCJcIilcclxuXHRcdFx0fSk7XHJcblx0XHR9KS5vcGVuKCk7XHJcblx0XHRcclxuXHR9XHJcblxyXG5cdGNvbXBvc2VNYXJrZG93bihsaW5rczogTGlua1RyZWVUeXBlW10pIHtcclxuXHRcdGxpbmtzLmZvckVhY2goKGxpbms6IExpbmtUcmVlVHlwZSkgPT4ge1xyXG5cdFx0XHRsZXQgbm90ZSA9IGdldE5vdGVCeU5hbWUobGluay5uYW1lLCB0aGlzLmxvYWRlZEZpbGVzKTtcclxuXHRcdFx0Y29uc3QgbG9jYWxMaW5rcyA9IHRoaXMucGFyc2VMaW5rcyhub3RlKTtcclxuXHJcblx0XHRcdGlmICh0aGlzLmlnbm9yZWRMaW5rcy5pbmNsdWRlcyhsaW5rLm5hbWUpKVxyXG5cdFx0XHRcdHJldHVybjtcclxuXHJcblx0XHRcdC8vIHRyaW0gZW50ZXJzIGFuZCBzcGFjZXNcclxuXHRcdFx0bm90ZSA9IG5vdGUudHJpbSgpO1xyXG5cclxuXHRcdFx0aWYgKG5vdGUubGVuZ3RoID09IDApXHJcblx0XHRcdFx0cmV0dXJuO1xyXG5cclxuXHRcdFx0Ly8gdHJhbnNmb3JtIGxpbmtzIHRvIGFuY2hvcnNcclxuXHRcdFx0bG9jYWxMaW5rcy5mb3JFYWNoKChsb2NhbExpbms6IExpbmtUcmVlVHlwZSkgPT4ge1xyXG5cdFx0XHRcdGlmIChsb2NhbExpbmsuaW5saW5lICYmIHRoaXMuaWdub3JlZExpbmtzLmluY2x1ZGVzKGxvY2FsTGluay5uYW1lKSlcclxuXHRcdFx0XHRcdG5vdGUgPSBub3RlLnJlcGxhY2VBbGwoYFtbJHtsb2NhbExpbmsubmFtZX1dXWAsIGxvY2FsTGluay5uYW1lKTtcclxuXHRcdFx0XHRlbHNlXHJcblx0XHRcdFx0XHRub3RlID0gbm90ZS5yZXBsYWNlQWxsKGBbWyR7bG9jYWxMaW5rLm5hbWV9XV1gLCBgW1sjJHtsb2NhbExpbmsubmFtZX1dXWApXHJcblx0XHRcdH0pXHJcblxyXG5cdFx0XHQvLyByZW1vdmUgdGl0bGUgb24gYSBmaXJzdCBsaW5lXHJcblx0XHRcdGxldCBub3RlUm93cyA9IG5vdGUuc3BsaXQoJ1xcbicpO1xyXG5cdFx0XHRsZXQgZmlyc3RSb3cgPSBmaXhTcGFjZUluTmFtZShub3RlUm93c1swXSk7XHJcblx0XHRcdGlmIChmaXJzdFJvdy5pbmNsdWRlcyhgIyAke2xpbmsubmFtZX1gKSkge1xyXG5cdFx0XHRcdG5vdGVSb3dzLnNoaWZ0KCk7XHJcblx0XHRcdFx0bm90ZSA9IG5vdGVSb3dzLmpvaW4oXCJcXG5cIikudHJpbSgpO1xyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHQvLyByZXBsYWNlIHRpdGxlcyB3aXRoIGp1c3QgYm9sZCB0ZXh0XHJcblx0XHRcdG5vdGVSb3dzID0gbm90ZS5zcGxpdCgnXFxuJyk7XHJcblx0XHRcdG5vdGUgPSBub3RlUm93cy5tYXAoKG5vdGVSb3c6IHN0cmluZykgPT4ge1xyXG5cdFx0XHRcdGNvbnN0IG1hdGNoID0gbm90ZVJvdy5tYXRjaCgvIyAoXFx3KykvKTtcclxuXHRcdFx0XHRcclxuXHRcdFx0XHRpZiAobWF0Y2gpXHJcblx0XHRcdFx0XHRyZXR1cm4gYCoqJHttYXRjaFsxXX0qKmA7XHJcblxyXG5cdFx0XHRcdHJldHVybiBub3RlUm93O1xyXG5cdFx0XHR9KS5qb2luKFwiXFxuXCIpO1xyXG5cdFx0XHRcclxuXHRcdFx0Ly8gcmVtb3ZlICdLYW0gZFx1MDBFMWwnIHBhcnRcclxuXHRcdFx0aWYgKG5vdGUuaW5jbHVkZXModGhpcy5zZXR0aW5ncy5saXN0T2ZMaW5rc0tleXdvcmQpKSB7XHJcblx0XHRcdFx0bGV0IFtpbXBvcnRhbnRQYXJ0LCBlbmRQYXJ0XSA9IG5vdGUuc3BsaXQodGhpcy5zZXR0aW5ncy5saXN0T2ZMaW5rc0tleXdvcmQpO1xyXG5cdFx0XHRcdG5vdGUgPSBpbXBvcnRhbnRQYXJ0LnRyaW0oKTtcclxuXHRcdFx0fVxyXG5cdFx0XHRcclxuXHRcdFx0Ly8gZ2VuZXJhdGUgbmVzdGVkIHRpdGxlIGUuZy4gaDMgLT4gIyMjIHRpdGxlM1xyXG5cdFx0XHRsZXQgdGl0bGUgPSBcIlwiO1xyXG5cdFx0XHRpZiAobGluay5pbmxpbmUpIHtcclxuXHRcdFx0XHQvLyBoNVxyXG5cdFx0XHRcdHRpdGxlID0gYCMjIyMjICR7bGluay5uYW1lfWA7XHJcblx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0Y29uc3QgbmVzdGVkTGV2ZWwgPSBBcnJheShsaW5rLmxldmVsKS5maWxsKCcjJykuam9pbignJyk7XHJcblx0XHRcdFx0dGl0bGUgPSBgJHtuZXN0ZWRMZXZlbH0gJHtsaW5rLm5hbWV9YDtcclxuXHRcdFx0fVxyXG5cclxuXHRcdFx0bm90ZSA9IGBcXG5cXG4ke3RpdGxlfVxcbiR7bm90ZX1gO1xyXG5cclxuXHRcdFx0Ly8gc2hvdWxkIGJlIGxhc3RcclxuXHRcdFx0dGhpcy5tYXJrZG93biArPSBub3RlO1xyXG5cclxuXHRcdFx0aWYgKCdjaGlsZHJlbicgaW4gbGluaylcclxuXHRcdFx0XHR0aGlzLmNvbXBvc2VNYXJrZG93bihsaW5rLmNoaWxkcmVuKTtcclxuXHRcdH0pO1xyXG5cdH1cclxuXHRcclxuXHQvLyB3aG9sZSBwYXRoIGZyb20gbm90ZSB0byByb290XHJcblx0ZGZzKGxpbmtzOiBCdWlsZExpbmtUcmVlVHlwZVtdLCBsZXZlbDogbnVtYmVyLCBwYXJlbnRSZWY/OiBvYmplY3QsIHRpdGxlTWFwcGluZz86IG9iamVjdCkge1xyXG5cclxuXHRcdHRpdGxlTWFwcGluZyA9ICh0aXRsZU1hcHBpbmcgYXMgQnVpbGRMaW5rVHJlZVR5cGUpID8/IHt9OyBcclxuXHRcdFxyXG5cdFx0bGlua3MuZm9yRWFjaCgobGluazogQnVpbGRMaW5rVHJlZVR5cGUsIG9yZGVyOiBudW1iZXIpID0+IHtcclxuXHJcblx0XHRcdC8vIHNraXAgbGluayBmcm9tIG1haW5Db250ZW50XHJcblx0XHRcdGlmICh0aGlzLm1haW5OYW1lTGlua3MuaW5jbHVkZXMobGluay5uYW1lKSAmJiBsZXZlbCAhPSAwKVxyXG5cdFx0XHRcdHJldHVybjtcclxuXHJcblx0XHRcdC8vIHNraXAgaWYgbGluayBpcyBhbHJlYWR5IHByb2Nlc3NlZFxyXG5cdFx0XHRpZiAodGhpcy5wcm9jZXNzZWQuaW5jbHVkZXMobGluay5uYW1lKSlcclxuXHRcdFx0XHRyZXR1cm47XHJcblxyXG5cdFx0XHR0aGlzLnByb2Nlc3NlZC5wdXNoKGxpbmsubmFtZSk7XHJcblx0XHRcdC8vY29uc29sZS5sb2cobGluay5uYW1lKTtcclxuXHJcblx0XHRcdGNvbnN0IG5vdGUgPSBnZXROb3RlQnlOYW1lKGxpbmsubmFtZSwgdGhpcy5sb2FkZWRGaWxlcyk7XHJcblx0XHRcdGNvbnN0IHN1YkxpbmtzID0gdGhpcy5wYXJzZUxpbmtzKG5vdGUpO1xyXG5cclxuXHRcdFx0dGhpcy5tYXhMZXZlbCA9IGxldmVsICsgMTtcclxuXHJcblx0XHRcdCh0aXRsZU1hcHBpbmcgYXMgYW55KVtsaW5rLm5hbWVdID0geyAuLi5saW5rLCBwYXJlbnRSZWYsIGxldmVsOiB0aGlzLm1heExldmVsLCBvcmRlcn07XHJcblxyXG5cdFx0ICBpZiAoc3ViTGlua3MubGVuZ3RoID4gMCkge1xyXG5cdFx0XHR0aGlzLmRmcyhzdWJMaW5rcywgdGhpcy5tYXhMZXZlbCwgKHRpdGxlTWFwcGluZyBhcyBhbnkpW2xpbmsubmFtZV0sIHRpdGxlTWFwcGluZyk7XHJcblx0XHQgIH1cclxuXHRcdH0pO1xyXG5cdFx0Ly9jb25zb2xlLmxvZyhcIlRNXCIsIEpTT04uc3RyaW5naWZ5KHRpdGxlTWFwcGluZykpO1xyXG5cdFx0cmV0dXJuIHRpdGxlTWFwcGluZyBhcyBCdWlsZExpbmtUcmVlVHlwZTtcdFxyXG5cdH1cclxuXHJcblxyXG5cdC8vZ2V0dGluZyBjaGlsZHJlbiBmb3Igbm90ZXNcclxuXHRnZW5lcmF0ZU5vdGVzSGllcmFyY2h5KGxpbmtzOiBMaW5rVHJlZVR5cGVbXSkge1xyXG5cdFx0Y29uc3QgbGlua3NPYmo6IEJ1aWxkTGlua1RyZWVUeXBlID0gdGhpcy5kZnMobGlua3MsIDApO1xyXG5cdFx0Y29uc29sZS5sb2coXCJsaW5rb2JqXCIsIGxpbmtzT2JqKTtcclxuXHRcdGxldCBsaW5rc0FycjogTGlua1RyZWVUeXBlW10gPSBbXTtcclxuXHRcdFxyXG5cdFx0T2JqZWN0LmtleXMobGlua3NPYmopLmZvckVhY2goa2V5ID0+IHtcclxuXHRcdFx0Y29uc3Qge3BhcmVudFJlZiwgLi4ucmVzdH0gPSBsaW5rc09ialtrZXkgYXMga2V5b2YgQnVpbGRMaW5rVHJlZVR5cGVdIGFzIEJ1aWxkTGlua1RyZWVUeXBlOyBcclxuXHRcdFx0bGlua3NBcnIucHVzaCh7Li4ucmVzdCwgcGFyZW50OiAobGlua3NPYmpba2V5IGFzIGtleW9mIEJ1aWxkTGlua1RyZWVUeXBlXSBhcyBCdWlsZExpbmtUcmVlVHlwZSk/LnBhcmVudFJlZj8ubmFtZX0pO1xyXG5cdFx0fSk7XHJcblxyXG5cdFx0Y29uc29sZS5sb2coXCJMQVwiLCBsaW5rc0Fycik7XHJcblxyXG5cdFx0Ly9wcmVzZW50YXRpb24gc2xpZGVzXHJcblx0XHRcclxuXHRcdGxldCBtYXhEZXB0aCA9IE51bWJlcih0aGlzLnNldHRpbmdzLnNsaWRlc0RlcHRoKTtcclxuXHRcdGZ1bmN0aW9uIGdldENoaWxkcmVuKHBhcmVudDogTGlua1RyZWVUeXBlKXtcclxuXHRcdFx0XHJcblx0XHRcdGNvbnNvbGUubG9nKFwiZGVwdGhcIiwgc3RhcnREZXB0aCk7XHJcblx0XHRcdGxldCBjaGlsZHJlbjogTGlua1RyZWVUeXBlW10gPSBsaW5rc0Fyci5maWx0ZXIoKGNoaWxkKSA9PiBjaGlsZC5wYXJlbnQgPT09IHBhcmVudC5uYW1lKTtcclxuXHRcdFx0Y29uc29sZS5sb2coXCJjaGlsZHJlblwiLCBjaGlsZHJlbik7XHJcblx0XHRcdGlmKHN0YXJ0RGVwdGggPD0gbWF4RGVwdGgpe1xyXG5cdFx0XHRcdGNoaWxkcmVuLmZvckVhY2goY2hpbGQgPT4ge1xyXG5cdFx0XHRcdFx0c2xpZGVzTGlzdCArPSAgXCJcXG5cIiArIFwiI1wiLnJlcGVhdChzdGFydERlcHRoKSArIGNoaWxkLm5hbWU7XHJcblx0XHRcdFx0XHRpZiAoc3RhcnREZXB0aCAhPSBtYXhEZXB0aCl7XHJcblx0XHRcdFx0XHRcdHN0YXJ0RGVwdGggKz0gMTtcclxuXHRcdFx0XHRcdFx0Z2V0Q2hpbGRyZW4oY2hpbGQpO1xyXG5cdFx0XHRcdFx0fWVsc2Uge1xyXG5cdFx0XHRcdFx0XHRjb25zb2xlLmxvZyhcIlx1MDEwRGFhdVwiKTtcclxuXHRcdFx0XHRcdFx0cmV0dXJuO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0c3RhcnREZXB0aCAtPSAxO1xyXG5cdFx0XHRcdFx0XHJcblx0XHRcdFx0XHRcclxuXHRcdFx0XHR9KVxyXG5cdFx0XHRcdFxyXG5cdFx0XHR9XHJcblx0XHR9XHJcblxyXG5cdFx0bGV0IHNsaWRlc0xpc3QgPSBcIlwiO1xyXG5cdFx0bGV0IHNsaWRlcyA9IGxpbmtzQXJyLmZpbHRlcigobGluaykgPT4gbGluay5sZXZlbCA9PT0gMSk7XHJcblx0XHRjb25zb2xlLmxvZyhcIlNMSURFU1wiLCBzbGlkZXMpO1xyXG5cdFx0bGV0IHN0YXJ0RGVwdGg6IG51bWJlcjtcclxuXHRcdHNsaWRlcy5mb3JFYWNoKHNsaWRlID0+IHtcclxuXHRcdFx0c3RhcnREZXB0aCA9IDI7XHJcblx0XHRcdHNsaWRlc0xpc3QgKz0gIFwiXFxuICNcIiArIHNsaWRlLm5hbWU7XHJcblx0XHRcdGdldENoaWxkcmVuKHNsaWRlKTtcdFxyXG5cdFx0fSlcclxuXHJcblx0XHRjb25zb2xlLmxvZyhcInNsaWRlTGlzdFwiLCBzbGlkZXNMaXN0KTtcclxuXHJcblx0XHRcclxuXHRcdFxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cdFx0Y29uc3QgY3JlYXRlQ2hpbGRyZW5Gcm9tUGFyZW50ID0gKGFycjogTGlua1RyZWVUeXBlW10sIHBhcmVudDogc3RyaW5nIHwgdW5kZWZpbmVkKSA9PiB7XHJcblx0XHRcdGxldCBjaGlsZHJlbkFyciA9IFtdO1xyXG5cdFx0XHRmb3IobGV0IGkgPSAwOyBpIDwgYXJyLmxlbmd0aDsgaSsrKSB7XHJcblx0XHRcdFx0Ly9pbmRleCBsaW5rcyA9IHVuZGVmaW5lZFxyXG5cdFx0XHRcdGlmKGFycltpXS5wYXJlbnQgPT0gcGFyZW50KSB7XHJcblx0XHRcdFx0XHRjb25zdCBjaGlsZHJlbiA9IGNyZWF0ZUNoaWxkcmVuRnJvbVBhcmVudChhcnIsIGFycltpXS5uYW1lKTtcclxuXHRcdFx0XHRcdGlmKGNoaWxkcmVuLmxlbmd0aCkge1xyXG5cdFx0XHRcdFx0XHRhcnJbaV0uY2hpbGRyZW4gPSBjaGlsZHJlbjtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdGNoaWxkcmVuQXJyLnB1c2goYXJyW2ldKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdFx0Ly9jb25zb2xlLmxvZyhcIkNIQVwiLCBjaGlsZHJlbkFycik7XHJcblx0XHRcdHJldHVybiBjaGlsZHJlbkFycjtcclxuXHRcdH1cclxuXHRcdC8vY29uc29sZS5sb2coXCJuZXN0ZWRjaGlsZGVyXCIsIGdldE5lc3RlZENoaWxkcmVuKGxpbmtzQXJyLCB1bmRlZmluZWQpKTtcclxuXHRcdHJldHVybiBjcmVhdGVDaGlsZHJlbkZyb21QYXJlbnQobGlua3NBcnIsIHVuZGVmaW5lZCk7XHJcblx0fVxyXG5cclxuXHRcclxuXHJcblx0YXN5bmMgb25DbG9zZSgpIHtcclxuXHRcdC8vIE5vdGhpbmcgdG8gY2xlYW4gdXAuXHJcblx0fVxyXG5cclxuXHRnZXRWaWV3VHlwZSgpIHtcclxuXHRcdHJldHVybiBWSUVXX0NPTlRFTlRfQ09NUE9TRV9OT1RFUztcclxuXHR9XHJcblxyXG5cdGdldERpc3BsYXlUZXh0KCkge1xyXG5cdFx0cmV0dXJuIFwiTm90ZXMgTWVyZ2VyXCI7XHJcblx0fVxyXG59XHJcbiIsICJpbXBvcnQgeyByZWFkRmlsZVN5bmMgfSBmcm9tICdmcyc7XHJcbmltcG9ydCB7IEZpbGVTeXN0ZW1BZGFwdGVyLCBUQWJzdHJhY3RGaWxlLCBURmlsZSB9IGZyb20gJ29ic2lkaWFuJztcclxuXHJcbmV4cG9ydCBjb25zdCBmaXhTcGFjZUluTmFtZSA9IChuYW1lOiBzdHJpbmcpID0+IHtcclxuXHRyZXR1cm4gbmFtZS5yZXBsYWNlKC9bXFx1MDBBMFxcdTE2ODBcXHUxODBFXFx1MjAwMC1cXHUyMDBCXFx1MjAyRlxcdTIwNUZcXHUzMDAwXFx1RkVGRl0vLCBcIiBcIikudHJpbSgpO1xyXG59XHJcblxyXG5leHBvcnQgY29uc3QgZ2V0Tm90ZUJ5TmFtZSA9IChuYW1lOiBzdHJpbmcsIGxvYWRlZEZpbGVzOiBUQWJzdHJhY3RGaWxlW10pID0+IHtcclxuXHRjb25zdCBsb2FkZWRGaWxlID0gbG9hZGVkRmlsZXMuZmluZCgoZmlsZTogVEZpbGUpID0+IGZpbGUuYmFzZW5hbWUgPT09IG5hbWUpO1xyXG5cdCBcclxuXHRjb25zdCBmdWxsUGF0aCA9IChhcHAudmF1bHQuYWRhcHRlciBhcyBGaWxlU3lzdGVtQWRhcHRlcikuZ2V0RnVsbFBhdGgobmFtZSk7XHJcblxyXG5cdGlmICghbG9hZGVkRmlsZSlcclxuXHRcdHJldHVybiBcIlwiO1xyXG5cclxuXHRjb25zdCBhYnNvbHV0ZVBhdGggPSBmdWxsUGF0aC5yZXBsYWNlKG5hbWUsIGxvYWRlZEZpbGUucGF0aC5yZXBsYWNlKCcvJywgJ1xcXFwnKSlcclxuXHRjb25zdCBub3RlID0gcmVhZEZpbGVTeW5jKGFic29sdXRlUGF0aCwgeyBlbmNvZGluZzogJ3V0ZjgnIH0pO1xyXG5cdHJldHVybiBub3RlOyAvLyB0ZXh0IG9mIG5vdGVcclxufVxyXG4iLCAiZXhwb3J0IGNsYXNzIEJ1dHRvbiB7XHJcblx0YnRuOiBIVE1MQnV0dG9uRWxlbWVudDtcclxuXHJcblx0Y29uc3RydWN0b3IoZWxlbWVudDogRWxlbWVudCwgdGV4dDogc3RyaW5nLCBvbkNsaWNrOiAoY29udGV4dDogQnV0dG9uKSA9PiB2b2lkLCBhcmdzPzogb2JqZWN0KSB7XHJcblx0XHR0aGlzLmJ0biA9IGVsZW1lbnQuY3JlYXRlRWwoJ2J1dHRvbicsIHsgdGV4dCwgLi4uYXJncyB9KTtcclxuXHRcdHRoaXMuYnRuLm9uY2xpY2sgPSAoKSA9PiB7XHJcblx0XHRcdG9uQ2xpY2sodGhpcyk7XHJcblx0XHR9O1x0XHJcblx0XHRyZXR1cm4gdGhpcztcclxuXHR9XHJcbn1cclxuIiwgImltcG9ydCB7IEFwcCB9IGZyb20gXCJvYnNpZGlhblwiO1xyXG5pbXBvcnQgeyBMaW5rVHJlZVR5cGUgfSBmcm9tIFwic3JjL3ZpZXdzL2dlbmVyYXRlLW1hcmtkb3duXCI7XHJcblxyXG5leHBvcnQgY2xhc3MgQmFzZUxpbmsge1xyXG5cdGNvbnRleHQ6IEFwcDtcclxuXHRlbGVtZW50OiBFbGVtZW50O1xyXG5cdG5hbWU6IHN0cmluZztcclxuXHJcblx0Y29uc3RydWN0b3IoY29udGV4dDogQXBwLCBlbGVtZW50OiBFbGVtZW50LCBuYW1lOiBzdHJpbmcpIHtcclxuXHRcdHRoaXMuY29udGV4dCA9IGNvbnRleHQ7XHJcblx0XHR0aGlzLmVsZW1lbnQgPSBlbGVtZW50O1xyXG5cdFx0dGhpcy5uYW1lID0gbmFtZTtcclxuXHJcblx0XHR0aGlzLnJlbmRlcigpO1xyXG5cdH1cclxuXHJcblx0cmVuZGVyKCkge1xyXG5cdFx0Y29uc3QgaHJlZlRpdGxlID0gdGhpcy5lbGVtZW50LmNyZWF0ZUVsKCdhJywgeyB0ZXh0OiB0aGlzLm5hbWUsIGNsczogJ2NvbnRfX3RpdGxlJyB9KTtcclxuXHRcdGhyZWZUaXRsZS5vbmNsaWNrID0gKCkgPT4ge1xyXG5cdFx0XHR0aGlzLmNvbnRleHQud29ya3NwYWNlLm9wZW5MaW5rVGV4dCh0aGlzLm5hbWUsIFwiXCIpO1xyXG5cdFx0fVxyXG5cdH1cclxuXHJcbn1cclxuXHJcbi8vIExpbmsgd2l0aCBpbm5lciBzdGF0ZSBhbmQgaGVscGVyIGZuY3NcclxuZXhwb3J0IGNsYXNzIExpbmsge1xyXG5cclxuXHRjb250ZXh0OiBBcHA7XHJcblx0YTogSFRNTEVsZW1lbnQ7XHJcblx0bGluazogTGlua1RyZWVUeXBlO1xyXG5cdGVsZW1lbnQ6IEVsZW1lbnQ7XHJcblx0dG9nZ2xlZFN0YXRlOiBib29sZWFuID0gZmFsc2U7XHJcblxyXG5cdGNvbnN0cnVjdG9yKGNvbnRleHQ6IEFwcCwgZWxlbWVudDogRWxlbWVudCwgbGluazogTGlua1RyZWVUeXBlLCByZW5kZXJOb3c6IGJvb2xlYW4gPSB0cnVlKSB7XHJcblx0XHR0aGlzLmxpbmsgPSBsaW5rO1xyXG5cdFx0dGhpcy5jb250ZXh0ID0gY29udGV4dDtcclxuXHRcdHRoaXMuZWxlbWVudCA9IGVsZW1lbnQ7XHJcblxyXG5cdFx0aWYgKHJlbmRlck5vdylcclxuXHRcdFx0dGhpcy5yZW5kZXIoZmFsc2UpO1xyXG5cclxuXHRcdHJldHVybiB0aGlzO1xyXG5cdH1cclxuXHJcblx0cmVuZGVyKHN0YXRlOiBib29sZWFuKSB7XHJcblx0XHR0aGlzLmEgPSB0aGlzLmVsZW1lbnQuY3JlYXRlRWwoJ2EnLCB7IHRleHQ6IHRoaXMubGluay5uYW1lLCBjbHM6IFwibGlua1wiIH0pO1xyXG5cdFx0IXRoaXMubGluay5leGlzdHMgJiYgdGhpcy5hLmFkZENsYXNzKFwiY29udF9fbGluay1ub3QtZXhpc3RcIik7XHJcblx0XHR0aGlzLmxpbmsuaW5saW5lICYmIHRoaXMuYS5hZGRDbGFzcyhcImlubGluZVwiKTtcclxuXHRcdHRoaXMuYS5vbmNsaWNrID0gKCkgPT4ge1xyXG5cdFx0XHR0aGlzLmNvbnRleHQud29ya3NwYWNlLm9wZW5MaW5rVGV4dCh0aGlzLmxpbmsubmFtZSwgXCJcIik7XHJcblx0XHRcdCF0aGlzLmxpbmsuZXhpc3RzICYmIHRoaXMuYS5yZW1vdmVDbGFzcyhcImNvbnRfX2xpbmstbm90LWV4aXN0XCIpO1xyXG5cdFx0fTtcclxuXHJcblx0XHR0aGlzLnRvZ2dsZShzdGF0ZSk7XHJcblx0fVxyXG5cclxuXHR0b2dnbGUoc3RhdGU6IGJvb2xlYW4pIHtcclxuXHRcdGlmIChzdGF0ZSlcclxuXHRcdFx0dGhpcy5hLnJlbW92ZUNsYXNzKCdzdHJpa2V0aHJvdWdoJyk7XHJcblx0XHRlbHNlXHJcblx0XHRcdHRoaXMuYS5hZGRDbGFzcygnc3RyaWtldGhyb3VnaCcpO1xyXG5cdH1cclxufVxyXG4iLCAiaW1wb3J0IHsgQXBwLCBNb2RhbCwgU2V0dGluZyB9IGZyb20gXCJvYnNpZGlhblwiO1xyXG5cclxuZXhwb3J0IGNsYXNzIFNhdmVNb2RhbCBleHRlbmRzIE1vZGFsIHtcclxuICByZXN1bHQ6IHN0cmluZztcclxuICBvblN1Ym1pdDogKHJlc3VsdDogc3RyaW5nKSA9PiB2b2lkO1xyXG5cclxuICBjb25zdHJ1Y3RvcihhcHA6IEFwcCwgb25TdWJtaXQ6IChyZXN1bHQ6IHN0cmluZykgPT4gdm9pZCkge1xyXG4gICAgc3VwZXIoYXBwKTtcclxuICAgIHRoaXMub25TdWJtaXQgPSBvblN1Ym1pdDtcclxuICB9XHJcblxyXG4gIG9uT3BlbigpIHtcclxuICAgIGNvbnN0IHsgY29udGVudEVsIH0gPSB0aGlzO1xyXG5cclxuICAgIGNvbnRlbnRFbC5jcmVhdGVFbChcImgxXCIsIHsgdGV4dDogXCJTYXZlIGFzXCIgfSk7XHJcblxyXG4gICAgbmV3IFNldHRpbmcoY29udGVudEVsKVxyXG4gICAgICAuc2V0TmFtZShcIkZpbGUgbmFtZTogXCIpXHJcbiAgICAgIC5hZGRUZXh0KCh0ZXh0KSA9PlxyXG4gICAgICAgIHRleHQub25DaGFuZ2UoKHZhbHVlKSA9PiB7XHJcbiAgICAgICAgICB0aGlzLnJlc3VsdCA9IHZhbHVlXHJcbiAgICAgICAgfSkpO1xyXG5cclxuICAgIG5ldyBTZXR0aW5nKGNvbnRlbnRFbClcclxuICAgICAgLmFkZEJ1dHRvbigoYnRuKSA9PlxyXG4gICAgICAgIGJ0blxyXG4gICAgICAgICAgLnNldEJ1dHRvblRleHQoXCJHZW5lcmF0ZSBtYXJrZG93biBub3RlXCIpXHJcbiAgICAgICAgICAuc2V0Q3RhKClcclxuICAgICAgICAgIC5vbkNsaWNrKCgpID0+IHtcclxuICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgICAgICAgICB0aGlzLm9uU3VibWl0KHRoaXMucmVzdWx0KTtcclxuICAgICAgICAgIH0pKTtcclxuICB9XHJcblxyXG4gIG9uQ2xvc2UoKSB7XHJcbiAgICBsZXQgeyBjb250ZW50RWwgfSA9IHRoaXM7XHJcbiAgICBjb250ZW50RWwuZW1wdHkoKTtcclxuICB9XHJcbn1cclxuIiwgImltcG9ydCB7IEFwcCB9IGZyb20gJ29ic2lkaWFuJztcclxuaW1wb3J0IHsgTGlua1RyZWVUeXBlIH0gZnJvbSAnLi4vdmlld3MvZ2VuZXJhdGUtbWFya2Rvd24nO1xyXG5pbXBvcnQge1xyXG5cdExpbmssIENoZWNrYm94XHJcbn0gZnJvbSAnLi9pbmRleCc7XHJcblxyXG5cclxuZnVuY3Rpb24gZmxhdHRlbkNoaWxkcmVuKGxpbms6IExpbmtUcmVlVHlwZSwgY2hpbGRyZW46IHN0cmluZ1tdKSB7XHJcblx0aWYgKCdjaGlsZHJlbicgaW4gbGluaykge1xyXG5cdFx0Y29uc3QgY2hpbGRyZW5MaW5rTmFtZXMgPSBsaW5rLmNoaWxkcmVuLm1hcCgobDogTGlua1RyZWVUeXBlKSA9PiBsLm5hbWUpOyBcclxuXHRcdGNoaWxkcmVuLnB1c2goLi4uY2hpbGRyZW5MaW5rTmFtZXMpO1xyXG5cdFx0bGluay5jaGlsZHJlbi5mb3JFYWNoKChsOiBMaW5rVHJlZVR5cGUpID0+IHtcclxuXHRcdFx0ZmxhdHRlbkNoaWxkcmVuKGwsIGNoaWxkcmVuKTtcclxuXHRcdH0pXHJcblx0fVxyXG5cdHJldHVybiBjaGlsZHJlbjtcclxufVxyXG5cclxuZXhwb3J0IGNsYXNzIFRyZWVNZW51IHtcclxuXHRhcHA6IEFwcDtcclxuXHRVTDogRWxlbWVudDtcclxuXHJcblx0aWdub3JlZExpbmtzOiBzdHJpbmdbXSA9IFtdO1xyXG5cdGxpbmtzVHJlZTogTGlua1RyZWVUeXBlW10gPSBbXTtcclxuXHJcblx0Y29uc3RydWN0b3IoYXBwOiBBcHAsIHN0cnVjdHVyZTogRWxlbWVudCwgbGlua3NUcmVlOiBMaW5rVHJlZVR5cGVbXSwgZXZlbnQ6IChpZ25vcmVkTGlua3M6IHN0cmluZ1tdKSA9PiB2b2lkKSB7XHJcblx0XHR0aGlzLmFwcCA9IGFwcDtcclxuXHRcdGxldCBtZW51ID0gc3RydWN0dXJlLmNyZWF0ZUVsKCdkaXYnLCB7IGNsczogJ3RyZWUtbWVudSd9KTtcclxuXHRcdHRoaXMuVUwgPSBtZW51LmNyZWF0ZUVsKCd1bCcpO1xyXG5cdFx0dGhpcy5saW5rc1RyZWUgPSBsaW5rc1RyZWU7XHJcblxyXG5cdFx0dGhpcy5yZW5kZXIodGhpcy5saW5rc1RyZWUsIHRoaXMuVUwsIFtdLCBldmVudCk7XHJcblx0fVxyXG5cclxuXHRyZW5kZXIobGlua3M6IExpbmtUcmVlVHlwZVtdLCBtZW51RWw6IEVsZW1lbnQsIGNoaWxkcmVuTGlua3M6IHN0cmluZ1tdLCBldmVudDogKGxpbmtzOiBzdHJpbmdbXSkgPT4gdm9pZCkge1xyXG5cdFx0aWYgKCFjaGlsZHJlbkxpbmtzKSBcclxuXHRcdFx0Y2hpbGRyZW5MaW5rcyA9IFtdO1xyXG5cclxuXHRcdGxpbmtzLmZvckVhY2goKGxpbms6IExpbmtUcmVlVHlwZSkgPT4ge1xyXG5cdFx0XHRjb25zdCBsaSA9IG1lbnVFbC5jcmVhdGVFbCgnbGknKTtcclxuXHRcdFx0Y29uc3QgbGlua0VsID0gbmV3IExpbmsodGhpcy5hcHAsIGxpLCBsaW5rLCBmYWxzZSk7XHJcblxyXG5cdFx0XHRsZXQgc3RhdGU6IGJvb2xlYW4gPSAhY2hpbGRyZW5MaW5rcy5pbmNsdWRlcyhsaW5rRWwubGluay5uYW1lKTtcclxuXHJcblx0XHRcdGlmICghbGluay5leGlzdHMpXHJcblx0XHRcdFx0c3RhdGUgPSBmYWxzZTsgXHJcblxyXG5cdFx0XHRuZXcgQ2hlY2tib3gobGksIHN0YXRlLCBsaW5rLmV4aXN0cywgKCkgPT4ge1xyXG5cdFx0XHRcdGNvbnN0IGNoaWxkcmVuID0gW2xpbmtFbC5saW5rLm5hbWUsIC4uLmZsYXR0ZW5DaGlsZHJlbihsaW5rRWwubGluaywgW10pXTtcclxuXHRcdFx0XHRjb25zb2xlLmxvZyhcImZsYXR0ZW5cIiwgY2hpbGRyZW4pO1xyXG5cdFx0XHRcdGlmIChzdGF0ZSA9PSBmYWxzZSkgeyBcclxuXHRcdFx0XHRcdC8vIHJlbW92ZSBjaGlsZHJlbiBmcm9tIGNoaWxkcmVuTGlua3NcclxuXHRcdFx0XHRcdGNoaWxkcmVuTGlua3MgPSBjaGlsZHJlbkxpbmtzLmZpbHRlcigoY2w6IHN0cmluZykgPT4gIWNoaWxkcmVuLmluY2x1ZGVzKGNsKSk7XHJcblx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdGNoaWxkcmVuTGlua3MucHVzaCguLi5jaGlsZHJlbik7XHJcblx0XHRcdFx0XHRcclxuXHRcdFx0XHRcdC8vIHJlbW92ZSBkdXBlc1xyXG5cdFx0XHRcdFx0Y2hpbGRyZW5MaW5rcyA9IFsuLi5uZXcgU2V0KGNoaWxkcmVuTGlua3MpXVxyXG5cdFx0XHRcdH1cclxuXHJcblx0XHRcdFx0dGhpcy5pZ25vcmVkTGlua3MgPSBjaGlsZHJlbkxpbmtzO1xyXG5cdFx0XHRcdFxyXG5cdFx0XHRcdC8vIGNsZWFudXAgYW5kIHJlcmVuZGVyXHJcblx0XHRcdFx0dGhpcy5VTC5lbXB0eSgpO1xyXG5cdFx0XHRcdHRoaXMucmVuZGVyKHRoaXMubGlua3NUcmVlLCB0aGlzLlVMLCBjaGlsZHJlbkxpbmtzLCBldmVudCk7XHJcblx0XHRcdH0pO1xyXG5cclxuXHRcdFx0bGlua0VsLnJlbmRlcihzdGF0ZSk7XHJcblxyXG5cdFx0XHRpZiAoJ2NoaWxkcmVuJyBpbiBsaW5rKSB7XHJcblx0XHRcdFx0Y29uc3QgdWwgPSBsaS5jcmVhdGVFbCgndWwnKTtcclxuXHRcdFx0XHR0aGlzLnJlbmRlcihsaW5rLmNoaWxkcmVuLCB1bCwgY2hpbGRyZW5MaW5rcywgZXZlbnQpO1xyXG5cdFx0XHR9XHJcblx0XHR9KTtcclxuXHJcblx0XHRyZXR1cm4gZXZlbnQodGhpcy5pZ25vcmVkTGlua3MpO1xyXG5cdH1cclxufVxyXG4iLCAiZXhwb3J0IGNsYXNzIENoZWNrYm94IHtcclxuXHJcblx0Y2I6IEhUTUxJbnB1dEVsZW1lbnQ7XHJcblx0Y29uc3RydWN0b3IoZWxlbWVudDogRWxlbWVudCwgc3RhdGU6IGJvb2xlYW4sIGV4aXN0czogYm9vbGVhbiwgb25DbGljazogKGNvbnRleHQ6IENoZWNrYm94KSA9PiB2b2lkKSB7XHJcblx0XHR0aGlzLmNiID0gZWxlbWVudC5jcmVhdGVFbChcImlucHV0XCIsIHtcclxuXHRcdFx0dHlwZTogJ2NoZWNrYm94JyxcclxuXHRcdFx0Y2xzOiAnY2hlY2tib3gtYnRuJ1xyXG5cdFx0fSk7XHJcblxyXG5cdFx0dGhpcy5jYi5jaGVja2VkID0gc3RhdGU7XHJcblxyXG5cdFx0aWYgKCFleGlzdHMpIHtcclxuXHRcdFx0dGhpcy5jYi5kaXNhYmxlZCA9IHRydWU7XHJcblx0XHRcdHRoaXMuY2IuY2hlY2tlZCA9IGZhbHNlO1xyXG5cdFx0XHR0aGlzLmNiLmFkZENsYXNzKCdjaGVja2JveC1idG4tZGlzYWJsZWQnKTtcclxuXHRcdH1cclxuXHRcdHRoaXMuY2Iub25jbGljayA9ICgpID0+IHtcclxuXHRcdFx0b25DbGljayh0aGlzKTtcclxuXHRcdH07XHRcclxuXHRcdHJldHVybiB0aGlzO1xyXG5cdH1cclxufVxyXG4iXSwKICAibWFwcGluZ3MiOiAiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FB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
